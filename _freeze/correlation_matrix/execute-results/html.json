{
  "hash": "aa873e80ba0ab0ab073dfe5b74518159",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: Correlations\n---\n\n\n\n### Loading Dependencies\n\n\n::: {#d2a15fc3 .cell execution_count=1}\n``` {.python .cell-code}\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport pandas as pd\nimport scipy.stats\n```\n:::\n\n\n## Loading Data\n\n::: {#443e3f8a .cell execution_count=2}\n``` {.python .cell-code}\nabundance_table = pd.read_excel(\"abundance_table.xlsx\")\n#remove first 4 characters in every column name\nabundance_table.columns = abundance_table.columns.str[4:] \n#split string in column to get date and process\nabundance_table[['Process','Date']] = abundance_table['le'].str.split('_',expand=True)\nabundance_table = abundance_table.drop(columns=['le'])\nprocesses = ['AS-1', 'AS-2']\nas_abundance_table = abundance_table[abundance_table['Process'].isin(processes)]\nas_abundance_table = as_abundance_table.drop(columns=['Process'])\n#group by date and find the mean of all values\nas_abundance_table = as_abundance_table.groupby(['Date']).mean()\n#remove last two rows of as_abundance_table\na = as_abundance_table.iloc[:,:-2]\na = a.reset_index()\n#remove first column in a\na = a.iloc[:,1:]\na = a.to_numpy()\n```\n:::\n\n\n## Correlation between count data\n\n::: {#206f04b9 .cell execution_count=3}\n``` {.python .cell-code}\ncorrelation = np.corrcoef(a.T)\n\nmask = ((correlation > 0.75) & (correlation < 0.99)) | (correlation < -0.75) & (correlation > -0.99)\n\n# Plotting\nfig = plt.figure()\n# Put in title and axis labels\nfig.suptitle('Correlation Matrix of OTU Counts Over Time')\nax = fig.add_subplot(111)\n\n# Use the mask to display the significant correlations\nmasked_correlation = np.ma.masked_where(~mask, correlation)\ncax = ax.matshow(masked_correlation, cmap='coolwarm', vmin=-1, vmax=1)\nfig.colorbar(cax)\n\nplt.show()\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n/Users/julietmalkowski/Desktop/Research/Micro/env/lib/python3.10/site-packages/numpy/lib/_function_base_impl.py:2922: RuntimeWarning: invalid value encountered in divide\n  c /= stddev[:, None]\n/Users/julietmalkowski/Desktop/Research/Micro/env/lib/python3.10/site-packages/numpy/lib/_function_base_impl.py:2923: RuntimeWarning: invalid value encountered in divide\n  c /= stddev[None, :]\n```\n:::\n\n::: {.cell-output .cell-output-display}\n![](correlation_matrix_files/figure-html/cell-4-output-2.png){width=535 height=445}\n:::\n:::\n\n\n",
    "supporting": [
      "correlation_matrix_files"
    ],
    "filters": [],
    "includes": {}
  }
}