[
  {
    "objectID": "trend_decomposition.html",
    "href": "trend_decomposition.html",
    "title": "Decomposition of Trends",
    "section": "",
    "text": "Note: All Abundances have been filtered out to only contain relative abundances &gt; 0.01\n\n\nFor Shannon Index\n\ntryCatch({\n  otu_1_shannon %&gt;% decompose(type = \"additive\") %&gt;% \n    autoplot()\n}, error = function(e) {\n  message(\"An error occurred: \", e$message)\n})\n\nAn error occurred: time series has no or less than 2 periods\n\n\nResult: Error in decompose(): ! time series has no or less than 2 periods\n\ntryCatch({\n    otu_1_abundance %&gt;% decompose(type=\"additive\") %&gt;%\n    autoplot()\n}, error = function(e) {\n  message(\"An error occurred: \", e$message)\n})\n\nAn error occurred: time series has no or less than 2 periods\n\ntryCatch({\n    otu_1_count%&gt;% decompose(type=\"additive\") %&gt;%\n    autoplot()\n}, error = function(e) {\n  message(\"An error occurred: \", e$message)\n})\n\nAn error occurred: time series has no or less than 2 periods\n\n\nResult: Error in decompose(): ! time series has no or less than 2 periods\n\n\n\nFor Shannon Index\n\ntryCatch({\n    otu_1_shannon  %&gt;%\n    stl(s.window=\"periodic\", robust=TRUE) %&gt;%\n    autoplot()\n}, error = function(e) {\n  message(\"An error occurred: \", e$message)\n})\n\nAn error occurred: series is not periodic or has less than two periods\n\ntryCatch({\n    otu_1_abundance  %&gt;%\n    stl(s.window=\"periodic\", robust=TRUE) %&gt;%\n    autoplot()\n}, error = function(e) {\n  message(\"An error occurred: \", e$message)\n})\n\nAn error occurred: series is not periodic or has less than two periods\n\n\nResult: Error in decompose(): ! time series has no or less than 2 periods\n\n\n\nAugmented Dickey-Fuller Test: This is a statistical test that checks for the presence of a unit root in the time series. If the test indicates that there is no unit root, then the time series is likely stationary.\nFor Shannon Index\n\nadf_test_shannon &lt;- adf.test(otu_1_shannon)\nprint(adf_test_shannon)\n\n\n    Augmented Dickey-Fuller Test\n\ndata:  otu_1_shannon\nDickey-Fuller = -1.9299, Lag order = 4, p-value = 0.6044\nalternative hypothesis: stationary\n\n\nResult: Not Stationary\nFor OTU 1 Counts\n\nadf_test_otu &lt;- adf.test(otu_1_abundance)\nprint(adf_test_otu)\n\n\n    Augmented Dickey-Fuller Test\n\ndata:  otu_1_abundance\nDickey-Fuller = -2.6805, Lag order = 4, p-value = 0.2971\nalternative hypothesis: stationary\n\n#adf.test(otu_1_count) \n\nResult: Not Stationary\nKwiatkowski-Phillips-Schmidt-Shin Test: his test checks for the presence of a trend or structural break in the time series. If the test indicates that there is no trend or structural break, then the time series may be considered stationary.\nFor Shannon Index\n\nkpss.test(otu_1_shannon)\n\nWarning in kpss.test(otu_1_shannon): p-value smaller than printed p-value\n\n\n\n    KPSS Test for Level Stationarity\n\ndata:  otu_1_shannon\nKPSS Level = 0.89563, Truncation lag parameter = 3, p-value = 0.01\n\n\nResult: Not Stationary\nFor OTU 1\n\n#on relative abudance\nkpss.test(otu_1_abundance)\n\nWarning in kpss.test(otu_1_abundance): p-value smaller than printed p-value\n\n\n\n    KPSS Test for Level Stationarity\n\ndata:  otu_1_abundance\nKPSS Level = 0.92455, Truncation lag parameter = 3, p-value = 0.01\n\nkpss.test(otu_1_count)\n\nWarning in kpss.test(otu_1_count): p-value smaller than printed p-value\n\n\n\n    KPSS Test for Level Stationarity\n\ndata:  otu_1_count\nKPSS Level = 0.89444, Truncation lag parameter = 3, p-value = 0.01\n\n\nResult: Not Stationary\n\n\n\nThere are no cyclical trends in either our shannon index or in our otu_1 abundance Our data is considered non-stationary which would make it not possible to model a time series based on previous time values\n\n\n\nThere does seem to be a correlation between different groups of OTU’s- lets examine this:\n\n#Counts\n# cor_mat = otu_counts[,-1]\n# #cor() computes the correlation coefficient\n# c_m = cor( cor_mat, method = \"pearson\")\n\n#Relative Abundance\notu_p_wide &lt;- otu_p %&gt;%\n  pivot_wider(names_from = OTU, values_from = Abundance) %&gt;%\n  replace(is.na(.), 0)\n#remove date column\notu_p_wide = otu_p_wide[,-1]\nc_m_a = cor(otu_p_wide, method = \"pearson\")\n\n#heatmap(c_m)\n\nResults show: - When calculating correlation coefficient between counts- little to no correlation between OTU’s - When calculating correlation coefficient between relative abundance- high correlations can be seen"
  },
  {
    "objectID": "trend_decomposition.html#seasonal-decomposition",
    "href": "trend_decomposition.html#seasonal-decomposition",
    "title": "Decomposition of Trends",
    "section": "",
    "text": "For Shannon Index\n\ntryCatch({\n  otu_1_shannon %&gt;% decompose(type = \"additive\") %&gt;% \n    autoplot()\n}, error = function(e) {\n  message(\"An error occurred: \", e$message)\n})\n\nAn error occurred: time series has no or less than 2 periods\n\n\nResult: Error in decompose(): ! time series has no or less than 2 periods\n\ntryCatch({\n    otu_1_abundance %&gt;% decompose(type=\"additive\") %&gt;%\n    autoplot()\n}, error = function(e) {\n  message(\"An error occurred: \", e$message)\n})\n\nAn error occurred: time series has no or less than 2 periods\n\ntryCatch({\n    otu_1_count%&gt;% decompose(type=\"additive\") %&gt;%\n    autoplot()\n}, error = function(e) {\n  message(\"An error occurred: \", e$message)\n})\n\nAn error occurred: time series has no or less than 2 periods\n\n\nResult: Error in decompose(): ! time series has no or less than 2 periods"
  },
  {
    "objectID": "trend_decomposition.html#stl-decomposition",
    "href": "trend_decomposition.html#stl-decomposition",
    "title": "Decomposition of Trends",
    "section": "",
    "text": "For Shannon Index\n\ntryCatch({\n    otu_1_shannon  %&gt;%\n    stl(s.window=\"periodic\", robust=TRUE) %&gt;%\n    autoplot()\n}, error = function(e) {\n  message(\"An error occurred: \", e$message)\n})\n\nAn error occurred: series is not periodic or has less than two periods\n\ntryCatch({\n    otu_1_abundance  %&gt;%\n    stl(s.window=\"periodic\", robust=TRUE) %&gt;%\n    autoplot()\n}, error = function(e) {\n  message(\"An error occurred: \", e$message)\n})\n\nAn error occurred: series is not periodic or has less than two periods\n\n\nResult: Error in decompose(): ! time series has no or less than 2 periods"
  },
  {
    "objectID": "trend_decomposition.html#stationarity-check",
    "href": "trend_decomposition.html#stationarity-check",
    "title": "Decomposition of Trends",
    "section": "",
    "text": "Augmented Dickey-Fuller Test: This is a statistical test that checks for the presence of a unit root in the time series. If the test indicates that there is no unit root, then the time series is likely stationary.\nFor Shannon Index\n\nadf_test_shannon &lt;- adf.test(otu_1_shannon)\nprint(adf_test_shannon)\n\n\n    Augmented Dickey-Fuller Test\n\ndata:  otu_1_shannon\nDickey-Fuller = -1.9299, Lag order = 4, p-value = 0.6044\nalternative hypothesis: stationary\n\n\nResult: Not Stationary\nFor OTU 1 Counts\n\nadf_test_otu &lt;- adf.test(otu_1_abundance)\nprint(adf_test_otu)\n\n\n    Augmented Dickey-Fuller Test\n\ndata:  otu_1_abundance\nDickey-Fuller = -2.6805, Lag order = 4, p-value = 0.2971\nalternative hypothesis: stationary\n\n#adf.test(otu_1_count) \n\nResult: Not Stationary\nKwiatkowski-Phillips-Schmidt-Shin Test: his test checks for the presence of a trend or structural break in the time series. If the test indicates that there is no trend or structural break, then the time series may be considered stationary.\nFor Shannon Index\n\nkpss.test(otu_1_shannon)\n\nWarning in kpss.test(otu_1_shannon): p-value smaller than printed p-value\n\n\n\n    KPSS Test for Level Stationarity\n\ndata:  otu_1_shannon\nKPSS Level = 0.89563, Truncation lag parameter = 3, p-value = 0.01\n\n\nResult: Not Stationary\nFor OTU 1\n\n#on relative abudance\nkpss.test(otu_1_abundance)\n\nWarning in kpss.test(otu_1_abundance): p-value smaller than printed p-value\n\n\n\n    KPSS Test for Level Stationarity\n\ndata:  otu_1_abundance\nKPSS Level = 0.92455, Truncation lag parameter = 3, p-value = 0.01\n\nkpss.test(otu_1_count)\n\nWarning in kpss.test(otu_1_count): p-value smaller than printed p-value\n\n\n\n    KPSS Test for Level Stationarity\n\ndata:  otu_1_count\nKPSS Level = 0.89444, Truncation lag parameter = 3, p-value = 0.01\n\n\nResult: Not Stationary"
  },
  {
    "objectID": "trend_decomposition.html#conclusion",
    "href": "trend_decomposition.html#conclusion",
    "title": "Decomposition of Trends",
    "section": "",
    "text": "There are no cyclical trends in either our shannon index or in our otu_1 abundance Our data is considered non-stationary which would make it not possible to model a time series based on previous time values"
  },
  {
    "objectID": "trend_decomposition.html#so-what-can-we-model",
    "href": "trend_decomposition.html#so-what-can-we-model",
    "title": "Decomposition of Trends",
    "section": "",
    "text": "There does seem to be a correlation between different groups of OTU’s- lets examine this:\n\n#Counts\n# cor_mat = otu_counts[,-1]\n# #cor() computes the correlation coefficient\n# c_m = cor( cor_mat, method = \"pearson\")\n\n#Relative Abundance\notu_p_wide &lt;- otu_p %&gt;%\n  pivot_wider(names_from = OTU, values_from = Abundance) %&gt;%\n  replace(is.na(.), 0)\n#remove date column\notu_p_wide = otu_p_wide[,-1]\nc_m_a = cor(otu_p_wide, method = \"pearson\")\n\n#heatmap(c_m)\n\nResults show: - When calculating correlation coefficient between counts- little to no correlation between OTU’s - When calculating correlation coefficient between relative abundance- high correlations can be seen"
  },
  {
    "objectID": "correlation_matrix.html",
    "href": "correlation_matrix.html",
    "title": "Correlations",
    "section": "",
    "text": "Correlations describe the strength of association between two variables. By understanding if specific species have any relevant associations, it could be possible to determine a larger microbial community composition from just a few individual species.",
    "crumbs": [
      "Observable Patterns",
      "Correlations"
    ]
  },
  {
    "objectID": "correlation_matrix.html#correlation-between-count-data-with-pearson-correlation-coefficient",
    "href": "correlation_matrix.html#correlation-between-count-data-with-pearson-correlation-coefficient",
    "title": "Correlations",
    "section": "Correlation between count data with Pearson Correlation Coefficient",
    "text": "Correlation between count data with Pearson Correlation Coefficient\nPearson’s Product - Moment Correlation Coefficient is a statistical measure of the strength of a linear relationship between paired data. It assumes that the data is: - interval or ratio level - linearly related - bivariate normally distributed\nThis graph shows correlations higher than 75%\n\ncorrelation = np.corrcoef(a.T)\n\n/Users/julietmalkowski/Desktop/Research/Micro/env/lib/python3.10/site-packages/numpy/lib/_function_base_impl.py:2922: RuntimeWarning: invalid value encountered in divide\n  c /= stddev[:, None]\n/Users/julietmalkowski/Desktop/Research/Micro/env/lib/python3.10/site-packages/numpy/lib/_function_base_impl.py:2923: RuntimeWarning: invalid value encountered in divide\n  c /= stddev[None, :]\n\n\n\nmask = ((correlation &gt; 0.75) & (correlation &lt; 0.99)) | ((correlation &lt; -0.75) & (correlation &gt; -0.99))\n\ntriangle_mask = np.tri(correlation.shape[0], k=0)\n\n# Plotting\nfig = plt.figure()\n# Put in title and axis labels\nfig.suptitle('Correlation Matrix of OTU Counts Over Time')\nax = fig.add_subplot(111)\n\n# Use the mask to display the significant correlations\nmasked_correlation = np.ma.masked_where(~mask, correlation)\ntriangle_mask[triangle_mask == 0] = np.nan\n\ncax = ax.matshow(masked_correlation, cmap='coolwarm', vmin=-1, vmax=1)\nax.imshow(triangle_mask, cmap='twilight')\nfig.colorbar(cax)\n\nplt.show()",
    "crumbs": [
      "Observable Patterns",
      "Correlations"
    ]
  },
  {
    "objectID": "correlation_matrix.html#correlation-with-spearman-correlation-coefficient",
    "href": "correlation_matrix.html#correlation-with-spearman-correlation-coefficient",
    "title": "Correlations",
    "section": "Correlation with Spearman Correlation Coefficient",
    "text": "Correlation with Spearman Correlation Coefficient\nBefore learning about Spearman’s correllation it is important to understand Spearman’s Correlation Coefficient assumes a monotonic relationship- where the value of one variable increases then the other never does A monotonic relationship is a relationship that does one of the following: (1) as the value of one variable increases, so does the value of the other variable; or (2) as the value of one variable increases, the other variable value decreases\n\ncorr_matrix, p_matrix = scipy.stats.spearmanr(filtered_abundance_time, axis=1)\ncorr_matrix[p_matrix&gt;0.05] = np.nan\ncorr_matrix[corr_matrix&gt;0.99] = np.nan\nmask = np.triu(np.ones_like(corr_matrix, dtype=bool))\nmasked_correlation_matrix = np.ma.masked_where(mask, corr_matrix)\n\nfig = plt.figure()\nfig.suptitle('P-value Matrix of OTU Counts Over Time Using Spearman')\nax = fig.add_subplot(111)\n\ncax = ax.pcolormesh(masked_correlation_matrix,cmap='coolwarm', vmin=-1, vmax=1)\nfig.colorbar(cax)\nplt.show()",
    "crumbs": [
      "Observable Patterns",
      "Correlations"
    ]
  },
  {
    "objectID": "cointegration.html",
    "href": "cointegration.html",
    "title": "Cointegration between species",
    "section": "",
    "text": "Steps: 1. check for stationarity for all species by running a unit root test 2. check for stationarity in difference between all species\n\n# import pandas as pd\n# import numpy as np\n# from statsmodels.tsa.vector_ar.vecm import coint_johansen\n# import statsmodels.tsa.stattools as ts\n# from statsmodels.tsa.stattools import adfuller\n\n\n# abundance_table = pd.read_excel('/Users/julietmalkowski/Desktop/Research/Kinetic_Model/abundance_table.xlsx')\n# #remove first 4 characters in every column name\n# abundance_table.columns = abundance_table.columns.str[4:] \n# #split string in column to get date and process\n# abundance_table[['Process','Date']] = abundance_table['le'].str.split('_',expand=True)\n# abundance_table = abundance_table.drop(columns=['le'])\n# #keep only AS-1 and AS-2 data\n# processes = ['AS-1', 'AS-2']\n# as_abundance_table = abundance_table[abundance_table['Process'].isin(processes)]\n# as_abundance_table = as_abundance_table.drop(columns=['Process'])\n# #group by date and find the mean of all values\n# as_abundance_table = as_abundance_table.groupby(['Date']).mean()\n# #remove last two rows of as_abundance_table\n# a = as_abundance_table.iloc[:,:-2]\n# a = a.reset_index()\n\nTranspose data so numpy array is for each species\n\n# species = a.T\n# #remove first row \n# species = species.iloc[1:,:]\n# species = species.reset_index()\n# headers = species.iloc[:,0]\n# species = species.iloc[:,1:]\n# headers = headers.to_numpy()\n# species = species.to_numpy()\n#structured_array = np.core.records.fromarrays(species, names=headers)\n\n#tranform to numpy array\n#species = species.to_numpy()\n\n\nFilter species that sum less than 10\n\n# mask = np.sum(species, axis=1) &gt; 10\n# #remove numpy arrrays who sum to less than 10 counts\n# headers = headers[mask]\n# species = species[mask]\n\n\n\nRun AD-Dickey Fuller Test\n\n# from collections import deque\n\n# def stationary_test(species):\n#     # create deque array\n#     result = deque()\n#     constant_counter = 0\n#     for i, value in enumerate(species):\n#         if value.max() == value.min():\n#             result.append(1)\n#             constant_counter += 1\n#             continue\n#         result.append(ts.adfuller(value)[1], 'n')\n\n#     print(constant_counter, 'species were constant (could not compute adfuller)')\n#     return np.array(result)\n\n# result = stationary_test(species)\n\n# # Create the mask\n# mask1 = (0.001 &lt; result) & (result &lt; 0.05)\n# mask2 = result &gt; 0.05\n\n# headers_stationary = headers[mask1]\n# headers_non_stationary = headers[mask2]\n\n\n# species_non_stationary = species[mask2]\n# species_non_stationary = species_non_stationary.astype(np.float64)\n\n# species_stationary = species[mask1]\n# species_stationary= species_stationary.astype(np.float64)\n\nFor non-stationary data: shape = 4162\n#Johansen Test with only 12 groups Perform Johansen Test\n\n# Johansen test\n# j_test = coint_johansen(species_non_stationary, det_order=0, k_ar_diff=1)\n\n# # Display the test statistics and critical values\n# trace_stat = j_test.lr1\n# critical_values = j_test.cvt\n\n# resulting_species = deque()\n# insufficient_data_species = deque()\n\n# for i in range(len(trace_stat)):\n#     if trace_stat[i] &gt; critical_values[i][0]:\n#         resulting_species.append(0)\n#     if trace_stat[i] &lt; critical_values[i][0]:\n#         resulting_species.append(1)\n#     if np.isnan(critical_values[i][0]) == True :\n#         resulting_species.append(0.5)\n#         insufficient_data_species.append(1)\n\n# cointegrated_mask = (resulting_species == 0)\n\n# headers_cointegrated = headers_stationary[cointegrated_mask ]\n\nIf the trace statistic is greater than the critical value at a given significance level (e.g., 95%), reject the null hypothesis of no cointegration for that rank.\nFor stationary data: shape = 2646"
  },
  {
    "objectID": "linear_regressions.html",
    "href": "linear_regressions.html",
    "title": "Activated Sludge Model",
    "section": "",
    "text": "One of the primary methods for exploring data is through linear regressions. Linear regressions work under the assumption that the x and y variables is linear and that it follows a normal distribution. To check if the data is actually linear, four diagnostic plots are created to check whether the assumptions made by the linear model are met.\nLinear Regressions were run for both Shannon Index and OTU 1 Relative Abundance, which has been shown to be highly prevelant in almost all AS samples.\nShannon Index was calculated after filtering out relative abunadnces above 1%\n\n\n\notu_mat&lt;- read_excel(\"/Users/julietmalkowski/Desktop/Research/Kinetic_Model/abundance_table.xlsx\")\n#remove first 4 characters in every column name\ncolnames(otu_mat)&lt;- substr(colnames(otu_mat), 5, nchar(colnames(otu_mat)))\notu_mat = as.data.frame(otu_mat)\n#split first column by character '_' into two seperate columns\notu_mat[c('Process', 'Date')] &lt;- str_split_fixed(otu_mat$le, '_', 2)\n#drop le column\notu_mat = otu_mat[,-1]\n#move last two columns to the front\notu_mat &lt;- otu_mat %&gt;%\n  select(Process, everything())\notu_mat &lt;- otu_mat %&gt;%\n  select(Date, everything())\n#filter otu_mat to only contain AS-1 and AS-2 in process column\notu_mat &lt;- otu_mat %&gt;%\n  filter(Process == \"AS-1\" | Process == \"AS-2\")\n#remove Process column\notu_mat = otu_mat[,-2]\n#groupby date and find the mean of each column\notu_counts &lt;- otu_mat %&gt;%\n  group_by(Date) %&gt;%\n  summarise_all(mean)\notu_p = otu_counts\n#find the sum of each row\notu_p$sum &lt;- rowSums(otu_p[,-1])\n#divide each row by the sum\notu_p[,-1] &lt;- otu_p[,-1] / otu_p$sum\n#remove sum column\notu_p = otu_p[,-ncol(otu_p)]\n#make otu_p from wide form to long form\notu_p &lt;- otu_p %&gt;%\n  pivot_longer(cols = -Date, names_to = \"OTU\", values_to = \"Abundance\")\n#filter out rows with an Abundance less than 0.01\notu_p &lt;- otu_p %&gt;%\n  filter(Abundance &gt;= 0.01)\n#calculate Shannon Index and add it to otu_p column\nshannon = function(x) {\n  -sum(x * log(x))\n}\notu_shannon = otu_p\ns = otu_shannon %&gt;% group_by(Date) %&gt;%\n  summarize(Shannon = shannon(Abundance))\notu_shannon = merge(otu_shannon, s, by = \"Date\")\noutput_metadata &lt;- read_excel(\"/Users/julietmalkowski/Desktop/Research/Kinetic_Model/AS_metadata.xlsx\")\noutput_metadata = as.data.frame(output_metadata)\n\n#input parameters\ninput_metadata = output_metadata\ninput_metadata = input_metadata[,c(2,3,5,7,10,12,14,16,18,20)]\ninput_data = input_metadata\ninput_data = merge(otu_shannon, input_metadata, by = \"Date\")\n\n#output parameters\noutput_metadata = output_metadata[,-c(1,3:8,10,12,14:20)]\noutput_data = merge(otu_shannon, output_metadata, by = \"Date\")\n#change column 6 name\ncolnames(output_data)[6] &lt;- \"BOD_CBOD_Load_Removed\""
  },
  {
    "objectID": "linear_regressions.html#linear-regressions-on-input-and-output-parameters",
    "href": "linear_regressions.html#linear-regressions-on-input-and-output-parameters",
    "title": "Activated Sludge Model",
    "section": "",
    "text": "One of the primary methods for exploring data is through linear regressions. Linear regressions work under the assumption that the x and y variables is linear and that it follows a normal distribution. To check if the data is actually linear, four diagnostic plots are created to check whether the assumptions made by the linear model are met.\nLinear Regressions were run for both Shannon Index and OTU 1 Relative Abundance, which has been shown to be highly prevelant in almost all AS samples.\nShannon Index was calculated after filtering out relative abunadnces above 1%\n\n\n\notu_mat&lt;- read_excel(\"/Users/julietmalkowski/Desktop/Research/Kinetic_Model/abundance_table.xlsx\")\n#remove first 4 characters in every column name\ncolnames(otu_mat)&lt;- substr(colnames(otu_mat), 5, nchar(colnames(otu_mat)))\notu_mat = as.data.frame(otu_mat)\n#split first column by character '_' into two seperate columns\notu_mat[c('Process', 'Date')] &lt;- str_split_fixed(otu_mat$le, '_', 2)\n#drop le column\notu_mat = otu_mat[,-1]\n#move last two columns to the front\notu_mat &lt;- otu_mat %&gt;%\n  select(Process, everything())\notu_mat &lt;- otu_mat %&gt;%\n  select(Date, everything())\n#filter otu_mat to only contain AS-1 and AS-2 in process column\notu_mat &lt;- otu_mat %&gt;%\n  filter(Process == \"AS-1\" | Process == \"AS-2\")\n#remove Process column\notu_mat = otu_mat[,-2]\n#groupby date and find the mean of each column\notu_counts &lt;- otu_mat %&gt;%\n  group_by(Date) %&gt;%\n  summarise_all(mean)\notu_p = otu_counts\n#find the sum of each row\notu_p$sum &lt;- rowSums(otu_p[,-1])\n#divide each row by the sum\notu_p[,-1] &lt;- otu_p[,-1] / otu_p$sum\n#remove sum column\notu_p = otu_p[,-ncol(otu_p)]\n#make otu_p from wide form to long form\notu_p &lt;- otu_p %&gt;%\n  pivot_longer(cols = -Date, names_to = \"OTU\", values_to = \"Abundance\")\n#filter out rows with an Abundance less than 0.01\notu_p &lt;- otu_p %&gt;%\n  filter(Abundance &gt;= 0.01)\n#calculate Shannon Index and add it to otu_p column\nshannon = function(x) {\n  -sum(x * log(x))\n}\notu_shannon = otu_p\ns = otu_shannon %&gt;% group_by(Date) %&gt;%\n  summarize(Shannon = shannon(Abundance))\notu_shannon = merge(otu_shannon, s, by = \"Date\")\noutput_metadata &lt;- read_excel(\"/Users/julietmalkowski/Desktop/Research/Kinetic_Model/AS_metadata.xlsx\")\noutput_metadata = as.data.frame(output_metadata)\n\n#input parameters\ninput_metadata = output_metadata\ninput_metadata = input_metadata[,c(2,3,5,7,10,12,14,16,18,20)]\ninput_data = input_metadata\ninput_data = merge(otu_shannon, input_metadata, by = \"Date\")\n\n#output parameters\noutput_metadata = output_metadata[,-c(1,3:8,10,12,14:20)]\noutput_data = merge(otu_shannon, output_metadata, by = \"Date\")\n#change column 6 name\ncolnames(output_data)[6] &lt;- \"BOD_CBOD_Load_Removed\""
  },
  {
    "objectID": "linear_regressions.html#connecting-metadata-and-otu-counts",
    "href": "linear_regressions.html#connecting-metadata-and-otu-counts",
    "title": "Activated Sludge Model",
    "section": "Connecting Metadata and OTU Counts",
    "text": "Connecting Metadata and OTU Counts\n\noutput_metadata &lt;- read_excel(\"/Users/julietmalkowski/Desktop/Research/Kinetic_Model/AS_metadata.xlsx\")\noutput_metadata = as.data.frame(output_metadata)\n\n#input parameters\ninput_metadata = output_metadata\ninput_metadata = input_metadata[,c(2,3,5,7,10,12,14,16,18,20)]\ninput_data = input_metadata\ninput_data = merge(otu_shannon, input_metadata, by = \"Date\")\ncolnames(input_data)[8] &lt;- \"BOD_CBOD_Load_PE\"\n\n#output parameters\noutput_metadata = output_metadata[,-c(1,3:8,10,12,14:20)]\noutput_data = merge(otu_shannon, output_metadata, by = \"Date\")\n#change column 6 name\ncolnames(output_data)[6] &lt;- \"BOD_CBOD_Load_Removed\"\n#remove column in output_data\ninput_data_ = input_data[,-c(2:4)]\ninput_data_ = as.data.frame(input_data_)\n#remove duplicates\ninput_data_ = input_data_[!duplicated(input_data_[,1]),]\n#make first column rownames in output_data_\nrownames(input_data_) &lt;- input_data_[,1]\n#remove first column\ninput_data_ = input_data_[,-1]"
  },
  {
    "objectID": "linear_regressions.html#effect-of-input-parameters-on-shannon-index",
    "href": "linear_regressions.html#effect-of-input-parameters-on-shannon-index",
    "title": "Activated Sludge Model",
    "section": "Effect of Input Parameters on Shannon Index",
    "text": "Effect of Input Parameters on Shannon Index\nInterpretation for plots:\nPlot 1- distribution of residuals according to values predicted by linear regression model- each point represents the distance between the response variable and the model prediction- we need a uniform distribution of the residual. For this plot we need a uniform distribution of the residuals- the homoscedasticity condition. This condition states that if the residuals form an approximate horizontal band around the 0 line, the variance of the residuals is homogeneous.\nPlot 2- checks if the dispersion of residuals is caused by the explanatory variable- if the dispersion increases then it means the variances in each group are different\nPlot 3- this plot shows the distribution of residuals in a quantile- quantile plot which evaluated the normality of the residuals. This plot compares the probability distribution of normal data and standardized residuals can be seen near the 1:1 line\nPlot 4- shows the residuals and their influence- the location of points with strong influence can influence the interpretation of the data. If one or more observations are outliers then the model may be misfitted because of their exaggerated influence. A distance greater than 0.5 is problematic\n\n#create multiple linear regression\nlm.mult &lt;- lm(Shannon ~ pH_RSS + temp_RSS + BOD_CBOD_Load_PE + COD_Load_PE + Ammonia_Load_RAW + TKN_Load_RAW + P_Load_PE + SCT_Detention_Time, data = input_data)\nsummary(lm.mult)\n\n\nCall:\nlm(formula = Shannon ~ pH_RSS + temp_RSS + BOD_CBOD_Load_PE + \n    COD_Load_PE + Ammonia_Load_RAW + TKN_Load_RAW + P_Load_PE + \n    SCT_Detention_Time, data = input_data)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.34785 -0.09712 -0.01016  0.09621  0.24081 \n\nCoefficients:\n                     Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)         7.029e+00  7.191e-01   9.774  &lt; 2e-16 ***\npH_RSS             -7.538e-01  9.354e-02  -8.059 3.07e-15 ***\ntemp_RSS            5.310e-03  2.843e-03   1.868   0.0622 .  \nBOD_CBOD_Load_PE   -3.662e-03  7.574e-04  -4.835 1.62e-06 ***\nCOD_Load_PE        -8.535e-05  5.977e-04  -0.143   0.8865    \nAmmonia_Load_RAW    1.744e-02  8.422e-03   2.071   0.0387 *  \nTKN_Load_RAW        5.030e-03  5.600e-03   0.898   0.3694    \nP_Load_PE          -6.895e-01  6.578e-02 -10.482  &lt; 2e-16 ***\nSCT_Detention_Time  4.037e-01  2.272e-02  17.768  &lt; 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.13 on 743 degrees of freedom\nMultiple R-squared:  0.5613,    Adjusted R-squared:  0.5566 \nF-statistic: 118.8 on 8 and 743 DF,  p-value: &lt; 2.2e-16\n\npar(mfrow = c(2, 2), mar = c(3.9, 4, 1.2, 1.1), oma = c(0, 0,\n                                                        0, 0))\nplot(lm.mult)\n\n\n\n\nAs can be seen above, the results from each plot do not meet the assumptions of linear regression. The residuals are not homoscedastic, the residuals are not normally distributed, and there are outliers that are influencing the model.\nSignificant values include pH_RSS, BOD_CBOD_Load_PE,Ammonia_Load_RAW, P_Load_PE, and SCT_Detention_Time.\nTo fix this data run now with only significant values\n\nlm.mult2 &lt;- lm(Shannon ~ pH_RSS + BOD_CBOD_Load_PE + Ammonia_Load_RAW + P_Load_PE + SCT_Detention_Time, data = input_data)\nsummary(lm.mult2)\n\n\nCall:\nlm(formula = Shannon ~ pH_RSS + BOD_CBOD_Load_PE + Ammonia_Load_RAW + \n    P_Load_PE + SCT_Detention_Time, data = input_data)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.32219 -0.09688 -0.01303  0.08360  0.23466 \n\nCoefficients:\n                     Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)         7.0131513  0.6862416  10.220  &lt; 2e-16 ***\npH_RSS             -0.7265873  0.0904217  -8.036 3.64e-15 ***\nBOD_CBOD_Load_PE   -0.0036932  0.0007406  -4.987 7.65e-07 ***\nAmmonia_Load_RAW    0.0124405  0.0081474   1.527    0.127    \nP_Load_PE          -0.6479527  0.0629724 -10.289  &lt; 2e-16 ***\nSCT_Detention_Time  0.3780273  0.0191689  19.721  &lt; 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.1304 on 746 degrees of freedom\nMultiple R-squared:  0.5566,    Adjusted R-squared:  0.5536 \nF-statistic: 187.3 on 5 and 746 DF,  p-value: &lt; 2.2e-16\n\npar(mfrow = c(2, 2), mar = c(3.9, 4, 1.2, 1.1), oma = c(0, 0,\n                                                        0, 0))\nplot(lm.mult2)\n\n\n\n\nNow we see slightly better results with Ammonia_Loading no longer being relevant"
  },
  {
    "objectID": "linear_regressions.html#determine-most-important-input-parameters-based-on-relative-abundances",
    "href": "linear_regressions.html#determine-most-important-input-parameters-based-on-relative-abundances",
    "title": "Activated Sludge Model",
    "section": "Determine Most Important Input Parameters based on Relative Abundances",
    "text": "Determine Most Important Input Parameters based on Relative Abundances\nUsing Redundancy Analysis\n\notu_p_wide &lt;- otu_p %&gt;%\n  pivot_wider(names_from = OTU, values_from = Abundance) %&gt;%\n  replace(is.na(.), 0)\notu_p_wide = as.data.frame(otu_p_wide)\n#make first column rownames in output_data_\nrownames(otu_p_wide) &lt;- otu_p_wide[,1]\n#remove first column\notu_p_wide = otu_p_wide[,-1]\n\nas_metadata_input.z &lt;- decostand(input_data_, method = \"standardize\")\nas_metadata_input.rda &lt;- rda(otu_p_wide  ~ ., data = as_metadata_input.z)\n\nfwd.sel &lt;- ordiR2step(rda(otu_p_wide ~ 1, data = as_metadata_input.z), # lower model limit (simple!)\n                      scope = formula(as_metadata_input.rda), # upper model limit (the \"full\" model)\n                      direction = \"forward\",\n                      R2scope = TRUE, # can't surpass the \"full\" model's R2\n                      pstep = 1000,\n                      trace = FALSE) # change to TRUE to see the selection process\n#see which variables were selected\nfwd.sel$call\n\nrda(formula = otu_p_wide ~ temp_RSS + SCT_Detention_Time + P_Load_PE + \n    TKN_Load_RAW + Ammonia_Load_RAW, data = as_metadata_input.z)\n\n\n#result RDA is: rda(formula = otu_p_wide ~ temp_RSS + SCT_Detention_Time + P_Load_PE + TKN_Load_RAW + Ammonia_Load_RAW, data = as_metadata_input.z)"
  },
  {
    "objectID": "linear_regressions.html#effect-of-shannon-index-on-output-parameters-using-linear-regression",
    "href": "linear_regressions.html#effect-of-shannon-index-on-output-parameters-using-linear-regression",
    "title": "Activated Sludge Model",
    "section": "Effect of Shannon Index on Output Parameters using Linear Regression",
    "text": "Effect of Shannon Index on Output Parameters using Linear Regression\n\nlm1 &lt;- lm(COD_Load_Removed ~ Shannon, data = output_data)\npar(mfrow = c(2, 2))\nplot(lm1)\ntitle(\"Linear Model for COD_Load_Removed ~ Shannon\", line = -1, outer = TRUE)\n\n\n\nsummary(lm1)\n\n\nCall:\nlm(formula = COD_Load_Removed ~ Shannon, data = output_data)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-50.154  -7.706   1.259   8.229  44.484 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)   85.394      1.966   43.42  &lt; 2e-16 ***\nShannon       10.044      2.729    3.68  0.00025 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 14.6 on 750 degrees of freedom\nMultiple R-squared:  0.01773,   Adjusted R-squared:  0.01642 \nF-statistic: 13.54 on 1 and 750 DF,  p-value: 0.0002502\n\nlm2 &lt;- lm(P_Removed ~ Shannon, data = output_data)\npar(mfrow = c(2, 2))\nplot(lm2)\ntitle(\"Linear Model for P_Removed ~ Shannon\", line = -1, outer = TRUE)\n\n\n\nsummary(lm2)\n\n\nCall:\nlm(formula = P_Removed ~ Shannon, data = output_data)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.91548 -0.20519  0.06134  0.24145  0.54031 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)  0.34889    0.04382   7.961  6.3e-15 ***\nShannon      0.90793    0.06083  14.927  &lt; 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.3254 on 750 degrees of freedom\nMultiple R-squared:  0.229, Adjusted R-squared:  0.228 \nF-statistic: 222.8 on 1 and 750 DF,  p-value: &lt; 2.2e-16\n\nlm3 &lt;- lm(TKN_Removed ~ Shannon, data = output_data)\npar(mfrow = c(2, 2))\nplot(lm3)\ntitle(\"Linear Model for TKN_Removed ~ Shannon\", line = -1, outer = TRUE)\n\n\n\nsummary(lm3)\n\n\nCall:\nlm(formula = TKN_Removed ~ Shannon, data = output_data)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-2.5674 -0.1711  0.2739  0.5188  1.3956 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)   2.3620     0.1218  19.399   &lt;2e-16 ***\nShannon      -1.4782     0.1690  -8.747   &lt;2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.904 on 750 degrees of freedom\nMultiple R-squared:  0.09257,   Adjusted R-squared:  0.09136 \nF-statistic: 76.51 on 1 and 750 DF,  p-value: &lt; 2.2e-16\n\nlm4 &lt;- lm(Ammonia_Removed ~ Shannon, data = output_data)\npar(mfrow = c(2, 2))\nplot(lm4)\ntitle(\"Linear Model for Ammonia_Removed ~ Shannon\", line = -1, outer = TRUE)\n\n\n\nsummary(lm4)\n\n\nCall:\nlm(formula = Ammonia_Removed ~ Shannon, data = output_data)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-4.1028 -0.6071  0.1175  0.7188  2.7766 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)  -5.6568     0.1572 -35.978  &lt; 2e-16 ***\nShannon       0.9177     0.2182   4.205 2.92e-05 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 1.167 on 750 degrees of freedom\nMultiple R-squared:  0.02304,   Adjusted R-squared:  0.02173 \nF-statistic: 17.69 on 1 and 750 DF,  p-value: 2.921e-05\n\nlm5 &lt;- lm(BOD_CBOD_Load_Removed ~ Shannon, data = output_data)\npar(mfrow = c(2, 2))\nplot(lm5)\ntitle(\"Linear Model for BOD_CBOD_Load_Removed ~ Shannon\", line = -1, outer = TRUE)\n\n\n\nsummary(lm5)\n\n\nCall:\nlm(formula = BOD_CBOD_Load_Removed ~ Shannon, data = output_data)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-44.966  -4.542   0.553   4.702  14.932 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)    40.41       1.16  34.839   &lt;2e-16 ***\nShannon         3.64       1.61   2.261    0.024 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 8.612 on 750 degrees of freedom\nMultiple R-squared:  0.006771,  Adjusted R-squared:  0.005446 \nF-statistic: 5.113 on 1 and 750 DF,  p-value: 0.02404\n\n\nResulting p-values are all significant: In order: COD_Load_Removed:0.00025 P_Removed: 2e-16 TKN_Removed: 2e-16 Ammonia_Removed: 2.92e-05 BOD_CBOD_Load_Removed: 0.024"
  },
  {
    "objectID": "linear_regressions.html#otu-1-analysis-comparing-glm-and-lm",
    "href": "linear_regressions.html#otu-1-analysis-comparing-glm-and-lm",
    "title": "Activated Sludge Model",
    "section": "OTU 1 Analysis Comparing GLM and LM",
    "text": "OTU 1 Analysis Comparing GLM and LM\nThe generalized linear model is able to use a specific binomial distribution (where input values range between 0-1) on the relative abundance data so the changes of the inputs on this distribution can be specifically calculated. This model also does not assume a linear relationship."
  },
  {
    "objectID": "linear_regressions.html#comparing-a-generalized-linear-model-vs.-linear-model-for-input-parameters-on-otu-1",
    "href": "linear_regressions.html#comparing-a-generalized-linear-model-vs.-linear-model-for-input-parameters-on-otu-1",
    "title": "Activated Sludge Model",
    "section": "Comparing a Generalized Linear Model vs. Linear Model for Input Parameters on OTU 1",
    "text": "Comparing a Generalized Linear Model vs. Linear Model for Input Parameters on OTU 1\n\n#generalized linear model\notu_1 &lt;- input_data %&gt;% filter(OTU == 1)\nmodel1 &lt;- glm(Abundance ~ temp_RSS + SCT_Detention_Time + P_Load_PE + TKN_Load_RAW + Ammonia_Load_RAW + pH_RSS + BOD_CBOD_Load_PE, family = binomial,\n              data = otu_1)\n\nWarning in eval(family$initialize): non-integer #successes in a binomial glm!\n\nsummary(model1)\n\n\nCall:\nglm(formula = Abundance ~ temp_RSS + SCT_Detention_Time + P_Load_PE + \n    TKN_Load_RAW + Ammonia_Load_RAW + pH_RSS + BOD_CBOD_Load_PE, \n    family = binomial, data = otu_1)\n\nCoefficients:\n                     Estimate Std. Error z value Pr(&gt;|z|)\n(Intercept)         3.2559247 96.5997353   0.034    0.973\ntemp_RSS           -0.0101602  0.3028600  -0.034    0.973\nSCT_Detention_Time  0.9027379  3.1992126   0.282    0.778\nP_Load_PE          -2.8495646  9.9857297  -0.285    0.775\nTKN_Load_RAW       -0.0008063  0.7355789  -0.001    0.999\nAmmonia_Load_RAW   -0.1687601  1.1657600  -0.145    0.885\npH_RSS              0.2028448 12.5584428   0.016    0.987\nBOD_CBOD_Load_PE    0.0031766  0.0969474   0.033    0.974\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 0.77079  on 80  degrees of freedom\nResidual deviance: 0.55062  on 73  degrees of freedom\nAIC: 21.189\n\nNumber of Fisher Scoring iterations: 7\n\npar(mfrow = c(2, 2))\nplot(model1)\ntitle(\"General Linear Model with OTU 1 Relative Abundance ~ SCT_Detention_Time\", line = -1, outer = TRUE)\n\n\n\n#normal linear model\nmodel2 &lt;- lm(Abundance ~  temp_RSS + SCT_Detention_Time + P_Load_PE + TKN_Load_RAW + Ammonia_Load_RAW + pH_RSS + BOD_CBOD_Load_PE,\n              data = otu_1)\nsummary(model2)\n\n\nCall:\nlm(formula = Abundance ~ temp_RSS + SCT_Detention_Time + P_Load_PE + \n    TKN_Load_RAW + Ammonia_Load_RAW + pH_RSS + BOD_CBOD_Load_PE, \n    data = otu_1)\n\nResiduals:\n      Min        1Q    Median        3Q       Max \n-0.021875 -0.010883 -0.002686  0.006813  0.094619 \n\nCoefficients:\n                     Estimate Std. Error t value Pr(&gt;|t|)   \n(Intercept)         0.1644549  0.2869814   0.573  0.56837   \ntemp_RSS           -0.0004897  0.0008712  -0.562  0.57577   \nSCT_Detention_Time  0.0231091  0.0084472   2.736  0.00781 **\nP_Load_PE          -0.0684792  0.0243500  -2.812  0.00631 **\nTKN_Load_RAW        0.0010703  0.0022119   0.484  0.62992   \nAmmonia_Load_RAW   -0.0044773  0.0033803  -1.325  0.18946   \npH_RSS              0.0067213  0.0381149   0.176  0.86051   \nBOD_CBOD_Load_PE    0.0001117  0.0002840   0.393  0.69518   \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.01673 on 73 degrees of freedom\nMultiple R-squared:  0.2346,    Adjusted R-squared:  0.1612 \nF-statistic: 3.196 on 7 and 73 DF,  p-value: 0.005231\n\npar(mfrow = c(2, 2))\nplot(model2)\ntitle(\"Linear Model with OTU 1 Relative Abundance ~ SCT_Detention_Time\", line = -1, outer = TRUE)\n\n\n\n\nHere we see the generalized linear model predict no significant values, while the linear model predicts significant values."
  },
  {
    "objectID": "linear_regressions.html#conclusions",
    "href": "linear_regressions.html#conclusions",
    "title": "Activated Sludge Model",
    "section": "Conclusions",
    "text": "Conclusions\nRelevant Input Parameters that explain 36% of variance in the data:\n\ntemp_RSS\nSCT_Detention_Time\nP_Load_PE\nTKN_Load_RAW\nAmmonia_Load_RAW\n\nRelevant Output Parameters from generalized linear model on OTU 1: - none"
  },
  {
    "objectID": "environmental_parameter_analysis.html",
    "href": "environmental_parameter_analysis.html",
    "title": "Environmental Parameter Analysis",
    "section": "",
    "text": "Annacis WWTP monitors many parameters flowing into the treatment plant (Primary Effluent) as well as leaving the treatment plant (Final Effluent)\nInfluent Parameters that were examined:\n\npH of RSS\ntemp of RSS\nBOD/CBOD Load\nCOD Load\nAmmonia Load\nTKN Load\nP Load\nSCT Detention Time\n\nEffluent Parameters that were examined:\n\nBOD/CBOD Load Removed\nCOD Load Removed\nP Removed\nTKN Removed\nAmmonia Removed\n\nThis analysis was run after linear regressions\n\n\nUsing values selected from RDA analysis\n\ne = ggplot() + \n  geom_line(data=input_data_,aes(x = Date,y = temp_RSS, color = \"temp_RSS\"),group = 1) +\n  ggtitle(\"RSS Temp Over Time\") + xlab(\"Month\") + ylab(\"temp (deg.C)\") + \n  scale_x_date(date_breaks = \"1 month\", date_labels = \"%m\") + theme(legend.position=\"top\")\n\nf = ggplot() + \n  geom_line(data=input_data_,aes(x = Date,y = SCT_Detention_Time, color = \"SCT_Detention_Time\"),group = 1) + \n  ggtitle(\"SCT_Detention_Time Over Time\") + xlab(\"Month\") + ylab(\"time (hr)\") + \n  scale_x_date(date_breaks = \"1 month\", date_labels = \"%m\") + theme(legend.position=\"top\")\n\ng = ggplot() + \n  geom_line(data=input_data_,aes(x = Date,y = P_Load_PE, color = \"P_Load_PE\"),group = 1) + \n  ggtitle(\"P_Load_PE Over Time\") + xlab(\"Month\") + ylab(\"mg/L\") + \n  scale_x_date(date_breaks = \"1 month\", date_labels = \"%m\") + theme(legend.position=\"top\")\n\nh = ggplot() + \n  geom_line(data=input_data_,aes(x = Date,y = TKN_Load_RAW, color = \"TKN_Load_RAW\"),group = 1) + \n  ggtitle(\"TKN_Load_RAW Over Time\") + xlab(\"Month\") + ylab(\"mg/L\") + \n  scale_x_date(date_breaks = \"1 month\", date_labels = \"%m\") + theme(legend.position=\"top\")\n\ni = ggplot() + \n  geom_line(data=input_data_,aes(x = Date,y = Ammonia_Load_RAW, color = \"Ammonia_Load_RAW\"),group = 1) + \n  ggtitle(\"Ammonia_Load_RAW\") + xlab(\"Month\") + ylab(\"mg/L\") + \n  scale_x_date(date_breaks = \"1 month\", date_labels = \"%m\") + theme(legend.position=\"top\")\n\nggarrange(e, f, g, h, i + rremove(\"x.text\"), \n          labels = c(\"A\", \"B\", \"C\", \"D\", \"E\"),\n          ncol = 2, nrow = 3)\n\n\n\n\n\n\n\n\na = ggplot() + \n  geom_line(data=output_data_,aes(x = Date,y = BOD_CBOD_Load_Removed, color = \"BOD_CBOD_Load_Removed\"),group = 1) + \n  geom_line(data=output_data_,aes(x = Date, y = COD_Load_Removed,color = \"COD_Load_Removed\"),group = 1) +\n  ggtitle(\"Output Parameters Over Time\") + xlab(\"Month\") + ylab(\"tonnes/day\") + \n  scale_x_date(date_breaks = \"1 month\", date_labels = \"%m\") + theme(legend.position=\"top\")\n\nb = ggplot() + \n  geom_line(data=output_data_,aes(x = Date,y = BOD_CBOD_Load_Removed, color = \"P_Removed\"),group = 1) + \n  ggtitle(\"P_Removed Over Time\") + xlab(\"Month\") + ylab(\"tonnes/day\") + \n  scale_x_date(date_breaks = \"1 month\", date_labels = \"%m\") + theme(legend.position=\"top\")\n\nc = ggplot() + \n  geom_line(data=output_data_,aes(x = Date,y = TKN_Removed, color = \"TKN_Removed\"),group = 1) + \n  ggtitle(\"TKN_Removed Over Time\") + xlab(\"Month\") + ylab(\"tonnes/day\") + \n  scale_x_date(date_breaks = \"1 month\", date_labels = \"%m\") + theme(legend.position=\"top\")\n\nd = ggplot() + \n  geom_line(data=output_data_,aes(x = Date,y = Ammonia_Removed, color = \"Ammonia_Removed\"),group = 1) + \n  ggtitle(\"Ammonia_Removed Over Time\") + xlab(\"Month\") + ylab(\"tonnes/day\") + \n  scale_x_date(date_breaks = \"1 month\", date_labels = \"%m\") + theme(legend.position=\"top\")\n\nggarrange(a, b, c, d + rremove(\"x.text\"), \n          labels = c(\"A\", \"B\", \"C\", \"D\"),\n          ncol = 2, nrow = 2)\n\n\n\n\n\n\n\n\nggplot() + \n  geom_line(data=s,aes(x = Date,y = Shannon, color = \"Shannon\"),group = 1) + \n  ggtitle(\"Shannon Index Over Time\") + xlab(\"Date\") + ylab(\"Shannon Index\") + theme(legend.position=\"top\") +\n  theme(axis.text.x = element_text(angle = 90, hjust = 1))\n\n\n\n\n\n\n\n\n#put character z in front of all columns\ncolnames(otu_counts) &lt;- paste0(\"z\", colnames(otu_counts))\n#select only columns named '1' in otu_counts\notus &lt;- select(otu_counts,z1,z4,z2,z6,zDate)\n\n#plot the data\nggplot() + \n  geom_line(data=otus,aes(x = zDate, y = z1, color = \"1\"),group = 1) + \n  geom_line(data=otus,aes(x = zDate, y = z4,color = \"4\"),group = 1) +\n  geom_line(data=otus,aes(x = zDate, y = z2,color = \"2\"),group = 1) +\n  geom_line(data=otus,aes(x = zDate, y = z6 ,color = \"6\"),group = 1) +\n  ggtitle(\"OTU 1,4,2,6 Over Time\") + xlab(\"Date\") + ylab(\"Abundance\") + theme(legend.position=\"top\") +\n  theme(axis.text.x = element_text(angle = 90, hjust = 1))"
  },
  {
    "objectID": "environmental_parameter_analysis.html#input-visualization",
    "href": "environmental_parameter_analysis.html#input-visualization",
    "title": "Environmental Parameter Analysis",
    "section": "",
    "text": "Using values selected from RDA analysis\n\ne = ggplot() + \n  geom_line(data=input_data_,aes(x = Date,y = temp_RSS, color = \"temp_RSS\"),group = 1) +\n  ggtitle(\"RSS Temp Over Time\") + xlab(\"Month\") + ylab(\"temp (deg.C)\") + \n  scale_x_date(date_breaks = \"1 month\", date_labels = \"%m\") + theme(legend.position=\"top\")\n\nf = ggplot() + \n  geom_line(data=input_data_,aes(x = Date,y = SCT_Detention_Time, color = \"SCT_Detention_Time\"),group = 1) + \n  ggtitle(\"SCT_Detention_Time Over Time\") + xlab(\"Month\") + ylab(\"time (hr)\") + \n  scale_x_date(date_breaks = \"1 month\", date_labels = \"%m\") + theme(legend.position=\"top\")\n\ng = ggplot() + \n  geom_line(data=input_data_,aes(x = Date,y = P_Load_PE, color = \"P_Load_PE\"),group = 1) + \n  ggtitle(\"P_Load_PE Over Time\") + xlab(\"Month\") + ylab(\"mg/L\") + \n  scale_x_date(date_breaks = \"1 month\", date_labels = \"%m\") + theme(legend.position=\"top\")\n\nh = ggplot() + \n  geom_line(data=input_data_,aes(x = Date,y = TKN_Load_RAW, color = \"TKN_Load_RAW\"),group = 1) + \n  ggtitle(\"TKN_Load_RAW Over Time\") + xlab(\"Month\") + ylab(\"mg/L\") + \n  scale_x_date(date_breaks = \"1 month\", date_labels = \"%m\") + theme(legend.position=\"top\")\n\ni = ggplot() + \n  geom_line(data=input_data_,aes(x = Date,y = Ammonia_Load_RAW, color = \"Ammonia_Load_RAW\"),group = 1) + \n  ggtitle(\"Ammonia_Load_RAW\") + xlab(\"Month\") + ylab(\"mg/L\") + \n  scale_x_date(date_breaks = \"1 month\", date_labels = \"%m\") + theme(legend.position=\"top\")\n\nggarrange(e, f, g, h, i + rremove(\"x.text\"), \n          labels = c(\"A\", \"B\", \"C\", \"D\", \"E\"),\n          ncol = 2, nrow = 3)"
  },
  {
    "objectID": "environmental_parameter_analysis.html#output-visualization",
    "href": "environmental_parameter_analysis.html#output-visualization",
    "title": "Environmental Parameter Analysis",
    "section": "",
    "text": "a = ggplot() + \n  geom_line(data=output_data_,aes(x = Date,y = BOD_CBOD_Load_Removed, color = \"BOD_CBOD_Load_Removed\"),group = 1) + \n  geom_line(data=output_data_,aes(x = Date, y = COD_Load_Removed,color = \"COD_Load_Removed\"),group = 1) +\n  ggtitle(\"Output Parameters Over Time\") + xlab(\"Month\") + ylab(\"tonnes/day\") + \n  scale_x_date(date_breaks = \"1 month\", date_labels = \"%m\") + theme(legend.position=\"top\")\n\nb = ggplot() + \n  geom_line(data=output_data_,aes(x = Date,y = BOD_CBOD_Load_Removed, color = \"P_Removed\"),group = 1) + \n  ggtitle(\"P_Removed Over Time\") + xlab(\"Month\") + ylab(\"tonnes/day\") + \n  scale_x_date(date_breaks = \"1 month\", date_labels = \"%m\") + theme(legend.position=\"top\")\n\nc = ggplot() + \n  geom_line(data=output_data_,aes(x = Date,y = TKN_Removed, color = \"TKN_Removed\"),group = 1) + \n  ggtitle(\"TKN_Removed Over Time\") + xlab(\"Month\") + ylab(\"tonnes/day\") + \n  scale_x_date(date_breaks = \"1 month\", date_labels = \"%m\") + theme(legend.position=\"top\")\n\nd = ggplot() + \n  geom_line(data=output_data_,aes(x = Date,y = Ammonia_Removed, color = \"Ammonia_Removed\"),group = 1) + \n  ggtitle(\"Ammonia_Removed Over Time\") + xlab(\"Month\") + ylab(\"tonnes/day\") + \n  scale_x_date(date_breaks = \"1 month\", date_labels = \"%m\") + theme(legend.position=\"top\")\n\nggarrange(a, b, c, d + rremove(\"x.text\"), \n          labels = c(\"A\", \"B\", \"C\", \"D\"),\n          ncol = 2, nrow = 2)"
  },
  {
    "objectID": "environmental_parameter_analysis.html#shannon-index-visualization",
    "href": "environmental_parameter_analysis.html#shannon-index-visualization",
    "title": "Environmental Parameter Analysis",
    "section": "",
    "text": "ggplot() + \n  geom_line(data=s,aes(x = Date,y = Shannon, color = \"Shannon\"),group = 1) + \n  ggtitle(\"Shannon Index Over Time\") + xlab(\"Date\") + ylab(\"Shannon Index\") + theme(legend.position=\"top\") +\n  theme(axis.text.x = element_text(angle = 90, hjust = 1))"
  },
  {
    "objectID": "environmental_parameter_analysis.html#otu-1426-visualization",
    "href": "environmental_parameter_analysis.html#otu-1426-visualization",
    "title": "Environmental Parameter Analysis",
    "section": "",
    "text": "#put character z in front of all columns\ncolnames(otu_counts) &lt;- paste0(\"z\", colnames(otu_counts))\n#select only columns named '1' in otu_counts\notus &lt;- select(otu_counts,z1,z4,z2,z6,zDate)\n\n#plot the data\nggplot() + \n  geom_line(data=otus,aes(x = zDate, y = z1, color = \"1\"),group = 1) + \n  geom_line(data=otus,aes(x = zDate, y = z4,color = \"4\"),group = 1) +\n  geom_line(data=otus,aes(x = zDate, y = z2,color = \"2\"),group = 1) +\n  geom_line(data=otus,aes(x = zDate, y = z6 ,color = \"6\"),group = 1) +\n  ggtitle(\"OTU 1,4,2,6 Over Time\") + xlab(\"Date\") + ylab(\"Abundance\") + theme(legend.position=\"top\") +\n  theme(axis.text.x = element_text(angle = 90, hjust = 1))"
  },
  {
    "objectID": "fourier_transform.html",
    "href": "fourier_transform.html",
    "title": "Fourier Discrete Transform of Count Data",
    "section": "",
    "text": "The Fourier transform is a method commonly used to break down complex signals occuring over time into a sum of periodic components. This analysis was performed after no trends were discovered under the Seasonal and STL decomposition for Shannon Index and OTU 1, in order to see if any individual species were exhibiting periodic behavior."
  },
  {
    "objectID": "fourier_transform.html#fourier-transform-of-count-data",
    "href": "fourier_transform.html#fourier-transform-of-count-data",
    "title": "Fourier Discrete Transform of Count Data",
    "section": "Fourier Transform of Count Data",
    "text": "Fourier Transform of Count Data\n\ndef FFT(input_array):\n\n    fig, ax = plt.subplots(2, 1, figsize=(10, 10))\n\n    #Taking each OTU and fourier transforming its signal through time\n    for i in range(input_array.shape[1]):\n        ax[0].plot(input_array[:,i])\n\n        #Calculate the FFT\n        #calculate fourier transform by using np.fft.fft to calculate fft of each column (each OTU count through time)\n        #calculate the fourier sample frequencies by using np.fft.fftfreq\n        #Use np.fft.fftshift to shift the zero-frequency component to the center of the spectrum.\n\n        fft = np.fft.fftshift(np.fft.fft(input_array[:,i]))\n        fft_freq = np.fft.fftshift(np.fft.fftfreq(len(fft)))\n\n        fft = np.abs(fft[fft_freq &gt; 0])\n        fft_freq = fft_freq[fft_freq &gt; 0]\n\n        ax[1].plot(fft_freq, fft)\n\n    ax[0].set_title('Input signal')\n    ax[0].set_xlabel('Time')\n    ax[0].set_ylabel('Amplitude')\n\n    ax[1].set_title('FFT of the signal')\n    ax[1].set_xlabel('Frequency')\n    ax[1].set_ylabel('Amplitude')\n\n    plt.show()\n\nFFT(a.copy())"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Activated Sludge Model",
    "section": "",
    "text": "Here is a schematic of 7 locations where samples were collected from both weekly and bi-weekly from the MetroVancouver Annacis WWTP.\n\n\n\nwwtp_annacis"
  },
  {
    "objectID": "index.html#welcome-here-you-can-find-various-ways-to-explore-our-data",
    "href": "index.html#welcome-here-you-can-find-various-ways-to-explore-our-data",
    "title": "Activated Sludge Model",
    "section": "",
    "text": "Here is a schematic of 7 locations where samples were collected from both weekly and bi-weekly from the MetroVancouver Annacis WWTP.\n\n\n\nwwtp_annacis"
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "welcome!!!"
  },
  {
    "objectID": "indicator_species_plots.html",
    "href": "indicator_species_plots.html",
    "title": "Indicator Species",
    "section": "",
    "text": "Loading dependencies\n\nlibrary(indicspecies)\nlibrary(ggplot2)\nlibrary(tibble)\nlibrary(readxl)\nlibrary(dplyr)\nlibrary(ape)\nlibrary(tidyr)\nlibrary(tidyverse)\nlibrary(ggvenn)\nlibrary(fmsb)\nlibrary(eulerr)\nlibrary(plotly)\n\n\n\n\nabundance_table &lt;- read_excel(\"/Users/julietmalkowski/Desktop/Research/Kinetic_Model/abundance_table.xlsx\")\n\n#remove first 4 characters in every column name\ncolnames(abundance_table)&lt;- substr(colnames(abundance_table), 5, nchar(colnames(abundance_table)))\nabundance_table = as.data.frame(abundance_table)\n#split first column by character '_' into two seperate columns\nabundance_table[c('Process', 'Date')] &lt;- str_split_fixed(abundance_table$le, '_', 2)\n#drop le column\nabundance_table = abundance_table[,-1]\n#move last two columns to the front\nabundance_table &lt;- abundance_table %&gt;%\n  select(Process, everything())\nabundance_table &lt;- abundance_table %&gt;%\n  select(Date, everything())\n\n#split first column by character '_' into two separate columns\nabundance_table[c('Month', 'Year')] &lt;- str_split_fixed(abundance_table$Date, '/', 2)\nabundance_table &lt;- abundance_table %&gt;%\n  select(Month, everything())\n#turn Month column into numeric\nabundance_table$Month &lt;- as.numeric(abundance_table$Month)\n#Change AS-1 and AS-2 to AS\nabundance_table$Process &lt;- gsub(\"AS-1\", \"AS\", abundance_table$Process)\nabundance_table$Process &lt;- gsub(\"AS-2\", \"AS\", abundance_table$Process)\n\n\n### Looking at each process\n# Codes for each group:\n# AD = 1\n# AS = 2\n# Eff = 3\n# Inf = 4\n# TF = 5\n# TSS = 6\n# WAS = 7\n\n#Replace process names with codes\nabundance_table$Process &lt;- gsub(\"AD\", \"1\", abundance_table$Process)\nabundance_table$Process &lt;- gsub(\"AS\", \"2\", abundance_table$Process)\nabundance_table$Process &lt;- gsub(\"Eff\", \"3\", abundance_table$Process)\nabundance_table$Process &lt;- gsub(\"Inf\", \"4\", abundance_table$Process)\nabundance_table$Process &lt;- gsub(\"TF\", \"5\", abundance_table$Process)\nabundance_table$Process &lt;- gsub(\"TSS\", \"6\", abundance_table$Process)\nabundance_table$Process &lt;- gsub(\"W2\", \"7\", abundance_table$Process)\n\ndf1 &lt;- abundance_table %&gt;%\n  select(-Year, -Date,-Month)\n\n#Running Indicator Species Analysis\ngroupings = df1$Process\n\n#duleg = TRUE which means that site group combinations will not be considered\nindval &lt;- multipatt(df1[,c(2:ncol(df1))], groupings, \n                    control = how(nperm=999),duleg = TRUE) \n\nsig.otus &lt;- indval$sign %&gt;% mutate(otu = rownames(.)) %&gt;% filter(p.value &lt; 0.01) %&gt;% filter(stat &gt; 0.5)\n\nsig.otus &lt;- indval$sign %&gt;% mutate(index = case_when(index == 1 ~ \"AD\",\n                                                           index == 2 ~ \"AS\",\n                                                           index == 3 ~ \"Eff\",\n                                                           index == 4 ~ \"Inf\",\n                                                           index == 5 ~ \"TF\",\n                                                           index == 6 ~ \"TSS\",\n                                                           index == 7 ~ \"WAS\"))\n\nsig.otus &lt;- sig.otus %&gt;% mutate(otu = rownames(.)) %&gt;% \n  filter(p.value &lt; 0.05) %&gt;% filter(stat &gt; 0.5) %&gt;% \n  select(index, stat, p.value, otu) %&gt;% \n  mutate(OTU = paste0(\"Zotu\",otu)) \n\n\n\nShown by variables: ad, as, eff, inf, tf, tss, and was\n\ntaxa = read_excel(\"/Users/julietmalkowski/Desktop/Research/Kinetic_Model/tax.xlsx\")\n\nNew names:\n• `` -&gt; `...1`\n\nmerged_df &lt;- merge(sig.otus, taxa[, c(\"OTU\", \"genus\")], by = \"OTU\")\n\n#create a new dataframe for each unique index value\n\ngrouped_list &lt;- merged_df %&gt;%\n  group_by(index) %&gt;%\n  summarize(Values = list(genus))\n\nad &lt;- unique(grouped_list$Values[grouped_list$index == \"AD\"][[1]])\nas &lt;- unique(grouped_list$Values[grouped_list$index == \"AS\"][[1]])\neff &lt;- unique(grouped_list$Values[grouped_list$index == \"Eff\"][[1]])\ninf &lt;- unique(grouped_list$Values[grouped_list$index == \"Inf\"][[1]])\ntf &lt;- unique(grouped_list$Values[grouped_list$index == \"TF\"][[1]])\ntss &lt;- unique(grouped_list$Values[grouped_list$index == \"TSS\"][[1]])\nwas &lt;- unique(grouped_list$Values[grouped_list$index == \"WAS\"][[1]])\n\n\n\n\nprint(ad)\n\n  [1] \"Fervidobacterium\"                     \n  [2] \"Clostridia_vadinBB60_group\"           \n  [3] \"uncultured\"                           \n  [4] \"Hydrogenispora\"                       \n  [5] \"Luteolibacter\"                        \n  [6] \"D8A-2\"                                \n  [7] \"Ruminiclostridium\"                    \n  [8] \"Dethiobacter\"                         \n  [9] \"Hungateiclostridiaceae\"               \n [10] \"Limnochordaceae\"                      \n [11] \"Caldicoprobacter\"                     \n [12] \"IheB3-7\"                              \n [13] \"Cloacibacterium\"                      \n [14] \"JGI-0000079-D21\"                      \n [15] \"Edaphobaculum\"                        \n [16] \"Tepidimicrobium\"                      \n [17] \"Keratinibaculum\"                      \n [18] \"Defluviitoga\"                         \n [19] \"Monoglobus\"                           \n [20] \"Acetomicrobium\"                       \n [21] \"Herbinix\"                             \n [22] \"Syntrophaceticus\"                     \n [23] \"Aminicenantales\"                      \n [24] \"Pelotomaculum\"                        \n [25] \"Candidatus_Soleaferrea\"               \n [26] \"Coprothermobacter\"                    \n [27] \"Devosia\"                              \n [28] \"Thermoclostridium\"                    \n [29] \"Flavobacterium\"                       \n [30] \"Candidatus_Caldatribacterium\"         \n [31] \"HN-HF0106\"                            \n [32] \"Sporanaerobacter\"                     \n [33] \"Hungateiclostridium\"                  \n [34] \"MBA03\"                                \n [35] \"Syntrophomonas\"                       \n [36] \"Imtechella\"                           \n [37] \"Lutispora\"                            \n [38] \"Acinetobacter\"                        \n [39] \"DTU014\"                               \n [40] \"RF39\"                                 \n [41] \"Candidatus_Accumulibacter\"            \n [42] \"AKYH767\"                              \n [43] \"Proteiniborus\"                        \n [44] \"Lactococcus\"                          \n [45] \"Lentimicrobium\"                       \n [46] \"Beggiatoa\"                            \n [47] \"Tepidanaerobacter\"                    \n [48] \"Paludibacter\"                         \n [49] \"Dechloromonas\"                        \n [50] \"PeM15\"                                \n [51] \"Desulfitibacter\"                      \n [52] \"Thermogutta\"                          \n [53] \"Streptococcus\"                        \n [54] \"[Eubacterium]_coprostanoligenes_group\"\n [55] \"Gelria\"                               \n [56] \"[Ruminococcus]_torques_group\"         \n [57] \"Dictyoglomus\"                         \n [58] \"Deinococcus\"                          \n [59] \"Brooklawnia\"                          \n [60] \"Rhizobacter\"                          \n [61] \"Rhodobacter\"                          \n [62] \"Defluviitalea\"                        \n [63] \"Zoogloea\"                             \n [64] \"Crassaminicella\"                      \n [65] \"Aquabacterium\"                        \n [66] \"Propioniciclava\"                      \n [67] \"NK4A214_group\"                        \n [68] \"Runella\"                              \n [69] \"Ferribacterium\"                       \n [70] \"UCG-010\"                              \n [71] \"Pla1_lineage\"                         \n [72] \"Bifidobacterium\"                      \n [73] \"Haliscomenobacter\"                    \n [74] \"Leucobacter\"                          \n [75] \"Lentimicrobiaceae\"                    \n [76] \"Macellibacteroides\"                   \n [77] \"Saccharimonadales\"                    \n [78] \"BSV13\"                                \n [79] \"alphaI_cluster\"                       \n [80] \"Acidibacter\"                          \n [81] \"Izemoplasmatales\"                     \n [82] \"Symbiobacterium\"                      \n [83] \"Limnohabitans\"                        \n [84] \"Ga0077536\"                            \n [85] \"Pseudarcobacter\"                      \n [86] \"Proteiniphilum\"                       \n [87] \"0319-6G20\"                            \n [88] \"Williamwhitmania\"                     \n [89] \"Bacteroides\"                          \n [90] \"KD1-131\"                              \n [91] \"Alkanindiges\"                         \n [92] \"CL500-29_marine_group\"                \n [93] \"Methylotenera\"                        \n [94] \"UBA10353_marine_group\"                \n [95] \"Pseudomonas\"                          \n [96] \"mle1-27\"                              \n [97] \"Acidovorax\"                           \n [98] \"SBR1031\"                              \n [99] \"Sphingoaurantiacus\"                   \n[100] \"UCG-012\"                              \n[101] \"Candidatus_Moranbacteria\"             \n[102] \"37-13\"                                \n[103] \"Fluviicola\"                           \n[104] \"[Agitococcus]_lubricus_group\"         \n[105] \"Trichococcus\"                         \n[106] \"Leptotrichia\"                         \n[107] \"NS11-12_marine_group\"                 \n[108] \"Romboutsia\"                           \n[109] \"Novosphingobium\"                      \n[110] \"Diaphorobacter\"                       \n[111] \"Ottowia\"                              \n[112] \"BRH-c20a\"                             \n[113] \"[Ruminococcus]_gnavus_group\"          \n[114] \"Candidatus_Megaira\"                   \n[115] \"Moraxella\"                            \n[116] \"Comamonas\"                            \n[117] \"Citrobacter\"                          \n[118] \"Tolumonas\"                            \n[119] \"Micropruina\"                          \n[120] \"Microbacterium\"                       \n[121] \"Arsenicicoccus\"                       \n[122] \"Anaerolineaceae_UCG-001\"              \n[123] \"Candidatus_Hydrogenedens\"             \n[124] \"Raoultella\"                           \n[125] \"Mycobacterium\"                        \n[126] \"Syntrophorhabdus\"                     \n[127] \"Hydrogenedensaceae\"                   \n[128] \"Shinella\"                             \n[129] \"Thermomonas\"                          \n[130] \"Marmoricola\"                          \n[131] \"Thiobacillus\"                         \n[132] \"Amaricoccus\"                          \n[133] \"Mitochondria\"                         \n[134] \"B55-F-B-G02\"                          \n[135] \"Bdellovibrio\"                         \n[136] \"Hydrothermae\"                         \n[137] \"Syntrophothermus\"                     \n[138] \"Enterobacter\"                         \n[139] \"Lacihabitans\"                         \n[140] \"Sphingomonas\"                         \n[141] \"MSBL3\"                                \n[142] \"Aeromonas\"                            \n[143] \"Haliangium\"                           \n[144] \"Thermanaerovibrio\"                    \n[145] \"Paucibacter\"                          \n[146] \"Bacteroidetes_vadinHA17\"              \n[147] \"Limnochordia\"                         \n[148] \"Faecalibacterium\"                     \n[149] \"Mesorhizobium\"                        \n[150] \"Propionicimonas\"                      \n[151] \"Propionicicella\"                      \n[152] \"env.OPS_17\"                           \n[153] \"Clostridium_sensu_stricto_8\"          \n[154] \"Hyphomicrobium\"                       \n[155] \"Paracoccus\"                           \n[156] \"Ruminococcus\"                         \n[157] \"Gordonia\"                             \n[158] \"SM2D12\"                               \n[159] \"AKIW659\"                              \n[160] \"Conexibacter\"                         \n[161] \"Candidatus_Captivus\"                  \n[162] \"Arcobacter\"                           \n[163] \"RBG-16-49-21\"                         \n[164] \"Clostridium_sensu_stricto_1\"          \n[165] \"Ochrobactrum\"                         \n[166] \"Family_XIII_AD3011_group\"             \n[167] \"Pleomorphomonas\"                      \n[168] \"Kapabacteriales\"                      \n[169] \"Acetobacteroides\"                     \n[170] \"Fusicatenibacter\"                     \n[171] \"Thiothrix\"                            \n[172] \"Vogesella\"                            \n[173] \"Gastranaerophilales\"                  \n[174] \"Propionivibrio\"                       \n[175] \"Blautia\"                              \n[176] \"Tetrasphaera\"                         \n[177] \"Empedobacter\"                         \n[178] \"Laribacter\"                           \n[179] \"Lachnospiraceae_ND3007_group\"         \n[180] \"Ellin516\"                             \n[181] \"Pelosinus\"                            \n[182] \"SD04E11\"                              \n[183] \"Erysipelothrix\"                       \n[184] \"Curvibacter\"                          \n[185] \"Intestinibacter\"                      \n[186] \"Opitutus\"                             \n[187] \"Thauera\"                              \n[188] \"Aestuariimicrobium\"                   \n[189] \"WS1\"                                  \n[190] \"LCP-89\"                               \n[191] \"Chryseobacterium\"                     \n[192] \"Chthonomonadales\"                     \n[193] \"Kluyvera\"                             \n[194] \"Sphingobium\"                          \n[195] \"M55-D21\"                              \n[196] \"Rhodoferax\"                           \n[197] \"Turicibacter\"                         \n[198] \"Subdoligranulum\"                      \n[199] \"Geothrix\"                             \n[200] \"UCG-002\"                              \n[201] \"Christensenellaceae_R-7_group\"        \n[202] \"053A03-B-DI-P58\"                      \n[203] \"Megamonas\"                            \n[204] \"Moorella\"                             \n\n\n\n\n\n\nprint(as)\n\n [1] \"uncultured\"                   \"Sphaerotilus\"                \n [3] \"Novosphingobium\"              \"[Agitococcus]_lubricus_group\"\n [5] \"WCHB1-32\"                     \"Sericytochromatia\"           \n [7] \"Zoogloea\"                     \"Fluviicoccus\"                \n [9] \"Methylorosula\"                \"Hydrogenophaga\"              \n[11] \"Edaphobaculum\"                \"Rhodoferax\"                  \n[13] \"Candidatus_Accumulibacter\"    \"Lentimicrobiaceae\"           \n[15] \"Pajaroellobacter\"             \"DEV114\"                      \n[17] \"Flavobacterium\"               \"Dechloromonas\"               \n[19] \"Ferruginibacter\"              \"Haliangium\"                  \n[21] \"37-13\"                        \"Sphingobium\"                 \n[23] \"env.OPS_17\"                   \"Methyloversatilis\"           \n[25] \"Leptothrix\"                   \"Ferribacterium\"              \n[27] \"Bacteriovorax\"                \"Hylemonella\"                 \n[29] \"Methylotenera\"                \"Sulfuritalea\"                \n[31] \"Simplicispira\"                \"Nannocystis\"                 \n[33] \"AAP99\"                        \"Halomonas\"                   \n\n\n\n\n\n\nprint(eff)\n\n [1] \"Pseudomonas\"                                       \n [2] \"Aquaspirillum\"                                     \n [3] \"Clostridium_sensu_stricto_12\"                      \n [4] \"Acinetobacter\"                                     \n [5] \"Rhodoferax\"                                        \n [6] \"Imtechella\"                                        \n [7] \"Edaphobaculum\"                                     \n [8] \"Babeliales\"                                        \n [9] \"Giesbergeria\"                                      \n[10] \"JTB23\"                                             \n[11] \"uncultured\"                                        \n[12] \"Trichococcus\"                                      \n[13] \"Flavobacterium\"                                    \n[14] \"Lactococcus\"                                       \n[15] \"Megamonas\"                                         \n[16] \"Limnohabitans\"                                     \n[17] \"Sphingobium\"                                       \n[18] \"Chloroplast\"                                       \n[19] \"Pelosinus\"                                         \n[20] \"Polynucleobacter\"                                  \n[21] \"Allobacillus\"                                      \n[22] \"Hydrogenophaga\"                                    \n[23] \"Ottowia\"                                           \n[24] \"Candidatus_Paracaedibacter\"                        \n[25] \"env.OPS_17\"                                        \n[26] \"Pelomonas\"                                         \n[27] \"Comamonas\"                                         \n[28] \"Clostridium_sensu_stricto_1\"                       \n[29] \"Romboutsia\"                                        \n[30] \"Lachnospiraceae_ND3007_group\"                      \n[31] \"Victivallaceae\"                                    \n[32] \"Allorhizobium-Neorhizobium-Pararhizobium-Rhizobium\"\n[33] \"Prosthecobacter\"                                   \n[34] \"Pedobacter\"                                        \n[35] \"Paucibacter\"                                       \n[36] \"Aquabacterium\"                                     \n[37] \"SM2D12\"                                            \n[38] \"Unknown_Family\"                                    \n[39] \"Curvibacter\"                                       \n[40] \"Lysobacter\"                                        \n[41] \"Novosphingobium\"                                   \n[42] \"Mycobacterium\"                                     \n[43] \"GKS98_freshwater_group\"                            \n[44] \"Cloacibacterium\"                                   \n[45] \"Polaromonas\"                                       \n[46] \"Thiothrix\"                                         \n[47] \"TM7x\"                                              \n[48] \"Saccharimonadales\"                                 \n[49] \"Holdemanella\"                                      \n[50] \"Bdellovibrio\"                                      \n[51] \"Streptococcus\"                                     \n[52] \"RF39\"                                              \n[53] \"Mitochondria\"                                      \n[54] \"Coxiella\"                                          \n[55] \"Cephaloticoccus\"                                   \n[56] \"Gracilibacteria\"                                   \n[57] \"Leptothrix\"                                        \n[58] \"Rhodococcus\"                                       \n[59] \"Dechloromonas\"                                     \n[60] \"Acidovorax\"                                        \n[61] \"Propionivibrio\"                                    \n[62] \"Bact-08\"                                           \n[63] \"Lutispora\"                                         \n[64] \"Bifidobacterium\"                                   \n[65] \"Mitsuokella\"                                       \n[66] \"Candidatus_Gortzia\"                                \n[67] \"Alcaligenaceae\"                                    \n[68] \"Chryseobacterium\"                                  \n[69] \"Zoogloea\"                                          \n[70] \"Sulfuricurvum\"                                     \n[71] \"Fluviicola\"                                        \n[72] \"Sphingomonas\"                                      \n\n\n\n\n\n\nprint(inf)\n\n [1] \"Faecalibacterium\"                     \n [2] \"Aeromonas\"                            \n [3] \"Hydrogenophaga\"                       \n [4] \"Prevotella\"                           \n [5] \"Janthinobacterium\"                    \n [6] \"Negativibacillus\"                     \n [7] \"Rivicola\"                             \n [8] \"Chryseobacterium\"                     \n [9] \"Pseudomonas\"                          \n[10] \"Arcobacter\"                           \n[11] \"Hypnocyclicus\"                        \n[12] \"Butyricicoccus\"                       \n[13] \"Parabacteroides\"                      \n[14] \"Roseburia\"                            \n[15] \"Flavobacterium\"                       \n[16] \"Subdoligranulum\"                      \n[17] \"Bacteroides\"                          \n[18] \"Lactococcus\"                          \n[19] \"Coprococcus\"                          \n[20] \"Leucobacter\"                          \n[21] \"Blautia\"                              \n[22] \"Tolumonas\"                            \n[23] \"UCG-002\"                              \n[24] \"Tyzzerella\"                           \n[25] \"[Eubacterium]_siraeum_group\"          \n[26] \"[Agitococcus]_lubricus_group\"         \n[27] \"Pseudarcobacter\"                      \n[28] \"Rhodoferax\"                           \n[29] \"Lachnospiraceae_NK4A136_group\"        \n[30] \"Comamonas\"                            \n[31] \"Coprothermobacter\"                    \n[32] \"uncultured\"                           \n[33] \"Propionivibrio\"                       \n[34] \"Lachnospira\"                          \n[35] \"Zoogloea\"                             \n[36] \"Formivibrio\"                          \n[37] \"Bifidobacterium\"                      \n[38] \"Macellibacteroides\"                   \n[39] \"Cloacibacterium\"                      \n[40] \"Sulfurospirillum\"                     \n[41] \"Microbacterium\"                       \n[42] \"Akkermansia\"                          \n[43] \"Acinetobacter\"                        \n[44] \"Monoglobus\"                           \n[45] \"Dorea\"                                \n[46] \"Phascolarctobacterium\"                \n[47] \"[Eubacterium]_coprostanoligenes_group\"\n[48] \"Erysipelotrichaceae_UCG-003\"          \n[49] \"Vogesella\"                            \n[50] \"Holdemanella\"                         \n[51] \"Lelliottia\"                           \n[52] \"Malikia\"                              \n[53] \"Sutterella\"                           \n[54] \"Raoultella\"                           \n[55] \"Microvirgula\"                         \n[56] \"Desulfovibrio\"                        \n[57] \"Catenisphaera\"                        \n[58] \"UCG-003\"                              \n[59] \"[Ruminococcus]_gauvreauii_group\"      \n[60] \"Incertae_Sedis\"                       \n[61] \"Oscillibacter\"                        \n[62] \"Rhodobacter\"                          \n[63] \"Shewanella\"                           \n[64] \"Ruminococcus\"                         \n[65] \"Agathobacter\"                         \n[66] \"Paludibacter\"                         \n[67] \"Mitochondria\"                         \n[68] \"Undibacterium\"                        \n[69] \"Collinsella\"                          \n[70] \"Dechloromonas\"                        \n\n\n\n\n\n\nprint(tf)\n\n [1] \"Pseudarcobacter\"                                   \n [2] \"Pseudomonas\"                                       \n [3] \"Zoogloea\"                                          \n [4] \"FTLpost3\"                                          \n [5] \"uncultured\"                                        \n [6] \"Flavobacterium\"                                    \n [7] \"Absconditabacteriales_\"                            \n [8] \"Bergeyella\"                                        \n [9] \"Leeia\"                                             \n[10] \"Hydrogenophaga\"                                    \n[11] \"BSV13\"                                             \n[12] \"Chryseobacterium\"                                  \n[13] \"Novosphingobium\"                                   \n[14] \"Beggiatoaceae\"                                     \n[15] \"Undibacterium\"                                     \n[16] \"Dechloromonas\"                                     \n[17] \"Acinetobacter\"                                     \n[18] \"Bacteroides\"                                       \n[19] \"Prevotella\"                                        \n[20] \"Terrimonas\"                                        \n[21] \"Lachnospira\"                                       \n[22] \"Agathobacter\"                                      \n[23] \"Collinsella\"                                       \n[24] \"Allobacillus\"                                      \n[25] \"Acidovorax\"                                        \n[26] \"Simplicispira\"                                     \n[27] \"Paludibacter\"                                      \n[28] \"Soonwooa\"                                          \n[29] \"Geobacter\"                                         \n[30] \"Fusibacter\"                                        \n[31] \"T34\"                                               \n[32] \"Sulfuricurvum\"                                     \n[33] \"Lactococcus\"                                       \n[34] \"GWE2-42-42\"                                        \n[35] \"Rivicola\"                                          \n[36] \"Thiothrix\"                                         \n[37] \"Comamonas\"                                         \n[38] \"KD1-131\"                                           \n[39] \"Allorhizobium-Neorhizobium-Pararhizobium-Rhizobium\"\n[40] \"Erysipelotrichaceae_UCG-003\"                       \n[41] \"Mariprofundus\"                                     \n[42] \"Ruminococcus\"                                      \n[43] \"Janthinobacterium\"                                 \n[44] \"LCP-89\"                                            \n[45] \"Dialister\"                                         \n[46] \"Akkermansia\"                                       \n[47] \"Quatrionicoccus\"                                   \n[48] \"Rhodoferax\"                                        \n[49] \"Polaromonas\"                                       \n[50] \"Williamwhitmania\"                                  \n[51] \"Cloacibacterium\"                                   \n[52] \"Aeromonas\"                                         \n[53] \"Alistipes\"                                         \n[54] \"Coprothermobacter\"                                 \n[55] \"Fonticella\"                                        \n[56] \"Aquabacterium\"                                     \n[57] \"env.OPS_17\"                                        \n[58] \"Propionivibrio\"                                    \n[59] \"Candidatus_Accumulibacter\"                         \n[60] \"M2PB4-65_termite_group\"                            \n[61] \"Diaphorobacter\"                                    \n[62] \"[Cytophaga]_xylanolytica_group\"                    \n[63] \"WCHB1-32\"                                          \n[64] \"Erysipelothrix\"                                    \n[65] \"Lachnospiraceae_NK4A136_group\"                     \n[66] \"Alkanindiges\"                                      \n\n\n\n\n\n\nprint(tss)\n\n [1] \"Zoogloea\"                                          \n [2] \"Pelosinus\"                                         \n [3] \"Prevotella\"                                        \n [4] \"Bacteroides\"                                       \n [5] \"Moraxella\"                                         \n [6] \"uncultured\"                                        \n [7] \"PeM15\"                                             \n [8] \"Paludibacter\"                                      \n [9] \"Weeksellaceae\"                                     \n[10] \"Enterobacter\"                                      \n[11] \"XBB1006\"                                           \n[12] \"Streptococcus\"                                     \n[13] \"Comamonas\"                                         \n[14] \"Clostridium_sensu_stricto_1\"                       \n[15] \"Cloacibacterium\"                                   \n[16] \"Clostridium_sensu_stricto_12\"                      \n[17] \"Sulfurospirillum\"                                  \n[18] \"Brachymonas\"                                       \n[19] \"Klebsiella\"                                        \n[20] \"Clostridium_sensu_stricto_13\"                      \n[21] \"Sebaldella\"                                        \n[22] \"Vitreoscilla\"                                      \n[23] \"Diaphorobacter\"                                    \n[24] \"Pseudarcobacter\"                                   \n[25] \"Ottowia\"                                           \n[26] \"Sphaerotilus\"                                      \n[27] \"Raoultella\"                                        \n[28] \"Alkanindiges\"                                      \n[29] \"Eubacterium\"                                       \n[30] \"Chryseobacterium\"                                  \n[31] \"Mycobacterium\"                                     \n[32] \"Macellibacteroides\"                                \n[33] \"Empedobacter\"                                      \n[34] \"Veillonella\"                                       \n[35] \"Propionispira\"                                     \n[36] \"Laribacter\"                                        \n[37] \"Paracoccus\"                                        \n[38] \"Stenoxybacter\"                                     \n[39] \"[Agitococcus]_lubricus_group\"                      \n[40] \"Nakamurella\"                                       \n[41] \"Uruburuella\"                                       \n[42] \"Clostridium_sensu_stricto_7\"                       \n[43] \"Novosphingobium\"                                   \n[44] \"Leptotrichia\"                                      \n[45] \"Propioniciclava\"                                   \n[46] \"Pleomorphomonas\"                                   \n[47] \"T34\"                                               \n[48] \"Dysgonomonas\"                                      \n[49] \"Butyrivibrio\"                                      \n[50] \"Propionivibrio\"                                    \n[51] \"Incertae_Sedis\"                                    \n[52] \"Uliginosibacterium\"                                \n[53] \"Tolumonas\"                                         \n[54] \"Neisseria\"                                         \n[55] \"Geobacter\"                                         \n[56] \"Anaerospora\"                                       \n[57] \"Arcobacter\"                                        \n[58] \"Shuttleworthia\"                                    \n[59] \"Citrobacter\"                                       \n[60] \"Acidovorax\"                                        \n[61] \"Christensenellaceae_R-7_group\"                     \n[62] \"Rivicola\"                                          \n[63] \"Desulfovibrio\"                                     \n[64] \"Niveibacterium\"                                    \n[65] \"Micropruina\"                                       \n[66] \"Rhizorhapis\"                                       \n[67] \"Sulfurovum\"                                        \n[68] \"Chelonobacter\"                                     \n[69] \"Saccharimonadales\"                                 \n[70] \"Dechloromonas\"                                     \n[71] \"Anaeromusa-Anaeroarcus\"                            \n[72] \"Phenylobacterium\"                                  \n[73] \"Aquaspirillum\"                                     \n[74] \"Flavobacterium\"                                    \n[75] \"Candidatus_Accumulibacter\"                         \n[76] \"alphaI_cluster\"                                    \n[77] \"Acinetobacter\"                                     \n[78] \"Azorhizobium\"                                      \n[79] \"Coprothermobacter\"                                 \n[80] \"Aeromonas\"                                         \n[81] \"Luteococcus\"                                       \n[82] \"Tessaracoccus\"                                     \n[83] \"Gemmobacter\"                                       \n[84] \"Sphingomonas\"                                      \n[85] \"Kluyvera\"                                          \n[86] \"Yersinia\"                                          \n[87] \"Pseudorhodobacter\"                                 \n[88] \"Thauera\"                                           \n[89] \"Allorhizobium-Neorhizobium-Pararhizobium-Rhizobium\"\n[90] \"Pasteurella\"                                       \n[91] \"Enhydrobacter\"                                     \n[92] \"Peptostreptococcus\"                                \n[93] \"Paludibacterium\"                                   \n[94] \"KD1-131\"                                           \n[95] \"Acidaminococcus\"                                   \n[96] \"Formivibrio\"                                       \n[97] \"Lactococcus\"                                       \n\n\n\n\n\n\nprint(was)\n\n [1] \"Cephaloticoccus\"               \"Thiothrix\"                    \n [3] \"uncultured\"                    \"Rhodoferax\"                   \n [5] \"Zoogloea\"                      \"WCHB1-32\"                     \n [7] \"NS11-12_marine_group\"          \"Fluviicoccus\"                 \n [9] \"Sericytochromatia\"             \"Comamonas\"                    \n[11] \"Phreatobacter\"                 \"Rurimicrobium\"                \n[13] \"Luteolibacter\"                 \"Novosphingobium\"              \n[15] \"Hydrogenophaga\"                \"Pajaroellobacter\"             \n[17] \"Roseomonas\"                    \"Limnohabitans\"                \n[19] \"Arcicella\"                     \"Phaselicystis\"                \n[21] \"Candidatus_Electronema\"        \"Aquabacterium\"                \n[23] \"Hydrogenedensaceae\"            \"Haliangium\"                   \n[25] \"Ottowia\"                       \"env.OPS_17\"                   \n[27] \"Sphingobium\"                   \"Dechloromonas\"                \n[29] \"Aquimonas\"                     \"37-13\"                        \n[31] \"Gemmatimonas\"                  \"mle1-27\"                      \n[33] \"Thermomonas\"                   \"[Agitococcus]_lubricus_group\" \n[35] \"Christensenellaceae_R-7_group\" \"Ferribacterium\"               \n[37] \"Flavobacterium\"                \"Desulfomicrobium\"             \n[39] \"Pseudorhodobacter\"             \"Lentimicrobiaceae\"            \n[41] \"Tetrasphaera\"                  \"Pelomonas\"                    \n[43] \"Paludibacter\"                  \"Ferruginibacter\"              \n[45] \"Opitutus\"                      \"M2PB4-65_termite_group\"       \n[47] \"Prosthecobacter\"               \"Geothrix\"                     \n[49] \"Alkanindiges\"                  \"SH-PL14\"                      \n[51] \"Leptothrix\"                   \n\n\n\n\n\n\n\n\nassign_season &lt;- function(Month) {\n  if (Month %in% c(12, 01, 02)) {\n    return(\"Winter\")\n  } else if (Month %in% c(03, 04, 05)) {\n    return(\"Spring\")\n  } else if (Month %in% c(06, 07, 08)) {\n    return(\"Summer\")\n  } else if (Month %in% c(09, 10, 11)) {\n    return(\"Fall\")\n  } else {\n    return(NA)\n  }\n}\n\ndf &lt;- abundance_table %&gt;%\n  mutate(Season = sapply(Month, assign_season)) %&gt;%\n  group_by(Season, Process) %&gt;%\n  mutate(Group = cur_group_id()) %&gt;%\n  ungroup()\n\ndf &lt;- df %&gt;% select(Group,Process, Season, Month, everything())\n\n#Codes for each group:\n# AD-Fall = 1\n# AS-Fall = 2\n# Eff-Fall = 3\n# Inf-Fall = 4\n# TF-Fall = 5\n# TSS_Fall = 6\n# WAS-Fall = 7\n# AD-Spring = 8\n# AS-Spring = 9\n# Eff-Spring = 10\n# Inf-Spring = 11\n# TF-Spring = 12\n# TSS-Spring = 13\n# WAS-Spring = 14\n# AD-Summer = 15\n# AS-Summer = 16\n# Eff-Summer = 17\n# Inf-Summer = 18\n# TF-Summer = 19\n# TSS-Summer = 20\n# WAS-Summer = 21\n# AD-Winter = 22\n# AS-Winter = 23\n# Eff-Winter = 24\n# Inf-Winter = 25\n# TF-Winter = 26\n# TSS-Winter = 27\n# WAS-Winter = 28\n\n#Now we have our dataframe that contains a unique group number for each process and season\ndf &lt;- df %&gt;%\n  select(-Year, -Process, -Date, -Season, -Month)\n\n#Species groups\nAD = c(1, 8, 15, 22)\nAS = c(2, 9, 16, 23)\nEff = c(3, 10, 17, 24)\nInf_ = c(4, 11, 18, 25)\nTF = c(5, 12, 19, 26)\nTSS = c(6, 13, 20, 27)\nWAS = c(7, 14, 21, 28)\n\n#Individual Species Analysis\nad_df = df %&gt;% filter(Group %in% AD)\nas_df = df %&gt;% filter(Group %in% AS)\neff_df = df %&gt;% filter(Group %in% Eff)\ninf_df = df %&gt;% filter(Group %in% Inf_)\ntf_df = df %&gt;% filter(Group %in% TF)\ntss_df = df %&gt;% filter(Group %in% TSS)\nwas_df = df %&gt;% filter(Group %in% WAS)\n\n\n\n\n#AD\ngroupings = ad_df$Group\nindval_ad &lt;- multipatt(ad_df[,c(2:ncol(ad_df))], groupings, \n                       control = how(nperm=999),duleg = FALSE) \n\n#change index column values if index=1 then change to AD-Fall etc\nad_sig.otus &lt;- indval_ad$sign %&gt;% mutate(index = case_when(index == 1 ~ \"Fall\",\n                                                           index == 2 ~ \"Spring\",\n                                                           index == 3 ~ \"Summer\",\n                                                           index == 4 ~ \"Winter\",\n                                                           index == 5 ~ \"Fall-Spring\",\n                                                           index == 6 ~ \"Fall-Summer\",\n                                                           index == 7 ~ \"Fall-Winter\",\n                                                           index == 8 ~ \"Spring-Summer\",\n                                                           index == 9 ~ \"Spring-Winter\",\n                                                           index == 10 ~ \"Summer-Winter\",\n                                                           index == 11 ~ \"Fall-Spring-Summer\",\n                                                           index == 12 ~ \"Fall-Spring-Winter\",\n                                                           index == 13 ~ \"Fall-Summer-Winter\",\n                                                           index == 14 ~ \"Spring-Summer-Winter\",\n                                                           index == 15 ~ \"Fall-Spring-Summer-Winter\"\n))\n\nad_sig.otus &lt;- ad_sig.otus %&gt;% mutate(otu = rownames(.)) %&gt;% \n  filter(p.value &lt; 0.05) %&gt;% filter(stat &gt; 0.5) %&gt;% \n  select(index, stat, p.value, otu) %&gt;% \n  mutate(Value = paste0(\"Zotu\",otu))%&gt;%\n  rename(OTU = Value)\n\ngrouped_list_ad &lt;- ad_sig.otus %&gt;%\n  group_by(index) %&gt;%\n  summarize(Values = list(OTU))\n\n# Define the sizes of each set and their intersections\nset_sizes &lt;- c(\n  Fall = ad_sig.otus %&gt;% filter(index == \"Fall\") %&gt;% nrow(),\n  Spring = ad_sig.otus %&gt;% filter(index == \"Spring\") %&gt;% nrow(),\n  Summer = ad_sig.otus %&gt;% filter(index == \"Summer\") %&gt;% nrow(),\n  Winter = ad_sig.otus %&gt;% filter(index == \"Winter\") %&gt;% nrow(),    \n  \"Fall&Spring\" = ad_sig.otus %&gt;% filter(index == \"Fall-Spring\") %&gt;% nrow(),\n  \"Fall&Summer\" = ad_sig.otus %&gt;% filter(index == \"Fall-Summer\") %&gt;% nrow(),\n  \"Fall&Winter\" = ad_sig.otus %&gt;% filter(index == \"Fall-Winter\") %&gt;% nrow(),\n  \"Spring&Summer\" = ad_sig.otus %&gt;% filter(index == \"Spring-Summer\") %&gt;% nrow(),\n  \"Spring&Winter\" = ad_sig.otus %&gt;% filter(index == \"Spring-Winter\") %&gt;% nrow(),\n  \"Summer&Winter\" = ad_sig.otus %&gt;% filter(index == \"Summer-Winter\") %&gt;% nrow(),\n  \"Fall&Spring&Summer\" = ad_sig.otus %&gt;% filter(index == \"Fall-Spring-Summer\") %&gt;% nrow(),\n  \"Fall&Spring&Winter\" = ad_sig.otus %&gt;% filter(index == \"Fall-Spring-Winter\") %&gt;% nrow(),\n  \"Fall&Summer&Winter\" = ad_sig.otus %&gt;% filter(index == \"Fall-Summer-Winter\") %&gt;% nrow(),\n  \"Spring&Summer&Winter\" = ad_sig.otus %&gt;% filter(index == \"Spring-Summer-Winter\") %&gt;% nrow(),\n  \"Fall&Spring&Summer&Winter\" = ad_sig.otus %&gt;% filter(index == \"Fall-Spring-Summer-Winter\") %&gt;% nrow()\n)\n\n# Function to filter out small overlaps\nfilter_data &lt;- function(data, threshold = 0.01) {\n  # Calculate the total size\n  total &lt;- sum(data)\n  # Filter out entries that are below the threshold percentage of the total size\n  filtered_data &lt;- data[data / total &gt;= threshold]\n  return(filtered_data)\n}\n\n# Filter the data\nfiltered_data &lt;- filter_data(set_sizes)\n\n# Create the Euler diagram\nfit &lt;- euler(filtered_data)\n\n# Plot the Euler diagram\n# Plot the Euler diagram\nplot(fit, labels = list(font = 3, col = \"blue\", cex = 1.25),\n     quantities = list(type = \"counts\", font = 1, col = \"black\", cex = 0.75), main = \"Seasonal Comparison of Indicator Species in AD system\")\n\n\n\n\n\n\n\nmerged_df_ad &lt;- merge(ad_sig.otus, taxa[, c(\"OTU\", \"genus\")], by = \"OTU\")\n\ngrouped_list_ad &lt;- ad_sig.otus %&gt;%\n  group_by(index) %&gt;%\n  summarize(Values = list(OTU))\n\nfall_ad &lt;- unique(grouped_list_ad$Values[grouped_list_ad$index == \"Fall\"][[1]])\nspring_ad &lt;- unique(grouped_list_ad$Values[grouped_list_ad$index == \"Spring\"][[1]])\nsummer_ad &lt;- unique(grouped_list_ad$Values[grouped_list_ad$index == \"Summer\"][[1]])\nwinter_ad &lt;- unique(grouped_list_ad$Values[grouped_list_ad$index == \"Winter\"][[1]])\nfall_spring_ad &lt;- unique(grouped_list_ad$Values[grouped_list_ad$index == \"Fall-Spring\"][[1]])\nfall_summer_ad &lt;- unique(grouped_list_ad$Values[grouped_list_ad$index == \"Fall-Summer\"][[1]])\nfall_winter_ad &lt;- unique(grouped_list_ad$Values[grouped_list_ad$index == \"Fall-Winter\"][[1]])\nspring_summer_ad &lt;- unique(grouped_list_ad$Values[grouped_list_ad$index == \"Spring-Summer\"][[1]])\nspring_winter_ad &lt;- unique(grouped_list_ad$Values[grouped_list_ad$index == \"Spring-Winter\"][[1]])\nfall_spring_summer_ad &lt;- unique(grouped_list_ad$Values[grouped_list_ad$index == \"Fall-Spring-Summer\"][[1]])\nfall_spring_winter_ad &lt;- unique(grouped_list_ad$Values[grouped_list_ad$index == \"Fall-Spring-Winter\"][[1]])\nfall_summer_winter_ad &lt;- unique(grouped_list_ad$Values[grouped_list_ad$index == \"Fall-Summer-Winter\"][[1]])\n\n\n\n\n\n\n#AS\ngroupings = as_df$Group\nindval_as &lt;- multipatt(as_df[,c(2:ncol(as_df))], groupings, \n                       control = how(nperm=999),duleg = FALSE) \n\n#change index column values if index=1 then change to AD-Fall etc\nas_sig.otus &lt;- indval_as$sign %&gt;% mutate(index = case_when(index == 1 ~ \"Fall\",\n                                                           index == 2 ~ \"Spring\",\n                                                           index == 3 ~ \"Summer\",\n                                                           index == 4 ~ \"Winter\",\n                                                           index == 5 ~ \"Fall-Spring\",\n                                                           index == 6 ~ \"Fall-Summer\",\n                                                           index == 7 ~ \"Fall-Winter\",\n                                                           index == 8 ~ \"Spring-Summer\",\n                                                           index == 9 ~ \"Spring-Winter\",\n                                                           index == 10 ~ \"Summer-Winter\",\n                                                           index == 11 ~ \"Fall-Spring-Summer\",\n                                                           index == 12 ~ \"Fall-Spring-Winter\",\n                                                           index == 13 ~ \"Fall-Summer-Winter\",\n                                                           index == 14 ~ \"Spring-Summer-Winter\",\n                                                           index == 15 ~ \"Fall-Spring-Summer-Winter\"\n))\n\nas_sig.otus &lt;- as_sig.otus %&gt;% mutate(otu = rownames(.)) %&gt;% \n  filter(p.value &lt; 0.05) %&gt;% filter(stat &gt; 0.5) %&gt;% \n  select(index, stat, p.value, otu) %&gt;% \n  mutate(Value = paste0(\"Zotu\",otu))%&gt;%\n  rename(OTU = Value)\n\ngrouped_list_as &lt;- as_sig.otus %&gt;%\n  group_by(index) %&gt;%\n  summarize(Values = list(OTU))\n\n# Define the sizes of each set and their intersections\nset_sizes_as &lt;- c(\n  Fall = as_sig.otus %&gt;% filter(index == \"Fall\") %&gt;% nrow(),\n  Spring = as_sig.otus %&gt;% filter(index == \"Spring\") %&gt;% nrow(),\n  Summer = as_sig.otus %&gt;% filter(index == \"Summer\") %&gt;% nrow(),\n  Winter = as_sig.otus %&gt;% filter(index == \"Winter\") %&gt;% nrow(),    \n  \"Fall&Spring\" = as_sig.otus %&gt;% filter(index == \"Fall-Spring\") %&gt;% nrow(),\n  \"Fall&Summer\" = as_sig.otus %&gt;% filter(index == \"Fall-Summer\") %&gt;% nrow(),\n  \"Fall&Winter\" = as_sig.otus %&gt;% filter(index == \"Fall-Winter\") %&gt;% nrow(),\n  \"Spring&Summer\" = as_sig.otus %&gt;% filter(index == \"Spring-Summer\") %&gt;% nrow(),\n  \"Spring&Winter\" = as_sig.otus %&gt;% filter(index == \"Spring-Winter\") %&gt;% nrow(),\n  \"Summer&Winter\" = as_sig.otus %&gt;% filter(index == \"Summer-Winter\") %&gt;% nrow(),\n  \"Fall&Spring&Summer\" = as_sig.otus %&gt;% filter(index == \"Fall-Spring-Summer\") %&gt;% nrow(),\n  \"Fall&Spring&Winter\" = as_sig.otus %&gt;% filter(index == \"Fall-Spring-Winter\") %&gt;% nrow(),\n  \"Fall&Summer&Winter\" = as_sig.otus %&gt;% filter(index == \"Fall-Summer-Winter\") %&gt;% nrow(),\n  \"Spring&Summer&Winter\" = as_sig.otus %&gt;% filter(index == \"Spring-Summer-Winter\") %&gt;% nrow(),\n  \"Fall&Spring&Summer&Winter\" = as_sig.otus %&gt;% filter(index == \"Fall-Spring-Summer-Winter\") %&gt;% nrow()\n)\n\n# Filter the data\nfiltered_data_as &lt;- filter_data(set_sizes_as)\n\n# Create the Euler diagram\nfit_as &lt;- euler(filtered_data_as)\n\n# Plot the Euler diagram\nplot(fit_as, labels = list(font = 3, col = \"blue\", cex = 1.25),\n     quantities = list(type = \"counts\", font = 1, col = \"black\", cex = 0.75), \n     main = \"Seasonal Comparison of Indicator Species in AS system\")\n\n\n\n\n\n\n\nmerged_df_as &lt;- merge(as_sig.otus, taxa[, c(\"OTU\", \"genus\")], by = \"OTU\")\n\ngrouped_list_as &lt;- as_sig.otus %&gt;%\n  group_by(index) %&gt;%\n  summarize(Values = list(OTU))\n\nfall_as &lt;- unique(grouped_list_as$Values[grouped_list_as$index == \"Fall\"][[1]])\nspring_as &lt;- unique(grouped_list_as$Values[grouped_list_as$index == \"Spring\"][[1]])\nsummer_as &lt;- unique(grouped_list_as$Values[grouped_list_as$index == \"Summer\"][[1]])\nwinter_as &lt;- unique(grouped_list_as$Values[grouped_list_as$index == \"Winter\"][[1]])\nfall_spring_as &lt;- unique(grouped_list_as$Values[grouped_list_as$index == \"Fall-Spring\"][[1]])\nfall_summer_as &lt;- unique(grouped_list_as$Values[grouped_list_as$index == \"Fall-Summer\"][[1]])\nfall_winter_as &lt;- unique(grouped_list_as$Values[grouped_list_as$index == \"Fall-Winter\"][[1]])\nspring_summer_as &lt;- unique(grouped_list_as$Values[grouped_list_as$index == \"Spring-Summer\"][[1]])\nspring_winter_as &lt;- unique(grouped_list_as$Values[grouped_list_as$index == \"Spring-Winter\"][[1]])\nfall_spring_summer_as &lt;- unique(grouped_list_as$Values[grouped_list_as$index == \"Fall-Spring-Summer\"][[1]])\nfall_spring_winter_as &lt;- unique(grouped_list_as$Values[grouped_list_as$index == \"Fall-Spring-Winter\"][[1]])\nfall_summer_winter_as &lt;- unique(grouped_list_as$Values[grouped_list_as$index == \"Fall-Summer-Winter\"][[1]])\n\n\n\n\n\n\n#Eff\ngroupings = eff_df$Group\nindval_eff &lt;- multipatt(eff_df[,c(2:ncol(eff_df))], groupings, \n                        control = how(nperm=999),duleg = FALSE)\n\n#change index column values if index=1 then change to AD-Fall etc\neff_sig.otus &lt;- indval_eff$sign %&gt;% mutate(index = case_when(index == 1 ~ \"Fall\",\n                                                             index == 2 ~ \"Spring\",\n                                                             index == 3 ~ \"Summer\",\n                                                             index == 4 ~ \"Winter\",\n                                                             index == 5 ~ \"Fall-Spring\",\n                                                             index == 6 ~ \"Fall-Summer\",\n                                                             index == 7 ~ \"Fall-Winter\",\n                                                             index == 8 ~ \"Spring-Summer\",\n                                                             index == 9 ~ \"Spring-Winter\",\n                                                             index == 10 ~ \"Summer-Winter\",\n                                                             index == 11 ~ \"Fall-Spring-Summer\",\n                                                             index == 12 ~ \"Fall-Spring-Winter\",\n                                                             index == 13 ~ \"Fall-Summer-Winter\",\n                                                             index == 14 ~ \"Spring-Summer-Winter\",\n                                                             index == 15 ~ \"Fall-Spring-Summer-Winter\"\n))\n\neff_sig.otus &lt;- eff_sig.otus %&gt;% mutate(otu = rownames(.)) %&gt;% \n  filter(p.value &lt; 0.05) %&gt;% filter(stat &gt; 0.5) %&gt;% \n  select(index, stat, p.value, otu) %&gt;% \n  mutate(Value = paste0(\"Zotu\",otu))%&gt;%\n  rename(OTU = Value)\n\n#create a new dataframe for each unique index value\n\ngrouped_list_eff &lt;- eff_sig.otus %&gt;%\n  group_by(index) %&gt;%\n  summarize(Values = list(OTU))\n\n# Define the sizes of each set and their intersections\nset_sizes_eff &lt;- c(\n  Fall = eff_sig.otus %&gt;% filter(index == \"Fall\") %&gt;% nrow(),\n  Spring = eff_sig.otus %&gt;% filter(index == \"Spring\") %&gt;% nrow(),\n  Summer = eff_sig.otus %&gt;% filter(index == \"Summer\") %&gt;% nrow(),\n  Winter = eff_sig.otus %&gt;% filter(index == \"Winter\") %&gt;% nrow(),    \n  \"Fall&Spring\" = eff_sig.otus %&gt;% filter(index == \"Fall-Spring\") %&gt;% nrow(),\n  \"Fall&Summer\" = eff_sig.otus %&gt;% filter(index == \"Fall-Summer\") %&gt;% nrow(),\n  \"Fall&Winter\" = eff_sig.otus %&gt;% filter(index == \"Fall-Winter\") %&gt;% nrow(),\n  \"Spring&Summer\" = eff_sig.otus %&gt;% filter(index == \"Spring-Summer\") %&gt;% nrow(),\n  \"Spring&Winter\" = eff_sig.otus %&gt;% filter(index == \"Spring-Winter\") %&gt;% nrow(),\n  \"Summer&Winter\" = eff_sig.otus %&gt;% filter(index == \"Summer-Winter\") %&gt;% nrow(),\n  \"Fall&Spring&Summer\" = eff_sig.otus %&gt;% filter(index == \"Fall-Spring-Summer\") %&gt;% nrow(),\n  \"Fall&Spring&Winter\" = eff_sig.otus %&gt;% filter(index == \"Fall-Spring-Winter\") %&gt;% nrow(),\n  \"Fall&Summer&Winter\" = eff_sig.otus %&gt;% filter(index == \"Fall-Summer-Winter\") %&gt;% nrow(),\n  \"Spring&Summer&Winter\" = eff_sig.otus %&gt;% filter(index == \"Spring-Summer-Winter\") %&gt;% nrow(),\n  \"Fall&Spring&Summer&Winter\" = eff_sig.otus %&gt;% filter(index == \"Fall-Spring-Summer-Winter\") %&gt;% nrow()\n)\n\n# Filter the data\nfiltered_data_eff &lt;- filter_data(set_sizes_eff)\n\n# Create the Euler diagram\nfit_eff &lt;- euler(filtered_data_eff)\n\n# Plot the Euler diagram\nplot(fit_eff,labels = list(font = 3, col = \"blue\", cex = 1.25),\n     quantities = list(type = \"counts\", font = 1, col = \"black\", cex = 0.75), main = \"Seasonal Comparison of Indicator Species in Eff system\")\n\n\n\n\n\n\n\nmerged_df_eff &lt;- merge(ad_sig.otus, taxa[, c(\"OTU\", \"genus\")], by = \"OTU\")\n\ngrouped_list_eff &lt;- eff_sig.otus %&gt;%\n  group_by(index) %&gt;%\n  summarize(Values = list(OTU))\n\nfall_eff &lt;- unique(grouped_list_eff$Values[grouped_list_eff$index == \"Fall\"][[1]])\nspring_eff &lt;-unique(grouped_list_eff$Values[grouped_list_eff$index == \"Spring\"][[1]])\nsummer_eff &lt;- unique(grouped_list_eff$Values[grouped_list_eff$index == \"Summer\"][[1]])\nwinter_eff &lt;-unique(grouped_list_eff$Values[grouped_list_eff$index == \"Winter\"][[1]])\nfall_spring_eff &lt;- unique(grouped_list_eff$Values[grouped_list_eff$index == \"Fall-Spring\"][[1]])\nfall_summer_eff &lt;- unique(grouped_list_eff$Values[grouped_list_eff$index == \"Fall-Summer\"][[1]])\nfall_winter_eff &lt;- unique(grouped_list_eff$Values[grouped_list_eff$index == \"Fall-Winter\"][[1]])\nspring_summer_eff &lt;- unique(grouped_list_eff$Values[grouped_list_eff$index == \"Spring-Summer\"][[1]])\nspring_winter_eff &lt;- unique(grouped_list_eff$Values[grouped_list_eff$index == \"Spring-Winter\"][[1]])\nsummer_winter_eff &lt;- unique(grouped_list_eff$Values[grouped_list_eff$index == \"Summer-Winter\"][[1]])\nfall_spring_summer_eff &lt;- unique(grouped_list_eff$Values[grouped_list_eff$index == \"Fall-Spring-Summer\"][[1]])\nfall_spring_winter_eff &lt;- unique(grouped_list_eff$Values[grouped_list_eff$index == \"Fall-Spring-Winter\"][[1]])\nfall_summer_winter_eff &lt;- unique(grouped_list_eff$Values[grouped_list_eff$index == \"Fall-Summer-Winter\"][[1]])\nspring_summer_winter_eff &lt;- unique(grouped_list_eff$Values[grouped_list_eff$index == \"Spring-Summer-Winter\"][[1]])\n\n\n\n\n\n\n#Inf\ngroupings = inf_df$Group\nindval_inf &lt;- multipatt(inf_df[,c(2:ncol(inf_df))], groupings, \n                        control = how(nperm=999),duleg = FALSE)\n\n#change index column values if index=1 then change to AD-Fall etc\ninf_sig.otus &lt;- indval_inf$sign %&gt;% mutate(index = case_when(index == 1 ~ \"Fall\",\n                                                             index == 2 ~ \"Spring\",\n                                                             index == 3 ~ \"Summer\",\n                                                             index == 4 ~ \"Winter\",\n                                                             index == 5 ~ \"Fall-Spring\",\n                                                             index == 6 ~ \"Fall-Summer\",\n                                                             index == 7 ~ \"Fall-Winter\",\n                                                             index == 8 ~ \"Spring-Summer\",\n                                                             index == 9 ~ \"Spring-Winter\",\n                                                             index == 10 ~ \"Summer-Winter\",\n                                                             index == 11 ~ \"Fall-Spring-Summer\",\n                                                             index == 12 ~ \"Fall-Spring-Winter\",\n                                                             index == 13 ~ \"Fall-Summer-Winter\",\n                                                             index == 14 ~ \"Spring-Summer-Winter\",\n                                                             index == 15 ~ \"Fall-Spring-Summer-Winter\"\n))\n\ninf_sig.otus &lt;- inf_sig.otus %&gt;% mutate(otu = rownames(.)) %&gt;% \n  filter(p.value &lt; 0.05) %&gt;% filter(stat &gt; 0.5) %&gt;% \n  select(index, stat, p.value, otu) %&gt;% \n  mutate(Value = paste0(\"Zotu\",otu))%&gt;%\n  rename(OTU = Value)\n\n#create a new dataframe for each unique index value\n\ngrouped_list_inf &lt;- inf_sig.otus %&gt;%\n  group_by(index) %&gt;%\n  summarize(Values = list(OTU))\n\n# Define the sizes of each set and their intersections\nset_sizes_inf &lt;- c(\n  Fall = inf_sig.otus %&gt;% filter(index == \"Fall\") %&gt;% nrow(),\n  Spring = inf_sig.otus %&gt;% filter(index == \"Spring\") %&gt;% nrow(),\n  Summer = inf_sig.otus %&gt;% filter(index == \"Summer\") %&gt;% nrow(),\n  Winter = inf_sig.otus %&gt;% filter(index == \"Winter\") %&gt;% nrow(),    \n  \"Fall&Spring\" = inf_sig.otus %&gt;% filter(index == \"Fall-Spring\") %&gt;% nrow(),\n  \"Fall&Summer\" = inf_sig.otus %&gt;% filter(index == \"Fall-Summer\") %&gt;% nrow(),\n  \"Fall&Winter\" = inf_sig.otus %&gt;% filter(index == \"Fall-Winter\") %&gt;% nrow(),\n  \"Spring&Summer\" = inf_sig.otus %&gt;% filter(index == \"Spring-Summer\") %&gt;% nrow(),\n  \"Spring&Winter\" = inf_sig.otus %&gt;% filter(index == \"Spring-Winter\") %&gt;% nrow(),\n  \"Summer&Winter\" = inf_sig.otus %&gt;% filter(index == \"Summer-Winter\") %&gt;% nrow(),\n  \"Fall&Spring&Summer\" = inf_sig.otus %&gt;% filter(index == \"Fall-Spring-Summer\") %&gt;% nrow(),\n  \"Fall&Spring&Winter\" = inf_sig.otus %&gt;% filter(index == \"Fall-Spring-Winter\") %&gt;% nrow(),\n  \"Fall&Summer&Winter\" = inf_sig.otus %&gt;% filter(index == \"Fall-Summer-Winter\") %&gt;% nrow(),\n  \"Spring&Summer&Winter\" = inf_sig.otus %&gt;% filter(index == \"Spring-Summer-Winter\") %&gt;% nrow(),\n  \"Fall&Spring&Summer&Winter\" = inf_sig.otus %&gt;% filter(index == \"Fall-Spring-Summer-Winter\") %&gt;% nrow()\n)\n\n# Filter the data\nfiltered_data_inf &lt;- filter_data(set_sizes_inf)\n\n# Create the Euler diagram\nfit_inf &lt;- euler(filtered_data_inf)\n\n# Plot the Euler diagram\nplot(fit_inf, labels = list(font = 3, col = \"blue\", cex = 1.25),\n     quantities = list(type = \"counts\", font = 1, col = \"black\", cex = 0.75), main = \"Seasonal Comparison of Indicator Species in Inf system\")\n\n\n\n\n\n\n\nmerged_df_inf &lt;- merge(inf_sig.otus, taxa[, c(\"OTU\", \"genus\")], by = \"OTU\")\n\ngrouped_list_inf &lt;- inf_sig.otus %&gt;%\n  group_by(index) %&gt;%\n  summarize(Values = list(OTU))\n\nfall_inf &lt;- unique(grouped_list_inf$Values[grouped_list_inf$index == \"Fall\"][[1]])\nspring_inf &lt;- unique(grouped_list_inf$Values[grouped_list_inf$index == \"Spring\"][[1]])\nsummer_inf &lt;- unique(grouped_list_inf$Values[grouped_list_inf$index == \"Summer\"][[1]])\nwinter_inf &lt;- unique(grouped_list_inf$Values[grouped_list_inf$index == \"Winter\"][[1]])\nfall_spring_inf &lt;- unique(grouped_list_inf$Values[grouped_list_inf$index == \"Fall-Spring\"][[1]])\nfall_summer_inf &lt;- unique(grouped_list_inf$Values[grouped_list_inf$index == \"Fall-Summer\"][[1]])\nfall_winter_inf &lt;- unique(grouped_list_inf$Values[grouped_list_inf$index == \"Fall-Winter\"][[1]])\nspring_summer_inf &lt;- unique(grouped_list_inf$Values[grouped_list_inf$index == \"Spring-Summer\"][[1]])\nspring_winter_inf &lt;- unique(grouped_list_inf$Values[grouped_list_inf$index == \"Spring-Winter\"][[1]])\nsummer_winter_inf &lt;- unique(grouped_list_inf$Values[grouped_list_inf$index == \"Summer-Winter\"][[1]])\nfall_spring_summer_inf &lt;- unique(grouped_list_inf$Values[grouped_list_inf$index == \"Fall-Spring-Summer\"][[1]])\nfall_spring_winter_inf &lt;- unique(grouped_list_inf$Values[grouped_list_inf$index == \"Fall-Spring-Winter\"][[1]])\nfall_summer_winter_inf &lt;- unique(grouped_list_inf$Values[grouped_list_inf$index == \"Fall-Summer-Winter\"][[1]])\nspring_summer_winter_inf &lt;- unique(grouped_list_inf$Values[grouped_list_inf$index == \"Spring-Summer-Winter\"][[1]])\n\n\n\n\n\n\n#TF\ngroupings = tf_df$Group\nindval_tf &lt;- multipatt(tf_df[,c(2:ncol(tf_df))], groupings, \n                       control = how(nperm=999),duleg = FALSE)\n\n#change index column values if index=1 then change to AD-Fall etc\ntf_sig.otus &lt;- indval_tf$sign %&gt;% mutate(index = case_when(index == 1 ~ \"Fall\",\n                                                           index == 2 ~ \"Spring\",\n                                                           index == 3 ~ \"Summer\",\n                                                           index == 4 ~ \"Winter\",\n                                                           index == 5 ~ \"Fall-Spring\",\n                                                           index == 6 ~ \"Fall-Summer\",\n                                                           index == 7 ~ \"Fall-Winter\",\n                                                           index == 8 ~ \"Spring-Summer\",\n                                                           index == 9 ~ \"Spring-Winter\",\n                                                           index == 10 ~ \"Summer-Winter\",\n                                                           index == 11 ~ \"Fall-Spring-Summer\",\n                                                           index == 12 ~ \"Fall-Spring-Winter\",\n                                                           index == 13 ~ \"Fall-Summer-Winter\",\n                                                           index == 14 ~ \"Spring-Summer-Winter\",\n                                                           index == 15 ~ \"Fall-Spring-Summer-Winter\"\n))\n\ntf_sig.otus &lt;- tf_sig.otus %&gt;% mutate(otu = rownames(.)) %&gt;% \n  filter(p.value &lt; 0.05) %&gt;% filter(stat &gt; 0.5) %&gt;% \n  select(index, stat, p.value, otu) %&gt;% \n  mutate(Value = paste0(\"Zotu\",otu))%&gt;%\n  rename(OTU = Value)\n\ngrouped_list_tf &lt;- tf_sig.otus %&gt;%\n  group_by(index) %&gt;%\n  summarize(Values = list(OTU))\n\n# Define the sizes of each set and their intersections\nset_sizes_tf &lt;- c(\n  Fall = tf_sig.otus %&gt;% filter(index == \"Fall\") %&gt;% nrow(),\n  Spring = tf_sig.otus %&gt;% filter(index == \"Spring\") %&gt;% nrow(),\n  Summer = tf_sig.otus %&gt;% filter(index == \"Summer\") %&gt;% nrow(),\n  Winter = tf_sig.otus %&gt;% filter(index == \"Winter\") %&gt;% nrow(),    \n  \"Fall&Spring\" = tf_sig.otus %&gt;% filter(index == \"Fall-Spring\") %&gt;% nrow(),\n  \"Fall&Summer\" = tf_sig.otus %&gt;% filter(index == \"Fall-Summer\") %&gt;% nrow(),\n  \"Fall&Winter\" = tf_sig.otus %&gt;% filter(index == \"Fall-Winter\") %&gt;% nrow(),\n  \"Spring&Summer\" = tf_sig.otus %&gt;% filter(index == \"Spring-Summer\") %&gt;% nrow(),\n  \"Spring&Winter\" = tf_sig.otus %&gt;% filter(index == \"Spring-Winter\") %&gt;% nrow(),\n  \"Summer&Winter\" = tf_sig.otus %&gt;% filter(index == \"Summer-Winter\") %&gt;% nrow(),\n  \"Fall&Spring&Summer\" = tf_sig.otus %&gt;% filter(index == \"Fall-Spring-Summer\") %&gt;% nrow(),\n  \"Fall&Spring&Winter\" = tf_sig.otus %&gt;% filter(index == \"Fall-Spring-Winter\") %&gt;% nrow(),\n  \"Fall&Summer&Winter\" = tf_sig.otus %&gt;% filter(index == \"Fall-Summer-Winter\") %&gt;% nrow(),\n  \"Spring&Summer&Winter\" = tf_sig.otus %&gt;% filter(index == \"Spring-Summer-Winter\") %&gt;% nrow(),\n  \"Fall&Spring&Summer&Winter\" = tf_sig.otus %&gt;% filter(index == \"Fall-Spring-Summer-Winter\") %&gt;% nrow()\n)\n\n# Filter the data\nfiltered_data_tf &lt;- filter_data(set_sizes_tf)\n\n# Create the Euler diagram\nfit_tf &lt;- euler(filtered_data_tf)\n\n# Plot the Euler diagram\nplot(fit_tf, labels = list(font = 3, col = \"blue\", cex = 1.25),\n     quantities = list(type = \"counts\", font = 1, col = \"black\", cex = 0.75), main = \"Seasonal Comparison of Indicator Species in TF system\")\n\n\n\n\n\n\n\nmerged_df_tf &lt;- merge(tf_sig.otus, taxa[, c(\"OTU\", \"genus\")], by = \"OTU\")\n\ngrouped_list_tf &lt;- tf_sig.otus %&gt;%\n  group_by(index) %&gt;%\n  summarize(Values = list(OTU))\n\nfall_tf &lt;- unique(grouped_list_tf$Values[grouped_list_tf$index == \"Fall\"][[1]])\nspring_tf &lt;- unique(grouped_list_tf$Values[grouped_list_tf$index == \"Spring\"][[1]])\nsummer_tf &lt;- unique(grouped_list_tf$Values[grouped_list_tf$index == \"Summer\"][[1]])\nwinter_tf &lt;- unique(grouped_list_tf$Values[grouped_list_tf$index == \"Winter\"][[1]])\nfall_spring_tf &lt;- unique(grouped_list_tf$Values[grouped_list_tf$index == \"Fall-Spring\"][[1]])\nfall_summer_tf &lt;- unique(grouped_list_tf$Values[grouped_list_tf$index == \"Fall-Summer\"][[1]])\nfall_winter_tf &lt;- unique(grouped_list_tf$Values[grouped_list_tf$index == \"Fall-Winter\"][[1]])\nspring_summer_tf &lt;- unique(grouped_list_tf$Values[grouped_list_tf$index == \"Spring-Summer\"][[1]])\nspring_winter_tf &lt;- unique(grouped_list_tf$Values[grouped_list_tf$index == \"Spring-Winter\"][[1]])\nsummer_winter_tf &lt;- unique(grouped_list_tf$Values[grouped_list_tf$index == \"Summer-Winter\"][[1]])\nfall_spring_summer_tf &lt;- unique(grouped_list_tf$Values[grouped_list_tf$index == \"Fall-Spring-Summer\"][[1]])\nfall_spring_winter_tf &lt;- unique(grouped_list_tf$Values[grouped_list_tf$index == \"Fall-Spring-Winter\"][[1]])\nfall_summer_winter_tf &lt;- unique(grouped_list_tf$Values[grouped_list_tf$index == \"Fall-Summer-Winter\"][[1]])\nspring_summer_winter_tf &lt;- unique(grouped_list_tf$Values[grouped_list_tf$index == \"Spring-Summer-Winter\"][[1]])\n\n\n\n\n\n\n#TSS\ngroupings = tss_df$Group\nindval_tss &lt;- multipatt(tss_df[,c(2:ncol(tss_df))], groupings, \n                        control = how(nperm=999),duleg = FALSE)\n\n#change index column values if index=1 then change to AD-Fall etc\ntss_sig.otus &lt;- indval_tss$sign %&gt;% mutate(index = case_when(index == 1 ~ \"Fall\",\n                                                             index == 2 ~ \"Spring\",\n                                                             index == 3 ~ \"Summer\",\n                                                             index == 4 ~ \"Winter\",\n                                                             index == 5 ~ \"Fall-Spring\",\n                                                             index == 6 ~ \"Fall-Summer\",\n                                                             index == 7 ~ \"Fall-Winter\",\n                                                             index == 8 ~ \"Spring-Summer\",\n                                                             index == 9 ~ \"Spring-Winter\",\n                                                             index == 10 ~ \"Summer-Winter\",\n                                                             index == 11 ~ \"Fall-Spring-Summer\",\n                                                             index == 12 ~ \"Fall-Spring-Winter\",\n                                                             index == 13 ~ \"Fall-Summer-Winter\",\n                                                             index == 14 ~ \"Spring-Summer-Winter\",\n                                                             index == 15 ~ \"Fall-Spring-Summer-Winter\"\n))\n\ntss_sig.otus &lt;- tss_sig.otus %&gt;% mutate(otu = rownames(.)) %&gt;% \n  filter(p.value &lt; 0.05) %&gt;% filter(stat &gt; 0.5) %&gt;% \n  select(index, stat, p.value, otu) %&gt;% \n  mutate(Value = paste0(\"Zotu\",otu))%&gt;%\n  rename(OTU = Value)\n\ngrouped_list_tss &lt;- tss_sig.otus %&gt;%\n  group_by(index) %&gt;%\n  summarize(Values = list(OTU))\n\n# Define the sizes of each set and their intersections\nset_sizes_tss &lt;- c(\n  Fall = tss_sig.otus %&gt;% filter(index == \"Fall\") %&gt;% nrow(),\n  Spring = tss_sig.otus %&gt;% filter(index == \"Spring\") %&gt;% nrow(),\n  Summer = tss_sig.otus %&gt;% filter(index == \"Summer\") %&gt;% nrow(),\n  Winter = tss_sig.otus %&gt;% filter(index == \"Winter\") %&gt;% nrow(),    \n  \"Fall&Spring\" = tss_sig.otus %&gt;% filter(index == \"Fall-Spring\") %&gt;% nrow(),\n  \"Fall&Summer\" = tss_sig.otus %&gt;% filter(index == \"Fall-Summer\") %&gt;% nrow(),\n  \"Fall&Winter\" = tss_sig.otus %&gt;% filter(index == \"Fall-Winter\") %&gt;% nrow(),\n  \"Spring&Summer\" = tss_sig.otus %&gt;% filter(index == \"Spring-Summer\") %&gt;% nrow(),\n  \"Spring&Winter\" = tss_sig.otus %&gt;% filter(index == \"Spring-Winter\") %&gt;% nrow(),\n  \"Summer&Winter\" = tss_sig.otus %&gt;% filter(index == \"Summer-Winter\") %&gt;% nrow(),\n  \"Fall&Spring&Summer\" = tss_sig.otus %&gt;% filter(index == \"Fall-Spring-Summer\") %&gt;% nrow(),\n  \"Fall&Spring&Winter\" = tss_sig.otus %&gt;% filter(index == \"Fall-Spring-Winter\") %&gt;% nrow(),\n  \"Fall&Summer&Winter\" = tss_sig.otus %&gt;% filter(index == \"Fall-Summer-Winter\") %&gt;% nrow(),\n  \"Spring&Summer&Winter\" = tss_sig.otus %&gt;% filter(index == \"Spring-Summer-Winter\") %&gt;% nrow(),\n  \"Fall&Spring&Summer&Winter\" = tss_sig.otus %&gt;% filter(index == \"Fall-Spring-Summer-Winter\") %&gt;% nrow()\n)\n\n# Filter the data\nfiltered_data_tss &lt;- filter_data(set_sizes_tss)\n\n# Create the Euler diagram\nfit_tss &lt;- euler(filtered_data_tss)\n\n# Plot the Euler diagram\nplot(fit_tss,labels = list(font = 3, col = \"blue\", cex = 1.25),\n     quantities = list(type = \"counts\", font = 1, col = \"black\", cex = 0.75), main = \"Seasonal Comparison of Indicator Species in TSS system\")\n\n\n\n\n\n\n\nmerged_df_tss &lt;- merge(tss_sig.otus, taxa[, c(\"OTU\", \"genus\")], by = \"OTU\")\n\ngrouped_list_tss &lt;- tss_sig.otus %&gt;%\n  group_by(index) %&gt;%\n  summarize(Values = list(OTU))\n\nfall_tss &lt;- unique(grouped_list_tss$Values[grouped_list_tss$index == \"Fall\"][[1]])\nspring_tss &lt;- unique(grouped_list_tss$Values[grouped_list_tss$index == \"Spring\"][[1]])\nsummer_tss &lt;- unique(grouped_list_tss$Values[grouped_list_tss$index == \"Summer\"][[1]])\nwinter_tss &lt;- unique(grouped_list_tss$Values[grouped_list_tss$index == \"Winter\"][[1]])\nfall_spring_tss &lt;- unique(grouped_list_tss$Values[grouped_list_tss$index == \"Fall-Spring\"][[1]])\nfall_summer_tss &lt;- unique(grouped_list_tss$Values[grouped_list_tss$index == \"Fall-Summer\"][[1]])\nfall_winter_tss &lt;- unique(grouped_list_tss$Values[grouped_list_tss$index == \"Fall-Winter\"][[1]])\nspring_summer_tss &lt;- unique(grouped_list_tss$Values[grouped_list_tss$index == \"Spring-Summer\"][[1]])\nspring_winter_tss &lt;- unique(grouped_list_tss$Values[grouped_list_tss$index == \"Spring-Winter\"][[1]])\nsummer_winter_tss &lt;- unique(grouped_list_tss$Values[grouped_list_tss$index == \"Summer-Winter\"][[1]])\nfall_spring_summer_tss &lt;- unique(grouped_list_tss$Values[grouped_list_tss$index == \"Fall-Spring-Summer\"][[1]])\nfall_spring_winter_tss &lt;- unique(grouped_list_tss$Values[grouped_list_tss$index == \"Fall-Spring-Winter\"][[1]])\nfall_summer_winter_tss &lt;- unique(grouped_list_tss$Values[grouped_list_tss$index == \"Fall-Summer-Winter\"][[1]])\nspring_summer_winter_tss &lt;- unique(grouped_list_tss$Values[grouped_list_tss$index == \"Spring-Summer-Winter\"][[1]])\n\n\n\n\n\n\n#WAS\ngroupings = was_df$Group\nindval_was &lt;- multipatt(was_df[,c(2:ncol(was_df))], groupings, \n                        control = how(nperm=999),duleg = FALSE)\n\n#change index column values if index=1 then change to AD-Fall etc\nwas_sig.otus &lt;- indval_was$sign %&gt;% mutate(index = case_when(index == 1 ~ \"Fall\",\n                                                             index == 2 ~ \"Spring\",\n                                                             index == 3 ~ \"Summer\",\n                                                             index == 4 ~ \"Winter\",\n                                                             index == 5 ~ \"Fall-Spring\",\n                                                             index == 6 ~ \"Fall-Summer\",\n                                                             index == 7 ~ \"Fall-Winter\",\n                                                             index == 8 ~ \"Spring-Summer\",\n                                                             index == 9 ~ \"Spring-Winter\",\n                                                             index == 10 ~ \"Summer-Winter\",\n                                                             index == 11 ~ \"Fall-Spring-Summer\",\n                                                             index == 12 ~ \"Fall-Spring-Winter\",\n                                                             index == 13 ~ \"Fall-Summer-Winter\",\n                                                             index == 14 ~ \"Spring-Summer-Winter\",\n                                                             index == 15 ~ \"Fall-Spring-Summer-Winter\"\n))\n\nwas_sig.otus &lt;- was_sig.otus %&gt;% mutate(otu = rownames(.)) %&gt;% \n  filter(p.value &lt; 0.05) %&gt;% filter(stat &gt; 0.5) %&gt;% \n  select(index, stat, p.value, otu) %&gt;% \n  mutate(Value = paste0(\"Zotu\",otu))%&gt;%\n  rename(OTU = Value)\n\n#create a new dataframe for each unique index value\ngrouped_list_was &lt;- was_sig.otus %&gt;%\n  group_by(index) %&gt;%\n  summarize(Values = list(OTU))\n\n# Define the sizes of each set and their intersections\nset_sizes_was &lt;- c(\n  Fall = was_sig.otus %&gt;% filter(index == \"Fall\") %&gt;% nrow(),\n  Spring = was_sig.otus %&gt;% filter(index == \"Spring\") %&gt;% nrow(),\n  Summer = was_sig.otus %&gt;% filter(index == \"Summer\") %&gt;% nrow(),\n  Winter = was_sig.otus %&gt;% filter(index == \"Winter\") %&gt;% nrow(),    \n  \"Fall&Spring\" = was_sig.otus %&gt;% filter(index == \"Fall-Spring\") %&gt;% nrow(),\n  \"Fall&Summer\" = was_sig.otus %&gt;% filter(index == \"Fall-Summer\") %&gt;% nrow(),\n  \"Fall&Winter\" = was_sig.otus %&gt;% filter(index == \"Fall-Winter\") %&gt;% nrow(),\n  \"Spring&Summer\" = was_sig.otus %&gt;% filter(index == \"Spring-Summer\") %&gt;% nrow(),\n  \"Spring&Winter\" = was_sig.otus %&gt;% filter(index == \"Spring-Winter\") %&gt;% nrow(),\n  \"Summer&Winter\" = was_sig.otus %&gt;% filter(index == \"Summer-Winter\") %&gt;% nrow(),\n  \"Fall&Spring&Summer\" = was_sig.otus %&gt;% filter(index == \"Fall-Spring-Summer\") %&gt;% nrow(),\n  \"Fall&Spring&Winter\" = was_sig.otus %&gt;% filter(index == \"Fall-Spring-Winter\") %&gt;% nrow(),\n  \"Fall&Summer&Winter\" = was_sig.otus %&gt;% filter(index == \"Fall-Summer-Winter\") %&gt;% nrow(),\n  \"Spring&Summer&Winter\" = was_sig.otus %&gt;% filter(index == \"Spring-Summer-Winter\") %&gt;% nrow(),\n  \"Fall&Spring&Summer&Winter\" = was_sig.otus %&gt;% filter(index == \"Fall-Spring-Summer-Winter\") %&gt;% nrow()\n)\n\n# Filter the data\nfiltered_data_was &lt;- filter_data(set_sizes_was)\n\n# Create the Euler diagram\nfit_was &lt;- euler(filtered_data_was)\n\n# Plot the Euler diagram\nplot(fit_was, labels = list(font = 3, col = \"blue\", cex = 1.25),\n     quantities = list(type = \"counts\", font = 1, col = \"black\", cex = 0.75), main = \"Seasonal Comparison of Indicator Species in WAS system\")\n\n\n\n\n\n\n\nmerged_df_was &lt;- merge(was_sig.otus, taxa[, c(\"OTU\", \"genus\")], by = \"OTU\")\n\ngrouped_list_was &lt;- was_sig.otus %&gt;%\n  group_by(index) %&gt;%\n  summarize(Values = list(OTU))\n\nfall_was &lt;- unique(grouped_list_was$Values[grouped_list_was$index == \"Fall\"][[1]])\nspring_was &lt;- unique(grouped_list_was$Values[grouped_list_was$index == \"Spring\"][[1]])\nsummer_was &lt;- unique(grouped_list_was$Values[grouped_list_was$index == \"Summer\"][[1]])\nwinter_was &lt;- unique(grouped_list_was$Values[grouped_list_was$index == \"Winter\"][[1]])\nfall_spring_was &lt;- unique(grouped_list_was$Values[grouped_list_was$index == \"Fall-Spring\"][[1]])\nfall_summer_was &lt;- unique(grouped_list_was$Values[grouped_list_was$index == \"Fall-Summer\"][[1]])\nfall_winter_was &lt;- unique(grouped_list_was$Values[grouped_list_was$index == \"Fall-Winter\"][[1]])\nspring_summer_was &lt;- unique(grouped_list_was$Values[grouped_list_was$index == \"Spring-Summer\"][[1]])\nspring_winter_was &lt;- unique(grouped_list_was$Values[grouped_list_was$index == \"Spring-Winter\"][[1]])\nsummer_winter_was &lt;- unique(grouped_list_was$Values[grouped_list_was$index == \"Summer-Winter\"][[1]])\nfall_spring_summer_was &lt;- unique(grouped_list_was$Values[grouped_list_was$index == \"Fall-Spring-Summer\"][[1]])\nfall_spring_winter_was &lt;- unique(grouped_list_was$Values[grouped_list_was$index == \"Fall-Spring-Winter\"][[1]])\nfall_summer_winter_was &lt;- unique(grouped_list_was$Values[grouped_list_was$index == \"Fall-Summer-Winter\"][[1]])\nspring_summer_winter_was &lt;- unique(grouped_list_was$Values[grouped_list_was$index == \"Spring-Summer-Winter\"][[1]])"
  },
  {
    "objectID": "indicator_species_plots.html#analysis-on-the-7-wwtp-processes",
    "href": "indicator_species_plots.html#analysis-on-the-7-wwtp-processes",
    "title": "Indicator Species",
    "section": "",
    "text": "abundance_table &lt;- read_excel(\"/Users/julietmalkowski/Desktop/Research/Kinetic_Model/abundance_table.xlsx\")\n\n#remove first 4 characters in every column name\ncolnames(abundance_table)&lt;- substr(colnames(abundance_table), 5, nchar(colnames(abundance_table)))\nabundance_table = as.data.frame(abundance_table)\n#split first column by character '_' into two seperate columns\nabundance_table[c('Process', 'Date')] &lt;- str_split_fixed(abundance_table$le, '_', 2)\n#drop le column\nabundance_table = abundance_table[,-1]\n#move last two columns to the front\nabundance_table &lt;- abundance_table %&gt;%\n  select(Process, everything())\nabundance_table &lt;- abundance_table %&gt;%\n  select(Date, everything())\n\n#split first column by character '_' into two separate columns\nabundance_table[c('Month', 'Year')] &lt;- str_split_fixed(abundance_table$Date, '/', 2)\nabundance_table &lt;- abundance_table %&gt;%\n  select(Month, everything())\n#turn Month column into numeric\nabundance_table$Month &lt;- as.numeric(abundance_table$Month)\n#Change AS-1 and AS-2 to AS\nabundance_table$Process &lt;- gsub(\"AS-1\", \"AS\", abundance_table$Process)\nabundance_table$Process &lt;- gsub(\"AS-2\", \"AS\", abundance_table$Process)\n\n\n### Looking at each process\n# Codes for each group:\n# AD = 1\n# AS = 2\n# Eff = 3\n# Inf = 4\n# TF = 5\n# TSS = 6\n# WAS = 7\n\n#Replace process names with codes\nabundance_table$Process &lt;- gsub(\"AD\", \"1\", abundance_table$Process)\nabundance_table$Process &lt;- gsub(\"AS\", \"2\", abundance_table$Process)\nabundance_table$Process &lt;- gsub(\"Eff\", \"3\", abundance_table$Process)\nabundance_table$Process &lt;- gsub(\"Inf\", \"4\", abundance_table$Process)\nabundance_table$Process &lt;- gsub(\"TF\", \"5\", abundance_table$Process)\nabundance_table$Process &lt;- gsub(\"TSS\", \"6\", abundance_table$Process)\nabundance_table$Process &lt;- gsub(\"W2\", \"7\", abundance_table$Process)\n\ndf1 &lt;- abundance_table %&gt;%\n  select(-Year, -Date,-Month)\n\n#Running Indicator Species Analysis\ngroupings = df1$Process\n\n#duleg = TRUE which means that site group combinations will not be considered\nindval &lt;- multipatt(df1[,c(2:ncol(df1))], groupings, \n                    control = how(nperm=999),duleg = TRUE) \n\nsig.otus &lt;- indval$sign %&gt;% mutate(otu = rownames(.)) %&gt;% filter(p.value &lt; 0.01) %&gt;% filter(stat &gt; 0.5)\n\nsig.otus &lt;- indval$sign %&gt;% mutate(index = case_when(index == 1 ~ \"AD\",\n                                                           index == 2 ~ \"AS\",\n                                                           index == 3 ~ \"Eff\",\n                                                           index == 4 ~ \"Inf\",\n                                                           index == 5 ~ \"TF\",\n                                                           index == 6 ~ \"TSS\",\n                                                           index == 7 ~ \"WAS\"))\n\nsig.otus &lt;- sig.otus %&gt;% mutate(otu = rownames(.)) %&gt;% \n  filter(p.value &lt; 0.05) %&gt;% filter(stat &gt; 0.5) %&gt;% \n  select(index, stat, p.value, otu) %&gt;% \n  mutate(OTU = paste0(\"Zotu\",otu)) \n\n\n\nShown by variables: ad, as, eff, inf, tf, tss, and was\n\ntaxa = read_excel(\"/Users/julietmalkowski/Desktop/Research/Kinetic_Model/tax.xlsx\")\n\nNew names:\n• `` -&gt; `...1`\n\nmerged_df &lt;- merge(sig.otus, taxa[, c(\"OTU\", \"genus\")], by = \"OTU\")\n\n#create a new dataframe for each unique index value\n\ngrouped_list &lt;- merged_df %&gt;%\n  group_by(index) %&gt;%\n  summarize(Values = list(genus))\n\nad &lt;- unique(grouped_list$Values[grouped_list$index == \"AD\"][[1]])\nas &lt;- unique(grouped_list$Values[grouped_list$index == \"AS\"][[1]])\neff &lt;- unique(grouped_list$Values[grouped_list$index == \"Eff\"][[1]])\ninf &lt;- unique(grouped_list$Values[grouped_list$index == \"Inf\"][[1]])\ntf &lt;- unique(grouped_list$Values[grouped_list$index == \"TF\"][[1]])\ntss &lt;- unique(grouped_list$Values[grouped_list$index == \"TSS\"][[1]])\nwas &lt;- unique(grouped_list$Values[grouped_list$index == \"WAS\"][[1]])\n\n\n\n\nprint(ad)\n\n  [1] \"Fervidobacterium\"                     \n  [2] \"Clostridia_vadinBB60_group\"           \n  [3] \"uncultured\"                           \n  [4] \"Hydrogenispora\"                       \n  [5] \"Luteolibacter\"                        \n  [6] \"D8A-2\"                                \n  [7] \"Ruminiclostridium\"                    \n  [8] \"Dethiobacter\"                         \n  [9] \"Hungateiclostridiaceae\"               \n [10] \"Limnochordaceae\"                      \n [11] \"Caldicoprobacter\"                     \n [12] \"IheB3-7\"                              \n [13] \"Cloacibacterium\"                      \n [14] \"JGI-0000079-D21\"                      \n [15] \"Edaphobaculum\"                        \n [16] \"Tepidimicrobium\"                      \n [17] \"Keratinibaculum\"                      \n [18] \"Defluviitoga\"                         \n [19] \"Monoglobus\"                           \n [20] \"Acetomicrobium\"                       \n [21] \"Herbinix\"                             \n [22] \"Syntrophaceticus\"                     \n [23] \"Aminicenantales\"                      \n [24] \"Pelotomaculum\"                        \n [25] \"Candidatus_Soleaferrea\"               \n [26] \"Coprothermobacter\"                    \n [27] \"Devosia\"                              \n [28] \"Thermoclostridium\"                    \n [29] \"Flavobacterium\"                       \n [30] \"Candidatus_Caldatribacterium\"         \n [31] \"HN-HF0106\"                            \n [32] \"Sporanaerobacter\"                     \n [33] \"Hungateiclostridium\"                  \n [34] \"MBA03\"                                \n [35] \"Syntrophomonas\"                       \n [36] \"Imtechella\"                           \n [37] \"Lutispora\"                            \n [38] \"Acinetobacter\"                        \n [39] \"DTU014\"                               \n [40] \"RF39\"                                 \n [41] \"Candidatus_Accumulibacter\"            \n [42] \"AKYH767\"                              \n [43] \"Proteiniborus\"                        \n [44] \"Lactococcus\"                          \n [45] \"Lentimicrobium\"                       \n [46] \"Beggiatoa\"                            \n [47] \"Tepidanaerobacter\"                    \n [48] \"Paludibacter\"                         \n [49] \"Dechloromonas\"                        \n [50] \"PeM15\"                                \n [51] \"Desulfitibacter\"                      \n [52] \"Thermogutta\"                          \n [53] \"Streptococcus\"                        \n [54] \"[Eubacterium]_coprostanoligenes_group\"\n [55] \"Gelria\"                               \n [56] \"[Ruminococcus]_torques_group\"         \n [57] \"Dictyoglomus\"                         \n [58] \"Deinococcus\"                          \n [59] \"Brooklawnia\"                          \n [60] \"Rhizobacter\"                          \n [61] \"Rhodobacter\"                          \n [62] \"Defluviitalea\"                        \n [63] \"Zoogloea\"                             \n [64] \"Crassaminicella\"                      \n [65] \"Aquabacterium\"                        \n [66] \"Propioniciclava\"                      \n [67] \"NK4A214_group\"                        \n [68] \"Runella\"                              \n [69] \"Ferribacterium\"                       \n [70] \"UCG-010\"                              \n [71] \"Pla1_lineage\"                         \n [72] \"Bifidobacterium\"                      \n [73] \"Haliscomenobacter\"                    \n [74] \"Leucobacter\"                          \n [75] \"Lentimicrobiaceae\"                    \n [76] \"Macellibacteroides\"                   \n [77] \"Saccharimonadales\"                    \n [78] \"BSV13\"                                \n [79] \"alphaI_cluster\"                       \n [80] \"Acidibacter\"                          \n [81] \"Izemoplasmatales\"                     \n [82] \"Symbiobacterium\"                      \n [83] \"Limnohabitans\"                        \n [84] \"Ga0077536\"                            \n [85] \"Pseudarcobacter\"                      \n [86] \"Proteiniphilum\"                       \n [87] \"0319-6G20\"                            \n [88] \"Williamwhitmania\"                     \n [89] \"Bacteroides\"                          \n [90] \"KD1-131\"                              \n [91] \"Alkanindiges\"                         \n [92] \"CL500-29_marine_group\"                \n [93] \"Methylotenera\"                        \n [94] \"UBA10353_marine_group\"                \n [95] \"Pseudomonas\"                          \n [96] \"mle1-27\"                              \n [97] \"Acidovorax\"                           \n [98] \"SBR1031\"                              \n [99] \"Sphingoaurantiacus\"                   \n[100] \"UCG-012\"                              \n[101] \"Candidatus_Moranbacteria\"             \n[102] \"37-13\"                                \n[103] \"Fluviicola\"                           \n[104] \"[Agitococcus]_lubricus_group\"         \n[105] \"Trichococcus\"                         \n[106] \"Leptotrichia\"                         \n[107] \"NS11-12_marine_group\"                 \n[108] \"Romboutsia\"                           \n[109] \"Novosphingobium\"                      \n[110] \"Diaphorobacter\"                       \n[111] \"Ottowia\"                              \n[112] \"BRH-c20a\"                             \n[113] \"[Ruminococcus]_gnavus_group\"          \n[114] \"Candidatus_Megaira\"                   \n[115] \"Moraxella\"                            \n[116] \"Comamonas\"                            \n[117] \"Citrobacter\"                          \n[118] \"Tolumonas\"                            \n[119] \"Micropruina\"                          \n[120] \"Microbacterium\"                       \n[121] \"Arsenicicoccus\"                       \n[122] \"Anaerolineaceae_UCG-001\"              \n[123] \"Candidatus_Hydrogenedens\"             \n[124] \"Raoultella\"                           \n[125] \"Mycobacterium\"                        \n[126] \"Syntrophorhabdus\"                     \n[127] \"Hydrogenedensaceae\"                   \n[128] \"Shinella\"                             \n[129] \"Thermomonas\"                          \n[130] \"Marmoricola\"                          \n[131] \"Thiobacillus\"                         \n[132] \"Amaricoccus\"                          \n[133] \"Mitochondria\"                         \n[134] \"B55-F-B-G02\"                          \n[135] \"Bdellovibrio\"                         \n[136] \"Hydrothermae\"                         \n[137] \"Syntrophothermus\"                     \n[138] \"Enterobacter\"                         \n[139] \"Lacihabitans\"                         \n[140] \"Sphingomonas\"                         \n[141] \"MSBL3\"                                \n[142] \"Aeromonas\"                            \n[143] \"Haliangium\"                           \n[144] \"Thermanaerovibrio\"                    \n[145] \"Paucibacter\"                          \n[146] \"Bacteroidetes_vadinHA17\"              \n[147] \"Limnochordia\"                         \n[148] \"Faecalibacterium\"                     \n[149] \"Mesorhizobium\"                        \n[150] \"Propionicimonas\"                      \n[151] \"Propionicicella\"                      \n[152] \"env.OPS_17\"                           \n[153] \"Clostridium_sensu_stricto_8\"          \n[154] \"Hyphomicrobium\"                       \n[155] \"Paracoccus\"                           \n[156] \"Ruminococcus\"                         \n[157] \"Gordonia\"                             \n[158] \"SM2D12\"                               \n[159] \"AKIW659\"                              \n[160] \"Conexibacter\"                         \n[161] \"Candidatus_Captivus\"                  \n[162] \"Arcobacter\"                           \n[163] \"RBG-16-49-21\"                         \n[164] \"Clostridium_sensu_stricto_1\"          \n[165] \"Ochrobactrum\"                         \n[166] \"Family_XIII_AD3011_group\"             \n[167] \"Pleomorphomonas\"                      \n[168] \"Kapabacteriales\"                      \n[169] \"Acetobacteroides\"                     \n[170] \"Fusicatenibacter\"                     \n[171] \"Thiothrix\"                            \n[172] \"Vogesella\"                            \n[173] \"Gastranaerophilales\"                  \n[174] \"Propionivibrio\"                       \n[175] \"Blautia\"                              \n[176] \"Tetrasphaera\"                         \n[177] \"Empedobacter\"                         \n[178] \"Laribacter\"                           \n[179] \"Lachnospiraceae_ND3007_group\"         \n[180] \"Ellin516\"                             \n[181] \"Pelosinus\"                            \n[182] \"SD04E11\"                              \n[183] \"Erysipelothrix\"                       \n[184] \"Curvibacter\"                          \n[185] \"Intestinibacter\"                      \n[186] \"Opitutus\"                             \n[187] \"Thauera\"                              \n[188] \"Aestuariimicrobium\"                   \n[189] \"WS1\"                                  \n[190] \"LCP-89\"                               \n[191] \"Chryseobacterium\"                     \n[192] \"Chthonomonadales\"                     \n[193] \"Kluyvera\"                             \n[194] \"Sphingobium\"                          \n[195] \"M55-D21\"                              \n[196] \"Rhodoferax\"                           \n[197] \"Turicibacter\"                         \n[198] \"Subdoligranulum\"                      \n[199] \"Geothrix\"                             \n[200] \"UCG-002\"                              \n[201] \"Christensenellaceae_R-7_group\"        \n[202] \"053A03-B-DI-P58\"                      \n[203] \"Megamonas\"                            \n[204] \"Moorella\"                             \n\n\n\n\n\n\nprint(as)\n\n [1] \"uncultured\"                   \"Sphaerotilus\"                \n [3] \"Novosphingobium\"              \"[Agitococcus]_lubricus_group\"\n [5] \"WCHB1-32\"                     \"Sericytochromatia\"           \n [7] \"Zoogloea\"                     \"Fluviicoccus\"                \n [9] \"Methylorosula\"                \"Hydrogenophaga\"              \n[11] \"Edaphobaculum\"                \"Rhodoferax\"                  \n[13] \"Candidatus_Accumulibacter\"    \"Lentimicrobiaceae\"           \n[15] \"Pajaroellobacter\"             \"DEV114\"                      \n[17] \"Flavobacterium\"               \"Dechloromonas\"               \n[19] \"Ferruginibacter\"              \"Haliangium\"                  \n[21] \"37-13\"                        \"Sphingobium\"                 \n[23] \"env.OPS_17\"                   \"Methyloversatilis\"           \n[25] \"Leptothrix\"                   \"Ferribacterium\"              \n[27] \"Bacteriovorax\"                \"Hylemonella\"                 \n[29] \"Methylotenera\"                \"Sulfuritalea\"                \n[31] \"Simplicispira\"                \"Nannocystis\"                 \n[33] \"AAP99\"                        \"Halomonas\"                   \n\n\n\n\n\n\nprint(eff)\n\n [1] \"Pseudomonas\"                                       \n [2] \"Aquaspirillum\"                                     \n [3] \"Clostridium_sensu_stricto_12\"                      \n [4] \"Acinetobacter\"                                     \n [5] \"Rhodoferax\"                                        \n [6] \"Imtechella\"                                        \n [7] \"Edaphobaculum\"                                     \n [8] \"Babeliales\"                                        \n [9] \"Giesbergeria\"                                      \n[10] \"JTB23\"                                             \n[11] \"uncultured\"                                        \n[12] \"Trichococcus\"                                      \n[13] \"Flavobacterium\"                                    \n[14] \"Lactococcus\"                                       \n[15] \"Megamonas\"                                         \n[16] \"Limnohabitans\"                                     \n[17] \"Sphingobium\"                                       \n[18] \"Chloroplast\"                                       \n[19] \"Pelosinus\"                                         \n[20] \"Polynucleobacter\"                                  \n[21] \"Allobacillus\"                                      \n[22] \"Hydrogenophaga\"                                    \n[23] \"Ottowia\"                                           \n[24] \"Candidatus_Paracaedibacter\"                        \n[25] \"env.OPS_17\"                                        \n[26] \"Pelomonas\"                                         \n[27] \"Comamonas\"                                         \n[28] \"Clostridium_sensu_stricto_1\"                       \n[29] \"Romboutsia\"                                        \n[30] \"Lachnospiraceae_ND3007_group\"                      \n[31] \"Victivallaceae\"                                    \n[32] \"Allorhizobium-Neorhizobium-Pararhizobium-Rhizobium\"\n[33] \"Prosthecobacter\"                                   \n[34] \"Pedobacter\"                                        \n[35] \"Paucibacter\"                                       \n[36] \"Aquabacterium\"                                     \n[37] \"SM2D12\"                                            \n[38] \"Unknown_Family\"                                    \n[39] \"Curvibacter\"                                       \n[40] \"Lysobacter\"                                        \n[41] \"Novosphingobium\"                                   \n[42] \"Mycobacterium\"                                     \n[43] \"GKS98_freshwater_group\"                            \n[44] \"Cloacibacterium\"                                   \n[45] \"Polaromonas\"                                       \n[46] \"Thiothrix\"                                         \n[47] \"TM7x\"                                              \n[48] \"Saccharimonadales\"                                 \n[49] \"Holdemanella\"                                      \n[50] \"Bdellovibrio\"                                      \n[51] \"Streptococcus\"                                     \n[52] \"RF39\"                                              \n[53] \"Mitochondria\"                                      \n[54] \"Coxiella\"                                          \n[55] \"Cephaloticoccus\"                                   \n[56] \"Gracilibacteria\"                                   \n[57] \"Leptothrix\"                                        \n[58] \"Rhodococcus\"                                       \n[59] \"Dechloromonas\"                                     \n[60] \"Acidovorax\"                                        \n[61] \"Propionivibrio\"                                    \n[62] \"Bact-08\"                                           \n[63] \"Lutispora\"                                         \n[64] \"Bifidobacterium\"                                   \n[65] \"Mitsuokella\"                                       \n[66] \"Candidatus_Gortzia\"                                \n[67] \"Alcaligenaceae\"                                    \n[68] \"Chryseobacterium\"                                  \n[69] \"Zoogloea\"                                          \n[70] \"Sulfuricurvum\"                                     \n[71] \"Fluviicola\"                                        \n[72] \"Sphingomonas\"                                      \n\n\n\n\n\n\nprint(inf)\n\n [1] \"Faecalibacterium\"                     \n [2] \"Aeromonas\"                            \n [3] \"Hydrogenophaga\"                       \n [4] \"Prevotella\"                           \n [5] \"Janthinobacterium\"                    \n [6] \"Negativibacillus\"                     \n [7] \"Rivicola\"                             \n [8] \"Chryseobacterium\"                     \n [9] \"Pseudomonas\"                          \n[10] \"Arcobacter\"                           \n[11] \"Hypnocyclicus\"                        \n[12] \"Butyricicoccus\"                       \n[13] \"Parabacteroides\"                      \n[14] \"Roseburia\"                            \n[15] \"Flavobacterium\"                       \n[16] \"Subdoligranulum\"                      \n[17] \"Bacteroides\"                          \n[18] \"Lactococcus\"                          \n[19] \"Coprococcus\"                          \n[20] \"Leucobacter\"                          \n[21] \"Blautia\"                              \n[22] \"Tolumonas\"                            \n[23] \"UCG-002\"                              \n[24] \"Tyzzerella\"                           \n[25] \"[Eubacterium]_siraeum_group\"          \n[26] \"[Agitococcus]_lubricus_group\"         \n[27] \"Pseudarcobacter\"                      \n[28] \"Rhodoferax\"                           \n[29] \"Lachnospiraceae_NK4A136_group\"        \n[30] \"Comamonas\"                            \n[31] \"Coprothermobacter\"                    \n[32] \"uncultured\"                           \n[33] \"Propionivibrio\"                       \n[34] \"Lachnospira\"                          \n[35] \"Zoogloea\"                             \n[36] \"Formivibrio\"                          \n[37] \"Bifidobacterium\"                      \n[38] \"Macellibacteroides\"                   \n[39] \"Cloacibacterium\"                      \n[40] \"Sulfurospirillum\"                     \n[41] \"Microbacterium\"                       \n[42] \"Akkermansia\"                          \n[43] \"Acinetobacter\"                        \n[44] \"Monoglobus\"                           \n[45] \"Dorea\"                                \n[46] \"Phascolarctobacterium\"                \n[47] \"[Eubacterium]_coprostanoligenes_group\"\n[48] \"Erysipelotrichaceae_UCG-003\"          \n[49] \"Vogesella\"                            \n[50] \"Holdemanella\"                         \n[51] \"Lelliottia\"                           \n[52] \"Malikia\"                              \n[53] \"Sutterella\"                           \n[54] \"Raoultella\"                           \n[55] \"Microvirgula\"                         \n[56] \"Desulfovibrio\"                        \n[57] \"Catenisphaera\"                        \n[58] \"UCG-003\"                              \n[59] \"[Ruminococcus]_gauvreauii_group\"      \n[60] \"Incertae_Sedis\"                       \n[61] \"Oscillibacter\"                        \n[62] \"Rhodobacter\"                          \n[63] \"Shewanella\"                           \n[64] \"Ruminococcus\"                         \n[65] \"Agathobacter\"                         \n[66] \"Paludibacter\"                         \n[67] \"Mitochondria\"                         \n[68] \"Undibacterium\"                        \n[69] \"Collinsella\"                          \n[70] \"Dechloromonas\"                        \n\n\n\n\n\n\nprint(tf)\n\n [1] \"Pseudarcobacter\"                                   \n [2] \"Pseudomonas\"                                       \n [3] \"Zoogloea\"                                          \n [4] \"FTLpost3\"                                          \n [5] \"uncultured\"                                        \n [6] \"Flavobacterium\"                                    \n [7] \"Absconditabacteriales_\"                            \n [8] \"Bergeyella\"                                        \n [9] \"Leeia\"                                             \n[10] \"Hydrogenophaga\"                                    \n[11] \"BSV13\"                                             \n[12] \"Chryseobacterium\"                                  \n[13] \"Novosphingobium\"                                   \n[14] \"Beggiatoaceae\"                                     \n[15] \"Undibacterium\"                                     \n[16] \"Dechloromonas\"                                     \n[17] \"Acinetobacter\"                                     \n[18] \"Bacteroides\"                                       \n[19] \"Prevotella\"                                        \n[20] \"Terrimonas\"                                        \n[21] \"Lachnospira\"                                       \n[22] \"Agathobacter\"                                      \n[23] \"Collinsella\"                                       \n[24] \"Allobacillus\"                                      \n[25] \"Acidovorax\"                                        \n[26] \"Simplicispira\"                                     \n[27] \"Paludibacter\"                                      \n[28] \"Soonwooa\"                                          \n[29] \"Geobacter\"                                         \n[30] \"Fusibacter\"                                        \n[31] \"T34\"                                               \n[32] \"Sulfuricurvum\"                                     \n[33] \"Lactococcus\"                                       \n[34] \"GWE2-42-42\"                                        \n[35] \"Rivicola\"                                          \n[36] \"Thiothrix\"                                         \n[37] \"Comamonas\"                                         \n[38] \"KD1-131\"                                           \n[39] \"Allorhizobium-Neorhizobium-Pararhizobium-Rhizobium\"\n[40] \"Erysipelotrichaceae_UCG-003\"                       \n[41] \"Mariprofundus\"                                     \n[42] \"Ruminococcus\"                                      \n[43] \"Janthinobacterium\"                                 \n[44] \"LCP-89\"                                            \n[45] \"Dialister\"                                         \n[46] \"Akkermansia\"                                       \n[47] \"Quatrionicoccus\"                                   \n[48] \"Rhodoferax\"                                        \n[49] \"Polaromonas\"                                       \n[50] \"Williamwhitmania\"                                  \n[51] \"Cloacibacterium\"                                   \n[52] \"Aeromonas\"                                         \n[53] \"Alistipes\"                                         \n[54] \"Coprothermobacter\"                                 \n[55] \"Fonticella\"                                        \n[56] \"Aquabacterium\"                                     \n[57] \"env.OPS_17\"                                        \n[58] \"Propionivibrio\"                                    \n[59] \"Candidatus_Accumulibacter\"                         \n[60] \"M2PB4-65_termite_group\"                            \n[61] \"Diaphorobacter\"                                    \n[62] \"[Cytophaga]_xylanolytica_group\"                    \n[63] \"WCHB1-32\"                                          \n[64] \"Erysipelothrix\"                                    \n[65] \"Lachnospiraceae_NK4A136_group\"                     \n[66] \"Alkanindiges\"                                      \n\n\n\n\n\n\nprint(tss)\n\n [1] \"Zoogloea\"                                          \n [2] \"Pelosinus\"                                         \n [3] \"Prevotella\"                                        \n [4] \"Bacteroides\"                                       \n [5] \"Moraxella\"                                         \n [6] \"uncultured\"                                        \n [7] \"PeM15\"                                             \n [8] \"Paludibacter\"                                      \n [9] \"Weeksellaceae\"                                     \n[10] \"Enterobacter\"                                      \n[11] \"XBB1006\"                                           \n[12] \"Streptococcus\"                                     \n[13] \"Comamonas\"                                         \n[14] \"Clostridium_sensu_stricto_1\"                       \n[15] \"Cloacibacterium\"                                   \n[16] \"Clostridium_sensu_stricto_12\"                      \n[17] \"Sulfurospirillum\"                                  \n[18] \"Brachymonas\"                                       \n[19] \"Klebsiella\"                                        \n[20] \"Clostridium_sensu_stricto_13\"                      \n[21] \"Sebaldella\"                                        \n[22] \"Vitreoscilla\"                                      \n[23] \"Diaphorobacter\"                                    \n[24] \"Pseudarcobacter\"                                   \n[25] \"Ottowia\"                                           \n[26] \"Sphaerotilus\"                                      \n[27] \"Raoultella\"                                        \n[28] \"Alkanindiges\"                                      \n[29] \"Eubacterium\"                                       \n[30] \"Chryseobacterium\"                                  \n[31] \"Mycobacterium\"                                     \n[32] \"Macellibacteroides\"                                \n[33] \"Empedobacter\"                                      \n[34] \"Veillonella\"                                       \n[35] \"Propionispira\"                                     \n[36] \"Laribacter\"                                        \n[37] \"Paracoccus\"                                        \n[38] \"Stenoxybacter\"                                     \n[39] \"[Agitococcus]_lubricus_group\"                      \n[40] \"Nakamurella\"                                       \n[41] \"Uruburuella\"                                       \n[42] \"Clostridium_sensu_stricto_7\"                       \n[43] \"Novosphingobium\"                                   \n[44] \"Leptotrichia\"                                      \n[45] \"Propioniciclava\"                                   \n[46] \"Pleomorphomonas\"                                   \n[47] \"T34\"                                               \n[48] \"Dysgonomonas\"                                      \n[49] \"Butyrivibrio\"                                      \n[50] \"Propionivibrio\"                                    \n[51] \"Incertae_Sedis\"                                    \n[52] \"Uliginosibacterium\"                                \n[53] \"Tolumonas\"                                         \n[54] \"Neisseria\"                                         \n[55] \"Geobacter\"                                         \n[56] \"Anaerospora\"                                       \n[57] \"Arcobacter\"                                        \n[58] \"Shuttleworthia\"                                    \n[59] \"Citrobacter\"                                       \n[60] \"Acidovorax\"                                        \n[61] \"Christensenellaceae_R-7_group\"                     \n[62] \"Rivicola\"                                          \n[63] \"Desulfovibrio\"                                     \n[64] \"Niveibacterium\"                                    \n[65] \"Micropruina\"                                       \n[66] \"Rhizorhapis\"                                       \n[67] \"Sulfurovum\"                                        \n[68] \"Chelonobacter\"                                     \n[69] \"Saccharimonadales\"                                 \n[70] \"Dechloromonas\"                                     \n[71] \"Anaeromusa-Anaeroarcus\"                            \n[72] \"Phenylobacterium\"                                  \n[73] \"Aquaspirillum\"                                     \n[74] \"Flavobacterium\"                                    \n[75] \"Candidatus_Accumulibacter\"                         \n[76] \"alphaI_cluster\"                                    \n[77] \"Acinetobacter\"                                     \n[78] \"Azorhizobium\"                                      \n[79] \"Coprothermobacter\"                                 \n[80] \"Aeromonas\"                                         \n[81] \"Luteococcus\"                                       \n[82] \"Tessaracoccus\"                                     \n[83] \"Gemmobacter\"                                       \n[84] \"Sphingomonas\"                                      \n[85] \"Kluyvera\"                                          \n[86] \"Yersinia\"                                          \n[87] \"Pseudorhodobacter\"                                 \n[88] \"Thauera\"                                           \n[89] \"Allorhizobium-Neorhizobium-Pararhizobium-Rhizobium\"\n[90] \"Pasteurella\"                                       \n[91] \"Enhydrobacter\"                                     \n[92] \"Peptostreptococcus\"                                \n[93] \"Paludibacterium\"                                   \n[94] \"KD1-131\"                                           \n[95] \"Acidaminococcus\"                                   \n[96] \"Formivibrio\"                                       \n[97] \"Lactococcus\"                                       \n\n\n\n\n\n\nprint(was)\n\n [1] \"Cephaloticoccus\"               \"Thiothrix\"                    \n [3] \"uncultured\"                    \"Rhodoferax\"                   \n [5] \"Zoogloea\"                      \"WCHB1-32\"                     \n [7] \"NS11-12_marine_group\"          \"Fluviicoccus\"                 \n [9] \"Sericytochromatia\"             \"Comamonas\"                    \n[11] \"Phreatobacter\"                 \"Rurimicrobium\"                \n[13] \"Luteolibacter\"                 \"Novosphingobium\"              \n[15] \"Hydrogenophaga\"                \"Pajaroellobacter\"             \n[17] \"Roseomonas\"                    \"Limnohabitans\"                \n[19] \"Arcicella\"                     \"Phaselicystis\"                \n[21] \"Candidatus_Electronema\"        \"Aquabacterium\"                \n[23] \"Hydrogenedensaceae\"            \"Haliangium\"                   \n[25] \"Ottowia\"                       \"env.OPS_17\"                   \n[27] \"Sphingobium\"                   \"Dechloromonas\"                \n[29] \"Aquimonas\"                     \"37-13\"                        \n[31] \"Gemmatimonas\"                  \"mle1-27\"                      \n[33] \"Thermomonas\"                   \"[Agitococcus]_lubricus_group\" \n[35] \"Christensenellaceae_R-7_group\" \"Ferribacterium\"               \n[37] \"Flavobacterium\"                \"Desulfomicrobium\"             \n[39] \"Pseudorhodobacter\"             \"Lentimicrobiaceae\"            \n[41] \"Tetrasphaera\"                  \"Pelomonas\"                    \n[43] \"Paludibacter\"                  \"Ferruginibacter\"              \n[45] \"Opitutus\"                      \"M2PB4-65_termite_group\"       \n[47] \"Prosthecobacter\"               \"Geothrix\"                     \n[49] \"Alkanindiges\"                  \"SH-PL14\"                      \n[51] \"Leptothrix\""
  },
  {
    "objectID": "indicator_species_plots.html#looking-at-different-seasons-for-each-process",
    "href": "indicator_species_plots.html#looking-at-different-seasons-for-each-process",
    "title": "Indicator Species",
    "section": "",
    "text": "assign_season &lt;- function(Month) {\n  if (Month %in% c(12, 01, 02)) {\n    return(\"Winter\")\n  } else if (Month %in% c(03, 04, 05)) {\n    return(\"Spring\")\n  } else if (Month %in% c(06, 07, 08)) {\n    return(\"Summer\")\n  } else if (Month %in% c(09, 10, 11)) {\n    return(\"Fall\")\n  } else {\n    return(NA)\n  }\n}\n\ndf &lt;- abundance_table %&gt;%\n  mutate(Season = sapply(Month, assign_season)) %&gt;%\n  group_by(Season, Process) %&gt;%\n  mutate(Group = cur_group_id()) %&gt;%\n  ungroup()\n\ndf &lt;- df %&gt;% select(Group,Process, Season, Month, everything())\n\n#Codes for each group:\n# AD-Fall = 1\n# AS-Fall = 2\n# Eff-Fall = 3\n# Inf-Fall = 4\n# TF-Fall = 5\n# TSS_Fall = 6\n# WAS-Fall = 7\n# AD-Spring = 8\n# AS-Spring = 9\n# Eff-Spring = 10\n# Inf-Spring = 11\n# TF-Spring = 12\n# TSS-Spring = 13\n# WAS-Spring = 14\n# AD-Summer = 15\n# AS-Summer = 16\n# Eff-Summer = 17\n# Inf-Summer = 18\n# TF-Summer = 19\n# TSS-Summer = 20\n# WAS-Summer = 21\n# AD-Winter = 22\n# AS-Winter = 23\n# Eff-Winter = 24\n# Inf-Winter = 25\n# TF-Winter = 26\n# TSS-Winter = 27\n# WAS-Winter = 28\n\n#Now we have our dataframe that contains a unique group number for each process and season\ndf &lt;- df %&gt;%\n  select(-Year, -Process, -Date, -Season, -Month)\n\n#Species groups\nAD = c(1, 8, 15, 22)\nAS = c(2, 9, 16, 23)\nEff = c(3, 10, 17, 24)\nInf_ = c(4, 11, 18, 25)\nTF = c(5, 12, 19, 26)\nTSS = c(6, 13, 20, 27)\nWAS = c(7, 14, 21, 28)\n\n#Individual Species Analysis\nad_df = df %&gt;% filter(Group %in% AD)\nas_df = df %&gt;% filter(Group %in% AS)\neff_df = df %&gt;% filter(Group %in% Eff)\ninf_df = df %&gt;% filter(Group %in% Inf_)\ntf_df = df %&gt;% filter(Group %in% TF)\ntss_df = df %&gt;% filter(Group %in% TSS)\nwas_df = df %&gt;% filter(Group %in% WAS)\n\n\n\n\n#AD\ngroupings = ad_df$Group\nindval_ad &lt;- multipatt(ad_df[,c(2:ncol(ad_df))], groupings, \n                       control = how(nperm=999),duleg = FALSE) \n\n#change index column values if index=1 then change to AD-Fall etc\nad_sig.otus &lt;- indval_ad$sign %&gt;% mutate(index = case_when(index == 1 ~ \"Fall\",\n                                                           index == 2 ~ \"Spring\",\n                                                           index == 3 ~ \"Summer\",\n                                                           index == 4 ~ \"Winter\",\n                                                           index == 5 ~ \"Fall-Spring\",\n                                                           index == 6 ~ \"Fall-Summer\",\n                                                           index == 7 ~ \"Fall-Winter\",\n                                                           index == 8 ~ \"Spring-Summer\",\n                                                           index == 9 ~ \"Spring-Winter\",\n                                                           index == 10 ~ \"Summer-Winter\",\n                                                           index == 11 ~ \"Fall-Spring-Summer\",\n                                                           index == 12 ~ \"Fall-Spring-Winter\",\n                                                           index == 13 ~ \"Fall-Summer-Winter\",\n                                                           index == 14 ~ \"Spring-Summer-Winter\",\n                                                           index == 15 ~ \"Fall-Spring-Summer-Winter\"\n))\n\nad_sig.otus &lt;- ad_sig.otus %&gt;% mutate(otu = rownames(.)) %&gt;% \n  filter(p.value &lt; 0.05) %&gt;% filter(stat &gt; 0.5) %&gt;% \n  select(index, stat, p.value, otu) %&gt;% \n  mutate(Value = paste0(\"Zotu\",otu))%&gt;%\n  rename(OTU = Value)\n\ngrouped_list_ad &lt;- ad_sig.otus %&gt;%\n  group_by(index) %&gt;%\n  summarize(Values = list(OTU))\n\n# Define the sizes of each set and their intersections\nset_sizes &lt;- c(\n  Fall = ad_sig.otus %&gt;% filter(index == \"Fall\") %&gt;% nrow(),\n  Spring = ad_sig.otus %&gt;% filter(index == \"Spring\") %&gt;% nrow(),\n  Summer = ad_sig.otus %&gt;% filter(index == \"Summer\") %&gt;% nrow(),\n  Winter = ad_sig.otus %&gt;% filter(index == \"Winter\") %&gt;% nrow(),    \n  \"Fall&Spring\" = ad_sig.otus %&gt;% filter(index == \"Fall-Spring\") %&gt;% nrow(),\n  \"Fall&Summer\" = ad_sig.otus %&gt;% filter(index == \"Fall-Summer\") %&gt;% nrow(),\n  \"Fall&Winter\" = ad_sig.otus %&gt;% filter(index == \"Fall-Winter\") %&gt;% nrow(),\n  \"Spring&Summer\" = ad_sig.otus %&gt;% filter(index == \"Spring-Summer\") %&gt;% nrow(),\n  \"Spring&Winter\" = ad_sig.otus %&gt;% filter(index == \"Spring-Winter\") %&gt;% nrow(),\n  \"Summer&Winter\" = ad_sig.otus %&gt;% filter(index == \"Summer-Winter\") %&gt;% nrow(),\n  \"Fall&Spring&Summer\" = ad_sig.otus %&gt;% filter(index == \"Fall-Spring-Summer\") %&gt;% nrow(),\n  \"Fall&Spring&Winter\" = ad_sig.otus %&gt;% filter(index == \"Fall-Spring-Winter\") %&gt;% nrow(),\n  \"Fall&Summer&Winter\" = ad_sig.otus %&gt;% filter(index == \"Fall-Summer-Winter\") %&gt;% nrow(),\n  \"Spring&Summer&Winter\" = ad_sig.otus %&gt;% filter(index == \"Spring-Summer-Winter\") %&gt;% nrow(),\n  \"Fall&Spring&Summer&Winter\" = ad_sig.otus %&gt;% filter(index == \"Fall-Spring-Summer-Winter\") %&gt;% nrow()\n)\n\n# Function to filter out small overlaps\nfilter_data &lt;- function(data, threshold = 0.01) {\n  # Calculate the total size\n  total &lt;- sum(data)\n  # Filter out entries that are below the threshold percentage of the total size\n  filtered_data &lt;- data[data / total &gt;= threshold]\n  return(filtered_data)\n}\n\n# Filter the data\nfiltered_data &lt;- filter_data(set_sizes)\n\n# Create the Euler diagram\nfit &lt;- euler(filtered_data)\n\n# Plot the Euler diagram\n# Plot the Euler diagram\nplot(fit, labels = list(font = 3, col = \"blue\", cex = 1.25),\n     quantities = list(type = \"counts\", font = 1, col = \"black\", cex = 0.75), main = \"Seasonal Comparison of Indicator Species in AD system\")\n\n\n\n\n\n\n\nmerged_df_ad &lt;- merge(ad_sig.otus, taxa[, c(\"OTU\", \"genus\")], by = \"OTU\")\n\ngrouped_list_ad &lt;- ad_sig.otus %&gt;%\n  group_by(index) %&gt;%\n  summarize(Values = list(OTU))\n\nfall_ad &lt;- unique(grouped_list_ad$Values[grouped_list_ad$index == \"Fall\"][[1]])\nspring_ad &lt;- unique(grouped_list_ad$Values[grouped_list_ad$index == \"Spring\"][[1]])\nsummer_ad &lt;- unique(grouped_list_ad$Values[grouped_list_ad$index == \"Summer\"][[1]])\nwinter_ad &lt;- unique(grouped_list_ad$Values[grouped_list_ad$index == \"Winter\"][[1]])\nfall_spring_ad &lt;- unique(grouped_list_ad$Values[grouped_list_ad$index == \"Fall-Spring\"][[1]])\nfall_summer_ad &lt;- unique(grouped_list_ad$Values[grouped_list_ad$index == \"Fall-Summer\"][[1]])\nfall_winter_ad &lt;- unique(grouped_list_ad$Values[grouped_list_ad$index == \"Fall-Winter\"][[1]])\nspring_summer_ad &lt;- unique(grouped_list_ad$Values[grouped_list_ad$index == \"Spring-Summer\"][[1]])\nspring_winter_ad &lt;- unique(grouped_list_ad$Values[grouped_list_ad$index == \"Spring-Winter\"][[1]])\nfall_spring_summer_ad &lt;- unique(grouped_list_ad$Values[grouped_list_ad$index == \"Fall-Spring-Summer\"][[1]])\nfall_spring_winter_ad &lt;- unique(grouped_list_ad$Values[grouped_list_ad$index == \"Fall-Spring-Winter\"][[1]])\nfall_summer_winter_ad &lt;- unique(grouped_list_ad$Values[grouped_list_ad$index == \"Fall-Summer-Winter\"][[1]])\n\n\n\n\n\n\n#AS\ngroupings = as_df$Group\nindval_as &lt;- multipatt(as_df[,c(2:ncol(as_df))], groupings, \n                       control = how(nperm=999),duleg = FALSE) \n\n#change index column values if index=1 then change to AD-Fall etc\nas_sig.otus &lt;- indval_as$sign %&gt;% mutate(index = case_when(index == 1 ~ \"Fall\",\n                                                           index == 2 ~ \"Spring\",\n                                                           index == 3 ~ \"Summer\",\n                                                           index == 4 ~ \"Winter\",\n                                                           index == 5 ~ \"Fall-Spring\",\n                                                           index == 6 ~ \"Fall-Summer\",\n                                                           index == 7 ~ \"Fall-Winter\",\n                                                           index == 8 ~ \"Spring-Summer\",\n                                                           index == 9 ~ \"Spring-Winter\",\n                                                           index == 10 ~ \"Summer-Winter\",\n                                                           index == 11 ~ \"Fall-Spring-Summer\",\n                                                           index == 12 ~ \"Fall-Spring-Winter\",\n                                                           index == 13 ~ \"Fall-Summer-Winter\",\n                                                           index == 14 ~ \"Spring-Summer-Winter\",\n                                                           index == 15 ~ \"Fall-Spring-Summer-Winter\"\n))\n\nas_sig.otus &lt;- as_sig.otus %&gt;% mutate(otu = rownames(.)) %&gt;% \n  filter(p.value &lt; 0.05) %&gt;% filter(stat &gt; 0.5) %&gt;% \n  select(index, stat, p.value, otu) %&gt;% \n  mutate(Value = paste0(\"Zotu\",otu))%&gt;%\n  rename(OTU = Value)\n\ngrouped_list_as &lt;- as_sig.otus %&gt;%\n  group_by(index) %&gt;%\n  summarize(Values = list(OTU))\n\n# Define the sizes of each set and their intersections\nset_sizes_as &lt;- c(\n  Fall = as_sig.otus %&gt;% filter(index == \"Fall\") %&gt;% nrow(),\n  Spring = as_sig.otus %&gt;% filter(index == \"Spring\") %&gt;% nrow(),\n  Summer = as_sig.otus %&gt;% filter(index == \"Summer\") %&gt;% nrow(),\n  Winter = as_sig.otus %&gt;% filter(index == \"Winter\") %&gt;% nrow(),    \n  \"Fall&Spring\" = as_sig.otus %&gt;% filter(index == \"Fall-Spring\") %&gt;% nrow(),\n  \"Fall&Summer\" = as_sig.otus %&gt;% filter(index == \"Fall-Summer\") %&gt;% nrow(),\n  \"Fall&Winter\" = as_sig.otus %&gt;% filter(index == \"Fall-Winter\") %&gt;% nrow(),\n  \"Spring&Summer\" = as_sig.otus %&gt;% filter(index == \"Spring-Summer\") %&gt;% nrow(),\n  \"Spring&Winter\" = as_sig.otus %&gt;% filter(index == \"Spring-Winter\") %&gt;% nrow(),\n  \"Summer&Winter\" = as_sig.otus %&gt;% filter(index == \"Summer-Winter\") %&gt;% nrow(),\n  \"Fall&Spring&Summer\" = as_sig.otus %&gt;% filter(index == \"Fall-Spring-Summer\") %&gt;% nrow(),\n  \"Fall&Spring&Winter\" = as_sig.otus %&gt;% filter(index == \"Fall-Spring-Winter\") %&gt;% nrow(),\n  \"Fall&Summer&Winter\" = as_sig.otus %&gt;% filter(index == \"Fall-Summer-Winter\") %&gt;% nrow(),\n  \"Spring&Summer&Winter\" = as_sig.otus %&gt;% filter(index == \"Spring-Summer-Winter\") %&gt;% nrow(),\n  \"Fall&Spring&Summer&Winter\" = as_sig.otus %&gt;% filter(index == \"Fall-Spring-Summer-Winter\") %&gt;% nrow()\n)\n\n# Filter the data\nfiltered_data_as &lt;- filter_data(set_sizes_as)\n\n# Create the Euler diagram\nfit_as &lt;- euler(filtered_data_as)\n\n# Plot the Euler diagram\nplot(fit_as, labels = list(font = 3, col = \"blue\", cex = 1.25),\n     quantities = list(type = \"counts\", font = 1, col = \"black\", cex = 0.75), \n     main = \"Seasonal Comparison of Indicator Species in AS system\")\n\n\n\n\n\n\n\nmerged_df_as &lt;- merge(as_sig.otus, taxa[, c(\"OTU\", \"genus\")], by = \"OTU\")\n\ngrouped_list_as &lt;- as_sig.otus %&gt;%\n  group_by(index) %&gt;%\n  summarize(Values = list(OTU))\n\nfall_as &lt;- unique(grouped_list_as$Values[grouped_list_as$index == \"Fall\"][[1]])\nspring_as &lt;- unique(grouped_list_as$Values[grouped_list_as$index == \"Spring\"][[1]])\nsummer_as &lt;- unique(grouped_list_as$Values[grouped_list_as$index == \"Summer\"][[1]])\nwinter_as &lt;- unique(grouped_list_as$Values[grouped_list_as$index == \"Winter\"][[1]])\nfall_spring_as &lt;- unique(grouped_list_as$Values[grouped_list_as$index == \"Fall-Spring\"][[1]])\nfall_summer_as &lt;- unique(grouped_list_as$Values[grouped_list_as$index == \"Fall-Summer\"][[1]])\nfall_winter_as &lt;- unique(grouped_list_as$Values[grouped_list_as$index == \"Fall-Winter\"][[1]])\nspring_summer_as &lt;- unique(grouped_list_as$Values[grouped_list_as$index == \"Spring-Summer\"][[1]])\nspring_winter_as &lt;- unique(grouped_list_as$Values[grouped_list_as$index == \"Spring-Winter\"][[1]])\nfall_spring_summer_as &lt;- unique(grouped_list_as$Values[grouped_list_as$index == \"Fall-Spring-Summer\"][[1]])\nfall_spring_winter_as &lt;- unique(grouped_list_as$Values[grouped_list_as$index == \"Fall-Spring-Winter\"][[1]])\nfall_summer_winter_as &lt;- unique(grouped_list_as$Values[grouped_list_as$index == \"Fall-Summer-Winter\"][[1]])\n\n\n\n\n\n\n#Eff\ngroupings = eff_df$Group\nindval_eff &lt;- multipatt(eff_df[,c(2:ncol(eff_df))], groupings, \n                        control = how(nperm=999),duleg = FALSE)\n\n#change index column values if index=1 then change to AD-Fall etc\neff_sig.otus &lt;- indval_eff$sign %&gt;% mutate(index = case_when(index == 1 ~ \"Fall\",\n                                                             index == 2 ~ \"Spring\",\n                                                             index == 3 ~ \"Summer\",\n                                                             index == 4 ~ \"Winter\",\n                                                             index == 5 ~ \"Fall-Spring\",\n                                                             index == 6 ~ \"Fall-Summer\",\n                                                             index == 7 ~ \"Fall-Winter\",\n                                                             index == 8 ~ \"Spring-Summer\",\n                                                             index == 9 ~ \"Spring-Winter\",\n                                                             index == 10 ~ \"Summer-Winter\",\n                                                             index == 11 ~ \"Fall-Spring-Summer\",\n                                                             index == 12 ~ \"Fall-Spring-Winter\",\n                                                             index == 13 ~ \"Fall-Summer-Winter\",\n                                                             index == 14 ~ \"Spring-Summer-Winter\",\n                                                             index == 15 ~ \"Fall-Spring-Summer-Winter\"\n))\n\neff_sig.otus &lt;- eff_sig.otus %&gt;% mutate(otu = rownames(.)) %&gt;% \n  filter(p.value &lt; 0.05) %&gt;% filter(stat &gt; 0.5) %&gt;% \n  select(index, stat, p.value, otu) %&gt;% \n  mutate(Value = paste0(\"Zotu\",otu))%&gt;%\n  rename(OTU = Value)\n\n#create a new dataframe for each unique index value\n\ngrouped_list_eff &lt;- eff_sig.otus %&gt;%\n  group_by(index) %&gt;%\n  summarize(Values = list(OTU))\n\n# Define the sizes of each set and their intersections\nset_sizes_eff &lt;- c(\n  Fall = eff_sig.otus %&gt;% filter(index == \"Fall\") %&gt;% nrow(),\n  Spring = eff_sig.otus %&gt;% filter(index == \"Spring\") %&gt;% nrow(),\n  Summer = eff_sig.otus %&gt;% filter(index == \"Summer\") %&gt;% nrow(),\n  Winter = eff_sig.otus %&gt;% filter(index == \"Winter\") %&gt;% nrow(),    \n  \"Fall&Spring\" = eff_sig.otus %&gt;% filter(index == \"Fall-Spring\") %&gt;% nrow(),\n  \"Fall&Summer\" = eff_sig.otus %&gt;% filter(index == \"Fall-Summer\") %&gt;% nrow(),\n  \"Fall&Winter\" = eff_sig.otus %&gt;% filter(index == \"Fall-Winter\") %&gt;% nrow(),\n  \"Spring&Summer\" = eff_sig.otus %&gt;% filter(index == \"Spring-Summer\") %&gt;% nrow(),\n  \"Spring&Winter\" = eff_sig.otus %&gt;% filter(index == \"Spring-Winter\") %&gt;% nrow(),\n  \"Summer&Winter\" = eff_sig.otus %&gt;% filter(index == \"Summer-Winter\") %&gt;% nrow(),\n  \"Fall&Spring&Summer\" = eff_sig.otus %&gt;% filter(index == \"Fall-Spring-Summer\") %&gt;% nrow(),\n  \"Fall&Spring&Winter\" = eff_sig.otus %&gt;% filter(index == \"Fall-Spring-Winter\") %&gt;% nrow(),\n  \"Fall&Summer&Winter\" = eff_sig.otus %&gt;% filter(index == \"Fall-Summer-Winter\") %&gt;% nrow(),\n  \"Spring&Summer&Winter\" = eff_sig.otus %&gt;% filter(index == \"Spring-Summer-Winter\") %&gt;% nrow(),\n  \"Fall&Spring&Summer&Winter\" = eff_sig.otus %&gt;% filter(index == \"Fall-Spring-Summer-Winter\") %&gt;% nrow()\n)\n\n# Filter the data\nfiltered_data_eff &lt;- filter_data(set_sizes_eff)\n\n# Create the Euler diagram\nfit_eff &lt;- euler(filtered_data_eff)\n\n# Plot the Euler diagram\nplot(fit_eff,labels = list(font = 3, col = \"blue\", cex = 1.25),\n     quantities = list(type = \"counts\", font = 1, col = \"black\", cex = 0.75), main = \"Seasonal Comparison of Indicator Species in Eff system\")\n\n\n\n\n\n\n\nmerged_df_eff &lt;- merge(ad_sig.otus, taxa[, c(\"OTU\", \"genus\")], by = \"OTU\")\n\ngrouped_list_eff &lt;- eff_sig.otus %&gt;%\n  group_by(index) %&gt;%\n  summarize(Values = list(OTU))\n\nfall_eff &lt;- unique(grouped_list_eff$Values[grouped_list_eff$index == \"Fall\"][[1]])\nspring_eff &lt;-unique(grouped_list_eff$Values[grouped_list_eff$index == \"Spring\"][[1]])\nsummer_eff &lt;- unique(grouped_list_eff$Values[grouped_list_eff$index == \"Summer\"][[1]])\nwinter_eff &lt;-unique(grouped_list_eff$Values[grouped_list_eff$index == \"Winter\"][[1]])\nfall_spring_eff &lt;- unique(grouped_list_eff$Values[grouped_list_eff$index == \"Fall-Spring\"][[1]])\nfall_summer_eff &lt;- unique(grouped_list_eff$Values[grouped_list_eff$index == \"Fall-Summer\"][[1]])\nfall_winter_eff &lt;- unique(grouped_list_eff$Values[grouped_list_eff$index == \"Fall-Winter\"][[1]])\nspring_summer_eff &lt;- unique(grouped_list_eff$Values[grouped_list_eff$index == \"Spring-Summer\"][[1]])\nspring_winter_eff &lt;- unique(grouped_list_eff$Values[grouped_list_eff$index == \"Spring-Winter\"][[1]])\nsummer_winter_eff &lt;- unique(grouped_list_eff$Values[grouped_list_eff$index == \"Summer-Winter\"][[1]])\nfall_spring_summer_eff &lt;- unique(grouped_list_eff$Values[grouped_list_eff$index == \"Fall-Spring-Summer\"][[1]])\nfall_spring_winter_eff &lt;- unique(grouped_list_eff$Values[grouped_list_eff$index == \"Fall-Spring-Winter\"][[1]])\nfall_summer_winter_eff &lt;- unique(grouped_list_eff$Values[grouped_list_eff$index == \"Fall-Summer-Winter\"][[1]])\nspring_summer_winter_eff &lt;- unique(grouped_list_eff$Values[grouped_list_eff$index == \"Spring-Summer-Winter\"][[1]])\n\n\n\n\n\n\n#Inf\ngroupings = inf_df$Group\nindval_inf &lt;- multipatt(inf_df[,c(2:ncol(inf_df))], groupings, \n                        control = how(nperm=999),duleg = FALSE)\n\n#change index column values if index=1 then change to AD-Fall etc\ninf_sig.otus &lt;- indval_inf$sign %&gt;% mutate(index = case_when(index == 1 ~ \"Fall\",\n                                                             index == 2 ~ \"Spring\",\n                                                             index == 3 ~ \"Summer\",\n                                                             index == 4 ~ \"Winter\",\n                                                             index == 5 ~ \"Fall-Spring\",\n                                                             index == 6 ~ \"Fall-Summer\",\n                                                             index == 7 ~ \"Fall-Winter\",\n                                                             index == 8 ~ \"Spring-Summer\",\n                                                             index == 9 ~ \"Spring-Winter\",\n                                                             index == 10 ~ \"Summer-Winter\",\n                                                             index == 11 ~ \"Fall-Spring-Summer\",\n                                                             index == 12 ~ \"Fall-Spring-Winter\",\n                                                             index == 13 ~ \"Fall-Summer-Winter\",\n                                                             index == 14 ~ \"Spring-Summer-Winter\",\n                                                             index == 15 ~ \"Fall-Spring-Summer-Winter\"\n))\n\ninf_sig.otus &lt;- inf_sig.otus %&gt;% mutate(otu = rownames(.)) %&gt;% \n  filter(p.value &lt; 0.05) %&gt;% filter(stat &gt; 0.5) %&gt;% \n  select(index, stat, p.value, otu) %&gt;% \n  mutate(Value = paste0(\"Zotu\",otu))%&gt;%\n  rename(OTU = Value)\n\n#create a new dataframe for each unique index value\n\ngrouped_list_inf &lt;- inf_sig.otus %&gt;%\n  group_by(index) %&gt;%\n  summarize(Values = list(OTU))\n\n# Define the sizes of each set and their intersections\nset_sizes_inf &lt;- c(\n  Fall = inf_sig.otus %&gt;% filter(index == \"Fall\") %&gt;% nrow(),\n  Spring = inf_sig.otus %&gt;% filter(index == \"Spring\") %&gt;% nrow(),\n  Summer = inf_sig.otus %&gt;% filter(index == \"Summer\") %&gt;% nrow(),\n  Winter = inf_sig.otus %&gt;% filter(index == \"Winter\") %&gt;% nrow(),    \n  \"Fall&Spring\" = inf_sig.otus %&gt;% filter(index == \"Fall-Spring\") %&gt;% nrow(),\n  \"Fall&Summer\" = inf_sig.otus %&gt;% filter(index == \"Fall-Summer\") %&gt;% nrow(),\n  \"Fall&Winter\" = inf_sig.otus %&gt;% filter(index == \"Fall-Winter\") %&gt;% nrow(),\n  \"Spring&Summer\" = inf_sig.otus %&gt;% filter(index == \"Spring-Summer\") %&gt;% nrow(),\n  \"Spring&Winter\" = inf_sig.otus %&gt;% filter(index == \"Spring-Winter\") %&gt;% nrow(),\n  \"Summer&Winter\" = inf_sig.otus %&gt;% filter(index == \"Summer-Winter\") %&gt;% nrow(),\n  \"Fall&Spring&Summer\" = inf_sig.otus %&gt;% filter(index == \"Fall-Spring-Summer\") %&gt;% nrow(),\n  \"Fall&Spring&Winter\" = inf_sig.otus %&gt;% filter(index == \"Fall-Spring-Winter\") %&gt;% nrow(),\n  \"Fall&Summer&Winter\" = inf_sig.otus %&gt;% filter(index == \"Fall-Summer-Winter\") %&gt;% nrow(),\n  \"Spring&Summer&Winter\" = inf_sig.otus %&gt;% filter(index == \"Spring-Summer-Winter\") %&gt;% nrow(),\n  \"Fall&Spring&Summer&Winter\" = inf_sig.otus %&gt;% filter(index == \"Fall-Spring-Summer-Winter\") %&gt;% nrow()\n)\n\n# Filter the data\nfiltered_data_inf &lt;- filter_data(set_sizes_inf)\n\n# Create the Euler diagram\nfit_inf &lt;- euler(filtered_data_inf)\n\n# Plot the Euler diagram\nplot(fit_inf, labels = list(font = 3, col = \"blue\", cex = 1.25),\n     quantities = list(type = \"counts\", font = 1, col = \"black\", cex = 0.75), main = \"Seasonal Comparison of Indicator Species in Inf system\")\n\n\n\n\n\n\n\nmerged_df_inf &lt;- merge(inf_sig.otus, taxa[, c(\"OTU\", \"genus\")], by = \"OTU\")\n\ngrouped_list_inf &lt;- inf_sig.otus %&gt;%\n  group_by(index) %&gt;%\n  summarize(Values = list(OTU))\n\nfall_inf &lt;- unique(grouped_list_inf$Values[grouped_list_inf$index == \"Fall\"][[1]])\nspring_inf &lt;- unique(grouped_list_inf$Values[grouped_list_inf$index == \"Spring\"][[1]])\nsummer_inf &lt;- unique(grouped_list_inf$Values[grouped_list_inf$index == \"Summer\"][[1]])\nwinter_inf &lt;- unique(grouped_list_inf$Values[grouped_list_inf$index == \"Winter\"][[1]])\nfall_spring_inf &lt;- unique(grouped_list_inf$Values[grouped_list_inf$index == \"Fall-Spring\"][[1]])\nfall_summer_inf &lt;- unique(grouped_list_inf$Values[grouped_list_inf$index == \"Fall-Summer\"][[1]])\nfall_winter_inf &lt;- unique(grouped_list_inf$Values[grouped_list_inf$index == \"Fall-Winter\"][[1]])\nspring_summer_inf &lt;- unique(grouped_list_inf$Values[grouped_list_inf$index == \"Spring-Summer\"][[1]])\nspring_winter_inf &lt;- unique(grouped_list_inf$Values[grouped_list_inf$index == \"Spring-Winter\"][[1]])\nsummer_winter_inf &lt;- unique(grouped_list_inf$Values[grouped_list_inf$index == \"Summer-Winter\"][[1]])\nfall_spring_summer_inf &lt;- unique(grouped_list_inf$Values[grouped_list_inf$index == \"Fall-Spring-Summer\"][[1]])\nfall_spring_winter_inf &lt;- unique(grouped_list_inf$Values[grouped_list_inf$index == \"Fall-Spring-Winter\"][[1]])\nfall_summer_winter_inf &lt;- unique(grouped_list_inf$Values[grouped_list_inf$index == \"Fall-Summer-Winter\"][[1]])\nspring_summer_winter_inf &lt;- unique(grouped_list_inf$Values[grouped_list_inf$index == \"Spring-Summer-Winter\"][[1]])\n\n\n\n\n\n\n#TF\ngroupings = tf_df$Group\nindval_tf &lt;- multipatt(tf_df[,c(2:ncol(tf_df))], groupings, \n                       control = how(nperm=999),duleg = FALSE)\n\n#change index column values if index=1 then change to AD-Fall etc\ntf_sig.otus &lt;- indval_tf$sign %&gt;% mutate(index = case_when(index == 1 ~ \"Fall\",\n                                                           index == 2 ~ \"Spring\",\n                                                           index == 3 ~ \"Summer\",\n                                                           index == 4 ~ \"Winter\",\n                                                           index == 5 ~ \"Fall-Spring\",\n                                                           index == 6 ~ \"Fall-Summer\",\n                                                           index == 7 ~ \"Fall-Winter\",\n                                                           index == 8 ~ \"Spring-Summer\",\n                                                           index == 9 ~ \"Spring-Winter\",\n                                                           index == 10 ~ \"Summer-Winter\",\n                                                           index == 11 ~ \"Fall-Spring-Summer\",\n                                                           index == 12 ~ \"Fall-Spring-Winter\",\n                                                           index == 13 ~ \"Fall-Summer-Winter\",\n                                                           index == 14 ~ \"Spring-Summer-Winter\",\n                                                           index == 15 ~ \"Fall-Spring-Summer-Winter\"\n))\n\ntf_sig.otus &lt;- tf_sig.otus %&gt;% mutate(otu = rownames(.)) %&gt;% \n  filter(p.value &lt; 0.05) %&gt;% filter(stat &gt; 0.5) %&gt;% \n  select(index, stat, p.value, otu) %&gt;% \n  mutate(Value = paste0(\"Zotu\",otu))%&gt;%\n  rename(OTU = Value)\n\ngrouped_list_tf &lt;- tf_sig.otus %&gt;%\n  group_by(index) %&gt;%\n  summarize(Values = list(OTU))\n\n# Define the sizes of each set and their intersections\nset_sizes_tf &lt;- c(\n  Fall = tf_sig.otus %&gt;% filter(index == \"Fall\") %&gt;% nrow(),\n  Spring = tf_sig.otus %&gt;% filter(index == \"Spring\") %&gt;% nrow(),\n  Summer = tf_sig.otus %&gt;% filter(index == \"Summer\") %&gt;% nrow(),\n  Winter = tf_sig.otus %&gt;% filter(index == \"Winter\") %&gt;% nrow(),    \n  \"Fall&Spring\" = tf_sig.otus %&gt;% filter(index == \"Fall-Spring\") %&gt;% nrow(),\n  \"Fall&Summer\" = tf_sig.otus %&gt;% filter(index == \"Fall-Summer\") %&gt;% nrow(),\n  \"Fall&Winter\" = tf_sig.otus %&gt;% filter(index == \"Fall-Winter\") %&gt;% nrow(),\n  \"Spring&Summer\" = tf_sig.otus %&gt;% filter(index == \"Spring-Summer\") %&gt;% nrow(),\n  \"Spring&Winter\" = tf_sig.otus %&gt;% filter(index == \"Spring-Winter\") %&gt;% nrow(),\n  \"Summer&Winter\" = tf_sig.otus %&gt;% filter(index == \"Summer-Winter\") %&gt;% nrow(),\n  \"Fall&Spring&Summer\" = tf_sig.otus %&gt;% filter(index == \"Fall-Spring-Summer\") %&gt;% nrow(),\n  \"Fall&Spring&Winter\" = tf_sig.otus %&gt;% filter(index == \"Fall-Spring-Winter\") %&gt;% nrow(),\n  \"Fall&Summer&Winter\" = tf_sig.otus %&gt;% filter(index == \"Fall-Summer-Winter\") %&gt;% nrow(),\n  \"Spring&Summer&Winter\" = tf_sig.otus %&gt;% filter(index == \"Spring-Summer-Winter\") %&gt;% nrow(),\n  \"Fall&Spring&Summer&Winter\" = tf_sig.otus %&gt;% filter(index == \"Fall-Spring-Summer-Winter\") %&gt;% nrow()\n)\n\n# Filter the data\nfiltered_data_tf &lt;- filter_data(set_sizes_tf)\n\n# Create the Euler diagram\nfit_tf &lt;- euler(filtered_data_tf)\n\n# Plot the Euler diagram\nplot(fit_tf, labels = list(font = 3, col = \"blue\", cex = 1.25),\n     quantities = list(type = \"counts\", font = 1, col = \"black\", cex = 0.75), main = \"Seasonal Comparison of Indicator Species in TF system\")\n\n\n\n\n\n\n\nmerged_df_tf &lt;- merge(tf_sig.otus, taxa[, c(\"OTU\", \"genus\")], by = \"OTU\")\n\ngrouped_list_tf &lt;- tf_sig.otus %&gt;%\n  group_by(index) %&gt;%\n  summarize(Values = list(OTU))\n\nfall_tf &lt;- unique(grouped_list_tf$Values[grouped_list_tf$index == \"Fall\"][[1]])\nspring_tf &lt;- unique(grouped_list_tf$Values[grouped_list_tf$index == \"Spring\"][[1]])\nsummer_tf &lt;- unique(grouped_list_tf$Values[grouped_list_tf$index == \"Summer\"][[1]])\nwinter_tf &lt;- unique(grouped_list_tf$Values[grouped_list_tf$index == \"Winter\"][[1]])\nfall_spring_tf &lt;- unique(grouped_list_tf$Values[grouped_list_tf$index == \"Fall-Spring\"][[1]])\nfall_summer_tf &lt;- unique(grouped_list_tf$Values[grouped_list_tf$index == \"Fall-Summer\"][[1]])\nfall_winter_tf &lt;- unique(grouped_list_tf$Values[grouped_list_tf$index == \"Fall-Winter\"][[1]])\nspring_summer_tf &lt;- unique(grouped_list_tf$Values[grouped_list_tf$index == \"Spring-Summer\"][[1]])\nspring_winter_tf &lt;- unique(grouped_list_tf$Values[grouped_list_tf$index == \"Spring-Winter\"][[1]])\nsummer_winter_tf &lt;- unique(grouped_list_tf$Values[grouped_list_tf$index == \"Summer-Winter\"][[1]])\nfall_spring_summer_tf &lt;- unique(grouped_list_tf$Values[grouped_list_tf$index == \"Fall-Spring-Summer\"][[1]])\nfall_spring_winter_tf &lt;- unique(grouped_list_tf$Values[grouped_list_tf$index == \"Fall-Spring-Winter\"][[1]])\nfall_summer_winter_tf &lt;- unique(grouped_list_tf$Values[grouped_list_tf$index == \"Fall-Summer-Winter\"][[1]])\nspring_summer_winter_tf &lt;- unique(grouped_list_tf$Values[grouped_list_tf$index == \"Spring-Summer-Winter\"][[1]])\n\n\n\n\n\n\n#TSS\ngroupings = tss_df$Group\nindval_tss &lt;- multipatt(tss_df[,c(2:ncol(tss_df))], groupings, \n                        control = how(nperm=999),duleg = FALSE)\n\n#change index column values if index=1 then change to AD-Fall etc\ntss_sig.otus &lt;- indval_tss$sign %&gt;% mutate(index = case_when(index == 1 ~ \"Fall\",\n                                                             index == 2 ~ \"Spring\",\n                                                             index == 3 ~ \"Summer\",\n                                                             index == 4 ~ \"Winter\",\n                                                             index == 5 ~ \"Fall-Spring\",\n                                                             index == 6 ~ \"Fall-Summer\",\n                                                             index == 7 ~ \"Fall-Winter\",\n                                                             index == 8 ~ \"Spring-Summer\",\n                                                             index == 9 ~ \"Spring-Winter\",\n                                                             index == 10 ~ \"Summer-Winter\",\n                                                             index == 11 ~ \"Fall-Spring-Summer\",\n                                                             index == 12 ~ \"Fall-Spring-Winter\",\n                                                             index == 13 ~ \"Fall-Summer-Winter\",\n                                                             index == 14 ~ \"Spring-Summer-Winter\",\n                                                             index == 15 ~ \"Fall-Spring-Summer-Winter\"\n))\n\ntss_sig.otus &lt;- tss_sig.otus %&gt;% mutate(otu = rownames(.)) %&gt;% \n  filter(p.value &lt; 0.05) %&gt;% filter(stat &gt; 0.5) %&gt;% \n  select(index, stat, p.value, otu) %&gt;% \n  mutate(Value = paste0(\"Zotu\",otu))%&gt;%\n  rename(OTU = Value)\n\ngrouped_list_tss &lt;- tss_sig.otus %&gt;%\n  group_by(index) %&gt;%\n  summarize(Values = list(OTU))\n\n# Define the sizes of each set and their intersections\nset_sizes_tss &lt;- c(\n  Fall = tss_sig.otus %&gt;% filter(index == \"Fall\") %&gt;% nrow(),\n  Spring = tss_sig.otus %&gt;% filter(index == \"Spring\") %&gt;% nrow(),\n  Summer = tss_sig.otus %&gt;% filter(index == \"Summer\") %&gt;% nrow(),\n  Winter = tss_sig.otus %&gt;% filter(index == \"Winter\") %&gt;% nrow(),    \n  \"Fall&Spring\" = tss_sig.otus %&gt;% filter(index == \"Fall-Spring\") %&gt;% nrow(),\n  \"Fall&Summer\" = tss_sig.otus %&gt;% filter(index == \"Fall-Summer\") %&gt;% nrow(),\n  \"Fall&Winter\" = tss_sig.otus %&gt;% filter(index == \"Fall-Winter\") %&gt;% nrow(),\n  \"Spring&Summer\" = tss_sig.otus %&gt;% filter(index == \"Spring-Summer\") %&gt;% nrow(),\n  \"Spring&Winter\" = tss_sig.otus %&gt;% filter(index == \"Spring-Winter\") %&gt;% nrow(),\n  \"Summer&Winter\" = tss_sig.otus %&gt;% filter(index == \"Summer-Winter\") %&gt;% nrow(),\n  \"Fall&Spring&Summer\" = tss_sig.otus %&gt;% filter(index == \"Fall-Spring-Summer\") %&gt;% nrow(),\n  \"Fall&Spring&Winter\" = tss_sig.otus %&gt;% filter(index == \"Fall-Spring-Winter\") %&gt;% nrow(),\n  \"Fall&Summer&Winter\" = tss_sig.otus %&gt;% filter(index == \"Fall-Summer-Winter\") %&gt;% nrow(),\n  \"Spring&Summer&Winter\" = tss_sig.otus %&gt;% filter(index == \"Spring-Summer-Winter\") %&gt;% nrow(),\n  \"Fall&Spring&Summer&Winter\" = tss_sig.otus %&gt;% filter(index == \"Fall-Spring-Summer-Winter\") %&gt;% nrow()\n)\n\n# Filter the data\nfiltered_data_tss &lt;- filter_data(set_sizes_tss)\n\n# Create the Euler diagram\nfit_tss &lt;- euler(filtered_data_tss)\n\n# Plot the Euler diagram\nplot(fit_tss,labels = list(font = 3, col = \"blue\", cex = 1.25),\n     quantities = list(type = \"counts\", font = 1, col = \"black\", cex = 0.75), main = \"Seasonal Comparison of Indicator Species in TSS system\")\n\n\n\n\n\n\n\nmerged_df_tss &lt;- merge(tss_sig.otus, taxa[, c(\"OTU\", \"genus\")], by = \"OTU\")\n\ngrouped_list_tss &lt;- tss_sig.otus %&gt;%\n  group_by(index) %&gt;%\n  summarize(Values = list(OTU))\n\nfall_tss &lt;- unique(grouped_list_tss$Values[grouped_list_tss$index == \"Fall\"][[1]])\nspring_tss &lt;- unique(grouped_list_tss$Values[grouped_list_tss$index == \"Spring\"][[1]])\nsummer_tss &lt;- unique(grouped_list_tss$Values[grouped_list_tss$index == \"Summer\"][[1]])\nwinter_tss &lt;- unique(grouped_list_tss$Values[grouped_list_tss$index == \"Winter\"][[1]])\nfall_spring_tss &lt;- unique(grouped_list_tss$Values[grouped_list_tss$index == \"Fall-Spring\"][[1]])\nfall_summer_tss &lt;- unique(grouped_list_tss$Values[grouped_list_tss$index == \"Fall-Summer\"][[1]])\nfall_winter_tss &lt;- unique(grouped_list_tss$Values[grouped_list_tss$index == \"Fall-Winter\"][[1]])\nspring_summer_tss &lt;- unique(grouped_list_tss$Values[grouped_list_tss$index == \"Spring-Summer\"][[1]])\nspring_winter_tss &lt;- unique(grouped_list_tss$Values[grouped_list_tss$index == \"Spring-Winter\"][[1]])\nsummer_winter_tss &lt;- unique(grouped_list_tss$Values[grouped_list_tss$index == \"Summer-Winter\"][[1]])\nfall_spring_summer_tss &lt;- unique(grouped_list_tss$Values[grouped_list_tss$index == \"Fall-Spring-Summer\"][[1]])\nfall_spring_winter_tss &lt;- unique(grouped_list_tss$Values[grouped_list_tss$index == \"Fall-Spring-Winter\"][[1]])\nfall_summer_winter_tss &lt;- unique(grouped_list_tss$Values[grouped_list_tss$index == \"Fall-Summer-Winter\"][[1]])\nspring_summer_winter_tss &lt;- unique(grouped_list_tss$Values[grouped_list_tss$index == \"Spring-Summer-Winter\"][[1]])\n\n\n\n\n\n\n#WAS\ngroupings = was_df$Group\nindval_was &lt;- multipatt(was_df[,c(2:ncol(was_df))], groupings, \n                        control = how(nperm=999),duleg = FALSE)\n\n#change index column values if index=1 then change to AD-Fall etc\nwas_sig.otus &lt;- indval_was$sign %&gt;% mutate(index = case_when(index == 1 ~ \"Fall\",\n                                                             index == 2 ~ \"Spring\",\n                                                             index == 3 ~ \"Summer\",\n                                                             index == 4 ~ \"Winter\",\n                                                             index == 5 ~ \"Fall-Spring\",\n                                                             index == 6 ~ \"Fall-Summer\",\n                                                             index == 7 ~ \"Fall-Winter\",\n                                                             index == 8 ~ \"Spring-Summer\",\n                                                             index == 9 ~ \"Spring-Winter\",\n                                                             index == 10 ~ \"Summer-Winter\",\n                                                             index == 11 ~ \"Fall-Spring-Summer\",\n                                                             index == 12 ~ \"Fall-Spring-Winter\",\n                                                             index == 13 ~ \"Fall-Summer-Winter\",\n                                                             index == 14 ~ \"Spring-Summer-Winter\",\n                                                             index == 15 ~ \"Fall-Spring-Summer-Winter\"\n))\n\nwas_sig.otus &lt;- was_sig.otus %&gt;% mutate(otu = rownames(.)) %&gt;% \n  filter(p.value &lt; 0.05) %&gt;% filter(stat &gt; 0.5) %&gt;% \n  select(index, stat, p.value, otu) %&gt;% \n  mutate(Value = paste0(\"Zotu\",otu))%&gt;%\n  rename(OTU = Value)\n\n#create a new dataframe for each unique index value\ngrouped_list_was &lt;- was_sig.otus %&gt;%\n  group_by(index) %&gt;%\n  summarize(Values = list(OTU))\n\n# Define the sizes of each set and their intersections\nset_sizes_was &lt;- c(\n  Fall = was_sig.otus %&gt;% filter(index == \"Fall\") %&gt;% nrow(),\n  Spring = was_sig.otus %&gt;% filter(index == \"Spring\") %&gt;% nrow(),\n  Summer = was_sig.otus %&gt;% filter(index == \"Summer\") %&gt;% nrow(),\n  Winter = was_sig.otus %&gt;% filter(index == \"Winter\") %&gt;% nrow(),    \n  \"Fall&Spring\" = was_sig.otus %&gt;% filter(index == \"Fall-Spring\") %&gt;% nrow(),\n  \"Fall&Summer\" = was_sig.otus %&gt;% filter(index == \"Fall-Summer\") %&gt;% nrow(),\n  \"Fall&Winter\" = was_sig.otus %&gt;% filter(index == \"Fall-Winter\") %&gt;% nrow(),\n  \"Spring&Summer\" = was_sig.otus %&gt;% filter(index == \"Spring-Summer\") %&gt;% nrow(),\n  \"Spring&Winter\" = was_sig.otus %&gt;% filter(index == \"Spring-Winter\") %&gt;% nrow(),\n  \"Summer&Winter\" = was_sig.otus %&gt;% filter(index == \"Summer-Winter\") %&gt;% nrow(),\n  \"Fall&Spring&Summer\" = was_sig.otus %&gt;% filter(index == \"Fall-Spring-Summer\") %&gt;% nrow(),\n  \"Fall&Spring&Winter\" = was_sig.otus %&gt;% filter(index == \"Fall-Spring-Winter\") %&gt;% nrow(),\n  \"Fall&Summer&Winter\" = was_sig.otus %&gt;% filter(index == \"Fall-Summer-Winter\") %&gt;% nrow(),\n  \"Spring&Summer&Winter\" = was_sig.otus %&gt;% filter(index == \"Spring-Summer-Winter\") %&gt;% nrow(),\n  \"Fall&Spring&Summer&Winter\" = was_sig.otus %&gt;% filter(index == \"Fall-Spring-Summer-Winter\") %&gt;% nrow()\n)\n\n# Filter the data\nfiltered_data_was &lt;- filter_data(set_sizes_was)\n\n# Create the Euler diagram\nfit_was &lt;- euler(filtered_data_was)\n\n# Plot the Euler diagram\nplot(fit_was, labels = list(font = 3, col = \"blue\", cex = 1.25),\n     quantities = list(type = \"counts\", font = 1, col = \"black\", cex = 0.75), main = \"Seasonal Comparison of Indicator Species in WAS system\")\n\n\n\n\n\n\n\nmerged_df_was &lt;- merge(was_sig.otus, taxa[, c(\"OTU\", \"genus\")], by = \"OTU\")\n\ngrouped_list_was &lt;- was_sig.otus %&gt;%\n  group_by(index) %&gt;%\n  summarize(Values = list(OTU))\n\nfall_was &lt;- unique(grouped_list_was$Values[grouped_list_was$index == \"Fall\"][[1]])\nspring_was &lt;- unique(grouped_list_was$Values[grouped_list_was$index == \"Spring\"][[1]])\nsummer_was &lt;- unique(grouped_list_was$Values[grouped_list_was$index == \"Summer\"][[1]])\nwinter_was &lt;- unique(grouped_list_was$Values[grouped_list_was$index == \"Winter\"][[1]])\nfall_spring_was &lt;- unique(grouped_list_was$Values[grouped_list_was$index == \"Fall-Spring\"][[1]])\nfall_summer_was &lt;- unique(grouped_list_was$Values[grouped_list_was$index == \"Fall-Summer\"][[1]])\nfall_winter_was &lt;- unique(grouped_list_was$Values[grouped_list_was$index == \"Fall-Winter\"][[1]])\nspring_summer_was &lt;- unique(grouped_list_was$Values[grouped_list_was$index == \"Spring-Summer\"][[1]])\nspring_winter_was &lt;- unique(grouped_list_was$Values[grouped_list_was$index == \"Spring-Winter\"][[1]])\nsummer_winter_was &lt;- unique(grouped_list_was$Values[grouped_list_was$index == \"Summer-Winter\"][[1]])\nfall_spring_summer_was &lt;- unique(grouped_list_was$Values[grouped_list_was$index == \"Fall-Spring-Summer\"][[1]])\nfall_spring_winter_was &lt;- unique(grouped_list_was$Values[grouped_list_was$index == \"Fall-Spring-Winter\"][[1]])\nfall_summer_winter_was &lt;- unique(grouped_list_was$Values[grouped_list_was$index == \"Fall-Summer-Winter\"][[1]])\nspring_summer_winter_was &lt;- unique(grouped_list_was$Values[grouped_list_was$index == \"Spring-Summer-Winter\"][[1]])"
  },
  {
    "objectID": "indicator_species_plots_sf.html",
    "href": "indicator_species_plots_sf.html",
    "title": "Indicator Species Analysis",
    "section": "",
    "text": "viewof processjs = Inputs.radio(\n  new Map([\n    [\"Anaerobic Digester Influent\", \"AD\"], \n    [\"Activated Sludge\", \"AS\"], \n    [\"Effluent\", \"Eff\"], \n    [\"Influent\", \"Inf\"], \n    [\"Trickling Filter\", \"TF\"], \n    [\"Anaerobic Digester Effluent\", \"TSS\"], \n    [\"Waste Activated Sludge\", \"WAS\"]\n  ]),\n  {value: \"AD\", label: \"Select a Sampling Location:\"}\n)\n\n\n\n\n\n\n\ngenus = FileAttachment(\"indicator_data/indicator_genus_process.csv\").csv({typed: true})\n\ngenusProcess = genus.filter(function(table) {\n  return processjs == table.Process\n})\n\notu = FileAttachment(\"indicator_data/indicator_otu_season.csv\").csv({typed: true})\n\notuProcess = otu.filter(function(table) {\n  return processjs == table.Process\n})\n\notuProcessSeason = otuProcess.filter(function(table) {\n  return collocationsCat.includes(table.seasoncooccurrence)\n})\n\notuProcessSeason2 = otuProcess.filter(function(table) {\n  return collocationsCat == table.seasoncooccurrence\n})\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nAll Significant Indicator Genera in \n\nInputs.table(genusProcess)\n\n\n\n\n\n\n\n\nCo-occurence of Indicator OTUs by Season in \n\nurlad = FileAttachment('indicator_data/AD_euler.svg')\nurlas = FileAttachment('indicator_data/AS_euler.svg')\nurleff = FileAttachment('indicator_data/Eff_euler.svg')\nurlinf = FileAttachment('indicator_data/Inf_euler.svg')\nurltf = FileAttachment('indicator_data/TF_euler.svg')\nurltss = FileAttachment('indicator_data/TSS_euler.svg')\nurlwas = FileAttachment('indicator_data/WAS_euler.svg')\n\n{\n  if (processjs == \"AD\") {\n    return urlad.image()\n  } else if (processjs == \"AS\") {\n    return urlas.image()\n  } else if (processjs == \"Eff\") {\n    return urleff.image()\n  } else if (processjs == \"Inf\") {\n    return urlinf.image()\n  } else if (processjs == \"TF\") {\n    return urltf.image()\n  } else if (processjs == \"TSS\") {\n    return urltss.image()\n  } else if (processjs == \"WAS\") {\n    return urlwas.image()\n  }\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nviewof collocations = Inputs.checkbox([\"Fall\",\"Spring\",\"Summer\",\"Winter\"], {label: \"Select seasons to view OTUs:\"})\ncollocationsCat = collocations.join(\"-\")\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nExclusive listInclusive list\n\n\n\nInputs.table(otuProcessSeason2, {\n  header: {\n    pvalue: \"P value\",\n    seasoncooccurrence: \"Season Overlap\"\n  }\n})\n\n\n\n\n\n\n\n\n\nInputs.table(otuProcessSeason, {\n  header: {\n    pvalue: \"P value\",\n    seasoncooccurrence: \"Season Overlap\"\n  }\n})"
  }
]