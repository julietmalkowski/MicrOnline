<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.47">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>linear_regressions – Activated Sludge Model</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Activated Sludge Model</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./environmental_parameter_analysis.html"> 
<span class="menu-text">Environmental Parameter Analysis</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./correlation_matrix.html"> 
<span class="menu-text">Correlations</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./fourier_transform.html"> 
<span class="menu-text">Fourier Discrete Transform of Count Data</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./trend_decomposition.html"> 
<span class="menu-text">Decomposition of Trends</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./linear_regressions.html" aria-current="page"> 
<span class="menu-text">Linear Regressions on Input and Output Parameters</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#linear-regressions-on-input-and-output-parameters" id="toc-linear-regressions-on-input-and-output-parameters" class="nav-link active" data-scroll-target="#linear-regressions-on-input-and-output-parameters">Linear Regressions on Input and Output Parameters</a></li>
  <li><a href="#loading-data" id="toc-loading-data" class="nav-link" data-scroll-target="#loading-data">Loading Data</a></li>
  <li><a href="#connecting-metadata-and-otu-counts" id="toc-connecting-metadata-and-otu-counts" class="nav-link" data-scroll-target="#connecting-metadata-and-otu-counts">Connecting Metadata and OTU Counts</a></li>
  <li><a href="#effect-of-input-parameters-on-shannon-index" id="toc-effect-of-input-parameters-on-shannon-index" class="nav-link" data-scroll-target="#effect-of-input-parameters-on-shannon-index">Effect of Input Parameters on Shannon Index</a></li>
  <li><a href="#determine-most-important-input-parameters-based-on-relative-abundances" id="toc-determine-most-important-input-parameters-based-on-relative-abundances" class="nav-link" data-scroll-target="#determine-most-important-input-parameters-based-on-relative-abundances">Determine Most Important Input Parameters based on Relative Abundances</a></li>
  <li><a href="#effect-of-shannon-index-on-output-parameters-using-linear-regression" id="toc-effect-of-shannon-index-on-output-parameters-using-linear-regression" class="nav-link" data-scroll-target="#effect-of-shannon-index-on-output-parameters-using-linear-regression">Effect of Shannon Index on Output Parameters using Linear Regression</a></li>
  <li><a href="#otu-1-analysis" id="toc-otu-1-analysis" class="nav-link" data-scroll-target="#otu-1-analysis">OTU 1 Analysis</a></li>
  <li><a href="#comparing-a-general-linear-model-vs.-linear-model-for-input-parameters-on-otu-1" id="toc-comparing-a-general-linear-model-vs.-linear-model-for-input-parameters-on-otu-1" class="nav-link" data-scroll-target="#comparing-a-general-linear-model-vs.-linear-model-for-input-parameters-on-otu-1">Comparing a General Linear Model vs.&nbsp;Linear Model for Input Parameters on OTU 1</a></li>
  <li><a href="#conclusions" id="toc-conclusions" class="nav-link" data-scroll-target="#conclusions">Conclusions</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">




<section id="linear-regressions-on-input-and-output-parameters" class="level2">
<h2 class="anchored" data-anchor-id="linear-regressions-on-input-and-output-parameters">Linear Regressions on Input and Output Parameters</h2>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: permute</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: lattice</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>This is vegan 2.6-4</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: ape</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: nlme</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:nlme':

    collapse</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:ape':

    where</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
microbiome R package (microbiome.github.com)
    


 Copyright (C) 2011-2022 Leo Lahti, 
    Sudarshan Shetty et al. &lt;microbiome.github.io&gt;</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'microbiome'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:ggplot2':

    alpha</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:vegan':

    diversity</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:base':

    transform</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ forcats   1.0.0     ✔ readr     2.1.5
✔ lubridate 1.9.3     ✔ stringr   1.5.1
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ microbiome::alpha() masks ggplot2::alpha()
✖ dplyr::collapse()   masks nlme::collapse()
✖ dplyr::filter()     masks stats::filter()
✖ dplyr::lag()        masks stats::lag()
✖ dplyr::where()      masks ape::where()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors

Attaching package: 'reshape2'


The following object is masked from 'package:tidyr':

    smiths



Attaching package: 'ggpubr'


The following object is masked from 'package:ape':

    rotate</code></pre>
</div>
</div>
</section>
<section id="loading-data" class="level2">
<h2 class="anchored" data-anchor-id="loading-data">Loading Data</h2>
<p>Note: All Abundances have been filtered out to only contain relative abundances &gt; 0.01</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>otu_mat<span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"/Users/julietmalkowski/Desktop/Research/Kinetic_Model/abundance_table.xlsx"</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="co">#remove first 4 characters in every column name</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(otu_mat)<span class="ot">&lt;-</span> <span class="fu">substr</span>(<span class="fu">colnames</span>(otu_mat), <span class="dv">5</span>, <span class="fu">nchar</span>(<span class="fu">colnames</span>(otu_mat)))</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>otu_mat <span class="ot">=</span> <span class="fu">as.data.frame</span>(otu_mat)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="co">#split first column by character '_' into two seperate columns</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>otu_mat[<span class="fu">c</span>(<span class="st">'Process'</span>, <span class="st">'Date'</span>)] <span class="ot">&lt;-</span> <span class="fu">str_split_fixed</span>(otu_mat<span class="sc">$</span>le, <span class="st">'_'</span>, <span class="dv">2</span>)</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="co">#drop le column</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>otu_mat <span class="ot">=</span> otu_mat[,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="co">#move last two columns to the front</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>otu_mat <span class="ot">&lt;-</span> otu_mat <span class="sc">%&gt;%</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Process, <span class="fu">everything</span>())</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>otu_mat <span class="ot">&lt;-</span> otu_mat <span class="sc">%&gt;%</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Date, <span class="fu">everything</span>())</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a><span class="co">#filter otu_mat to only contain AS-1 and AS-2 in process column</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>otu_mat <span class="ot">&lt;-</span> otu_mat <span class="sc">%&gt;%</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Process <span class="sc">==</span> <span class="st">"AS-1"</span> <span class="sc">|</span> Process <span class="sc">==</span> <span class="st">"AS-2"</span>)</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a><span class="co">#remove Process column</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>otu_mat <span class="ot">=</span> otu_mat[,<span class="sc">-</span><span class="dv">2</span>]</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a><span class="co">#groupby date and find the mean of each column</span></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>otu_counts <span class="ot">&lt;-</span> otu_mat <span class="sc">%&gt;%</span></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Date) <span class="sc">%&gt;%</span></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(mean)</span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>otu_p <span class="ot">=</span> otu_counts</span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a><span class="co">#find the sum of each row</span></span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>otu_p<span class="sc">$</span>sum <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(otu_p[,<span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a><span class="co">#divide each row by the sum</span></span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>otu_p[,<span class="sc">-</span><span class="dv">1</span>] <span class="ot">&lt;-</span> otu_p[,<span class="sc">-</span><span class="dv">1</span>] <span class="sc">/</span> otu_p<span class="sc">$</span>sum</span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a><span class="co">#remove sum column</span></span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a>otu_p <span class="ot">=</span> otu_p[,<span class="sc">-</span><span class="fu">ncol</span>(otu_p)]</span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a><span class="co">#make otu_p from wide form to long form</span></span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a>otu_p <span class="ot">&lt;-</span> otu_p <span class="sc">%&gt;%</span></span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>Date, <span class="at">names_to =</span> <span class="st">"OTU"</span>, <span class="at">values_to =</span> <span class="st">"Abundance"</span>)</span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a><span class="co">#filter out rows with an Abundance less than 0.01</span></span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a>otu_p <span class="ot">&lt;-</span> otu_p <span class="sc">%&gt;%</span></span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Abundance <span class="sc">&gt;=</span> <span class="fl">0.01</span>)</span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a><span class="co">#calculate Shannon Index and add it to otu_p column</span></span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a>shannon <span class="ot">=</span> <span class="cf">function</span>(x) {</span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a>  <span class="sc">-</span><span class="fu">sum</span>(x <span class="sc">*</span> <span class="fu">log</span>(x))</span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a>otu_shannon <span class="ot">=</span> otu_p</span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a>s <span class="ot">=</span> otu_shannon <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Date) <span class="sc">%&gt;%</span></span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Shannon =</span> <span class="fu">shannon</span>(Abundance))</span>
<span id="cb17-43"><a href="#cb17-43" aria-hidden="true" tabindex="-1"></a>otu_shannon <span class="ot">=</span> <span class="fu">merge</span>(otu_shannon, s, <span class="at">by =</span> <span class="st">"Date"</span>)</span>
<span id="cb17-44"><a href="#cb17-44" aria-hidden="true" tabindex="-1"></a>output_metadata <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"/Users/julietmalkowski/Desktop/Research/Kinetic_Model/AS_metadata.xlsx"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>New names:
• `` -&gt; `...1`</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>output_metadata <span class="ot">=</span> <span class="fu">as.data.frame</span>(output_metadata)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co">#input parameters</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>input_metadata <span class="ot">=</span> output_metadata</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>input_metadata <span class="ot">=</span> input_metadata[,<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">10</span>,<span class="dv">12</span>,<span class="dv">14</span>,<span class="dv">16</span>,<span class="dv">18</span>,<span class="dv">20</span>)]</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>input_data <span class="ot">=</span> input_metadata</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>input_data <span class="ot">=</span> <span class="fu">merge</span>(otu_shannon, input_metadata, <span class="at">by =</span> <span class="st">"Date"</span>)</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="co">#output parameters</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>output_metadata <span class="ot">=</span> output_metadata[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span><span class="sc">:</span><span class="dv">8</span>,<span class="dv">10</span>,<span class="dv">12</span>,<span class="dv">14</span><span class="sc">:</span><span class="dv">20</span>)]</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>output_data <span class="ot">=</span> <span class="fu">merge</span>(otu_shannon, output_metadata, <span class="at">by =</span> <span class="st">"Date"</span>)</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a><span class="co">#change column 6 name</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(output_data)[<span class="dv">6</span>] <span class="ot">&lt;-</span> <span class="st">"BOD_CBOD_Load_Removed"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="connecting-metadata-and-otu-counts" class="level2">
<h2 class="anchored" data-anchor-id="connecting-metadata-and-otu-counts">Connecting Metadata and OTU Counts</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>output_metadata <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"/Users/julietmalkowski/Desktop/Research/Kinetic_Model/AS_metadata.xlsx"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>New names:
• `` -&gt; `...1`</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>output_metadata <span class="ot">=</span> <span class="fu">as.data.frame</span>(output_metadata)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="co">#input parameters</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>input_metadata <span class="ot">=</span> output_metadata</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>input_metadata <span class="ot">=</span> input_metadata[,<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">10</span>,<span class="dv">12</span>,<span class="dv">14</span>,<span class="dv">16</span>,<span class="dv">18</span>,<span class="dv">20</span>)]</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>input_data <span class="ot">=</span> input_metadata</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>input_data <span class="ot">=</span> <span class="fu">merge</span>(otu_shannon, input_metadata, <span class="at">by =</span> <span class="st">"Date"</span>)</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(input_data)[<span class="dv">8</span>] <span class="ot">&lt;-</span> <span class="st">"BOD_CBOD_Load_PE"</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="co">#output parameters</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>output_metadata <span class="ot">=</span> output_metadata[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span><span class="sc">:</span><span class="dv">8</span>,<span class="dv">10</span>,<span class="dv">12</span>,<span class="dv">14</span><span class="sc">:</span><span class="dv">20</span>)]</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>output_data <span class="ot">=</span> <span class="fu">merge</span>(otu_shannon, output_metadata, <span class="at">by =</span> <span class="st">"Date"</span>)</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a><span class="co">#change column 6 name</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(output_data)[<span class="dv">6</span>] <span class="ot">&lt;-</span> <span class="st">"BOD_CBOD_Load_Removed"</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a><span class="co">#remove column in output_data</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>input_data_ <span class="ot">=</span> input_data[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>)]</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>input_data_ <span class="ot">=</span> <span class="fu">as.data.frame</span>(input_data_)</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a><span class="co">#remove duplicates</span></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>input_data_ <span class="ot">=</span> input_data_[<span class="sc">!</span><span class="fu">duplicated</span>(input_data_[,<span class="dv">1</span>]),]</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a><span class="co">#make first column rownames in output_data_</span></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(input_data_) <span class="ot">&lt;-</span> input_data_[,<span class="dv">1</span>]</span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a><span class="co">#remove first column</span></span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>input_data_ <span class="ot">=</span> input_data_[,<span class="sc">-</span><span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="effect-of-input-parameters-on-shannon-index" class="level2">
<h2 class="anchored" data-anchor-id="effect-of-input-parameters-on-shannon-index">Effect of Input Parameters on Shannon Index</h2>
<p>Using a multiple linear regression I will briefly assume our variables have a normal distribution of residuals and are linear</p>
<p>Notation for plots:</p>
<p>Plot 1- distribution of residuals according to values predicted by linear regression model- each point represents the distance between the response variable and the model prediction- we need a uniform distribution of the residual. For this plot we need a uniform distribution of the residuals- the homoscedasticity condition. This condition states that if the residuals form an approximate horizontal band around the 0 line, the variance of the residuals is homogeneous.</p>
<p>Plot 2- checks if the dispersion of residuals is caused by the explanatory variable- if the dispersion increases then it means the variances in each group are different</p>
<p>Plot 3- this plot shows the distribution of residuals in a quantile- quantile plot which evaluated the normality of the residuals. This plot compares the probability distribution of normal data and standardized residuals can be seen near the 1:1 line</p>
<p>Plot 4- shows the residuals and their influence- the location of points with strong influence can influence the interpretation of the data. If one or more observations are outliers then the model may be misfitted because of their exaggerated influence. A distance greater than 0.5 is problematic</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co">#create multiple linear regression</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>lm.mult <span class="ot">&lt;-</span> <span class="fu">lm</span>(Shannon <span class="sc">~</span> pH_RSS <span class="sc">+</span> temp_RSS <span class="sc">+</span> BOD_CBOD_Load_PE <span class="sc">+</span> COD_Load_PE <span class="sc">+</span> Ammonia_Load_RAW <span class="sc">+</span> TKN_Load_RAW <span class="sc">+</span> P_Load_PE <span class="sc">+</span> SCT_Detention_Time, <span class="at">data =</span> input_data)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm.mult)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Shannon ~ pH_RSS + temp_RSS + BOD_CBOD_Load_PE + 
    COD_Load_PE + Ammonia_Load_RAW + TKN_Load_RAW + P_Load_PE + 
    SCT_Detention_Time, data = input_data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.34785 -0.09712 -0.01016  0.09621  0.24081 

Coefficients:
                     Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)         7.029e+00  7.191e-01   9.774  &lt; 2e-16 ***
pH_RSS             -7.538e-01  9.354e-02  -8.059 3.07e-15 ***
temp_RSS            5.310e-03  2.843e-03   1.868   0.0622 .  
BOD_CBOD_Load_PE   -3.662e-03  7.574e-04  -4.835 1.62e-06 ***
COD_Load_PE        -8.535e-05  5.977e-04  -0.143   0.8865    
Ammonia_Load_RAW    1.744e-02  8.422e-03   2.071   0.0387 *  
TKN_Load_RAW        5.030e-03  5.600e-03   0.898   0.3694    
P_Load_PE          -6.895e-01  6.578e-02 -10.482  &lt; 2e-16 ***
SCT_Detention_Time  4.037e-01  2.272e-02  17.768  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.13 on 743 degrees of freedom
Multiple R-squared:  0.5613,    Adjusted R-squared:  0.5566 
F-statistic: 118.8 on 8 and 743 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="fl">3.9</span>, <span class="dv">4</span>, <span class="fl">1.2</span>, <span class="fl">1.1</span>), <span class="at">oma =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>,</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>                                                        <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lm.mult)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="linear_regressions_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>As can be seen above, the results from each plot do not meet the assumptions of linear regression. The residuals are not homoscedastic, the residuals are not normally distributed, and there are outliers that are influencing the model.</p>
<p>Significant values include pH_RSS, BOD_CBOD_Load_PE,Ammonia_Load_RAW, P_Load_PE, and SCT_Detention_Time. To fix this data run now with only significant values</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>lm.mult2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Shannon <span class="sc">~</span> pH_RSS <span class="sc">+</span> BOD_CBOD_Load_PE <span class="sc">+</span> Ammonia_Load_RAW <span class="sc">+</span> P_Load_PE <span class="sc">+</span> SCT_Detention_Time, <span class="at">data =</span> input_data)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm.mult2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Shannon ~ pH_RSS + BOD_CBOD_Load_PE + Ammonia_Load_RAW + 
    P_Load_PE + SCT_Detention_Time, data = input_data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.32219 -0.09688 -0.01303  0.08360  0.23466 

Coefficients:
                     Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)         7.0131513  0.6862416  10.220  &lt; 2e-16 ***
pH_RSS             -0.7265873  0.0904217  -8.036 3.64e-15 ***
BOD_CBOD_Load_PE   -0.0036932  0.0007406  -4.987 7.65e-07 ***
Ammonia_Load_RAW    0.0124405  0.0081474   1.527    0.127    
P_Load_PE          -0.6479527  0.0629724 -10.289  &lt; 2e-16 ***
SCT_Detention_Time  0.3780273  0.0191689  19.721  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.1304 on 746 degrees of freedom
Multiple R-squared:  0.5566,    Adjusted R-squared:  0.5536 
F-statistic: 187.3 on 5 and 746 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="fl">3.9</span>, <span class="dv">4</span>, <span class="fl">1.2</span>, <span class="fl">1.1</span>), <span class="at">oma =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>,</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>                                                        <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lm.mult2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="linear_regressions_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Now we see slightly better results with Ammonia Loading no longer being relevant</p>
</section>
<section id="determine-most-important-input-parameters-based-on-relative-abundances" class="level2">
<h2 class="anchored" data-anchor-id="determine-most-important-input-parameters-based-on-relative-abundances">Determine Most Important Input Parameters based on Relative Abundances</h2>
<p>Using Redundancy Analysis</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>otu_p_wide <span class="ot">&lt;-</span> otu_p <span class="sc">%&gt;%</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> OTU, <span class="at">values_from =</span> Abundance) <span class="sc">%&gt;%</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">replace</span>(<span class="fu">is.na</span>(.), <span class="dv">0</span>)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>otu_p_wide <span class="ot">=</span> <span class="fu">as.data.frame</span>(otu_p_wide)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="co">#make first column rownames in output_data_</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(otu_p_wide) <span class="ot">&lt;-</span> otu_p_wide[,<span class="dv">1</span>]</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="co">#remove first column</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>otu_p_wide <span class="ot">=</span> otu_p_wide[,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>as_metadata_input.z <span class="ot">&lt;-</span> <span class="fu">decostand</span>(input_data_, <span class="at">method =</span> <span class="st">"standardize"</span>)</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>as_metadata_input.rda <span class="ot">&lt;-</span> <span class="fu">rda</span>(otu_p_wide  <span class="sc">~</span> ., <span class="at">data =</span> as_metadata_input.z)</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(as_metadata_input.rda)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
rda(formula = otu_p_wide ~ Alkalinity_PE + pH_RSS + temp_RSS +      BOD_CBOD_Load_PE + COD_Load_PE + Ammonia_Load_RAW + TKN_Load_RAW +      P_Load_PE + SCT_Detention_Time, data = as_metadata_input.z) 

Partitioning of variance:
                Inertia Proportion
Total         0.0020490     1.0000
Constrained   0.0007414     0.3618
Unconstrained 0.0013077     0.6382

Eigenvalues, and their contribution to the variance 

Importance of components:
                           RDA1      RDA2      RDA3      RDA4      RDA5
Eigenvalue            0.0004567 9.623e-05 8.094e-05 3.454e-05 2.552e-05
Proportion Explained  0.2229099 4.696e-02 3.950e-02 1.686e-02 1.245e-02
Cumulative Proportion 0.2229099 2.699e-01 3.094e-01 3.262e-01 3.387e-01
                           RDA6      RDA7      RDA8      RDA9       PC1
Eigenvalue            1.672e-05 1.461e-05 9.520e-06 6.551e-06 0.0003051
Proportion Explained  8.159e-03 7.128e-03 4.646e-03 3.197e-03 0.1489076
Cumulative Proportion 3.468e-01 3.540e-01 3.586e-01 3.618e-01 0.5107239
                            PC2       PC3       PC4       PC5       PC6
Eigenvalue            0.0002093 0.0001438 9.745e-05 8.892e-05 6.769e-05
Proportion Explained  0.1021287 0.0701975 4.756e-02 4.340e-02 3.303e-02
Cumulative Proportion 0.6128526 0.6830501 7.306e-01 7.740e-01 8.070e-01
                            PC7       PC8       PC9      PC10      PC11
Eigenvalue            5.253e-05 4.563e-05 3.281e-05 3.079e-05 2.581e-05
Proportion Explained  2.563e-02 2.227e-02 1.601e-02 1.503e-02 1.260e-02
Cumulative Proportion 8.327e-01 8.549e-01 8.710e-01 8.860e-01 8.986e-01
                           PC12      PC13      PC14      PC15      PC16
Eigenvalue            0.0000208 1.871e-05 1.785e-05 1.684e-05 1.527e-05
Proportion Explained  0.0101497 9.129e-03 8.712e-03 8.221e-03 7.450e-03
Cumulative Proportion 0.9087313 9.179e-01 9.266e-01 9.348e-01 9.422e-01
                           PC17      PC18      PC19      PC20      PC21
Eigenvalue            0.0000137 1.169e-05 1.042e-05 9.267e-06 7.863e-06
Proportion Explained  0.0066848 5.707e-03 5.084e-03 4.523e-03 3.838e-03
Cumulative Proportion 0.9489274 9.546e-01 9.597e-01 9.642e-01 9.681e-01
                           PC22      PC23      PC24      PC25      PC26
Eigenvalue            7.049e-06 6.814e-06 5.908e-06 5.079e-06 4.736e-06
Proportion Explained  3.440e-03 3.325e-03 2.883e-03 2.479e-03 2.311e-03
Cumulative Proportion 9.715e-01 9.748e-01 9.777e-01 9.802e-01 9.825e-01
                           PC27      PC28      PC29      PC30      PC31
Eigenvalue            4.181e-06 3.910e-06 3.338e-06 3.092e-06 2.807e-06
Proportion Explained  2.041e-03 1.908e-03 1.629e-03 1.509e-03 1.370e-03
Cumulative Proportion 9.846e-01 9.865e-01 9.881e-01 9.896e-01 9.910e-01
                           PC32      PC33      PC34      PC35      PC36
Eigenvalue            2.398e-06 2.299e-06 2.187e-06 1.971e-06 1.635e-06
Proportion Explained  1.170e-03 1.122e-03 1.067e-03 9.620e-04 7.978e-04
Cumulative Proportion 9.921e-01 9.933e-01 9.943e-01 9.953e-01 9.961e-01
                           PC37      PC38      PC39      PC40      PC41
Eigenvalue            1.262e-06 1.029e-06 9.559e-07 9.307e-07 8.006e-07
Proportion Explained  6.157e-04 5.024e-04 4.665e-04 4.542e-04 3.907e-04
Cumulative Proportion 9.967e-01 9.972e-01 9.977e-01 9.981e-01 9.985e-01
                           PC42      PC43      PC44      PC45      PC46
Eigenvalue            6.290e-07 6.075e-07 4.502e-07 4.388e-07 3.076e-07
Proportion Explained  3.070e-04 2.965e-04 2.197e-04 2.142e-04 1.501e-04
Cumulative Proportion 9.988e-01 9.991e-01 9.993e-01 9.996e-01 9.997e-01
                           PC47      PC48      PC49      PC50      PC51
Eigenvalue            2.483e-07 1.914e-07 8.336e-08 5.487e-08 1.584e-08
Proportion Explained  1.212e-04 9.343e-05 4.068e-05 2.678e-05 7.730e-06
Cumulative Proportion 9.998e-01 9.999e-01 1.000e+00 1.000e+00 1.000e+00

Accumulated constrained eigenvalues
Importance of components:
                           RDA1      RDA2      RDA3      RDA4      RDA5
Eigenvalue            0.0004567 9.623e-05 8.094e-05 3.454e-05 2.552e-05
Proportion Explained  0.6160857 1.298e-01 1.092e-01 4.659e-02 3.442e-02
Cumulative Proportion 0.6160857 7.459e-01 8.551e-01 9.016e-01 9.361e-01
                           RDA6      RDA7      RDA8      RDA9
Eigenvalue            1.672e-05 1.461e-05 9.520e-06 6.551e-06
Proportion Explained  2.255e-02 1.970e-02 1.284e-02 8.837e-03
Cumulative Proportion 9.586e-01 9.783e-01 9.912e-01 1.000e+00

Scaling 2 for species and site scores
* Species are scaled proportional to eigenvalues
* Sites are unscaled: weighted dispersion equal on all dimensions
* General scaling constant of scores:  0.6441055 


Species scores

            RDA1       RDA2       RDA3       RDA4       RDA5       RDA6
4     -1.484e-01  3.090e-02 -0.0050982 -3.296e-02 -0.0294149 -0.0121206
1     -1.168e-01 -9.849e-02 -0.0055868  4.390e-03 -0.0039299 -0.0094571
17    -5.822e-03  6.112e-03  0.0127195 -1.251e-02  0.0013987 -0.0047666
16    -6.226e-02  8.540e-03 -0.0070388  3.457e-03  0.0245886  0.0002516
127   -1.734e-02  6.361e-03  0.0113719 -2.252e-02  0.0107304 -0.0053450
85    -4.149e-02 -5.596e-04  0.0148932 -5.536e-03  0.0064538  0.0011092
13    -1.598e-02 -4.212e-02  0.0205729 -1.416e-02  0.0287380  0.0015430
14286 -1.275e-01  7.339e-03 -0.0147422 -2.165e-03  0.0198831 -0.0001481
6      2.034e-03  2.591e-02 -0.0190691  3.891e-02  0.0127999 -0.0168985
12    -2.057e-02 -9.842e-03 -0.0334978  7.996e-03  0.0039737  0.0055124
298   -2.933e-02  9.065e-04 -0.0028820  3.509e-03  0.0144055 -0.0016473
459   -8.897e-03  4.791e-03  0.0072549 -2.102e-02  0.0006136 -0.0039595
94    -2.834e-03  1.704e-03  0.0025247 -5.851e-03  0.0018248 -0.0017378
2      1.403e-01 -1.458e-02 -0.0718411 -3.043e-02 -0.0002358 -0.0143914
11    -2.295e-02 -7.710e-03 -0.0336463  1.112e-02 -0.0060840 -0.0034856
15    -2.479e-02 -1.768e-02  0.0101867  1.564e-03 -0.0155440 -0.0097085
174   -2.124e-03  4.811e-04  0.0012431 -6.628e-03 -0.0007482 -0.0014685
125   -1.587e-02  3.465e-03 -0.0052040  5.621e-03 -0.0070851 -0.0001908
19    -3.875e-03  2.202e-03 -0.0010704  4.319e-03  0.0019830 -0.0011110
26    -2.744e-03  1.559e-03 -0.0007580  3.059e-03  0.0014043 -0.0007868
7      5.366e-02 -4.162e-02  0.0142327  8.610e-03  0.0019159 -0.0076274
20    -2.882e-03  1.638e-03 -0.0007961  3.212e-03  0.0014749 -0.0008264
403   -4.095e-03  2.327e-03 -0.0011313  4.565e-03  0.0020959 -0.0011743
40    -1.613e-03 -2.317e-04  0.0006030  3.658e-03  0.0025899 -0.0034192
30    -2.441e-03  1.387e-03 -0.0006742  2.721e-03  0.0012491 -0.0006998
46    -1.454e-03 -2.100e-03  0.0049180  3.948e-03 -0.0011260 -0.0043365
41     1.090e-02  1.950e-04 -0.0040214  1.773e-04  0.0032269  0.0103801
1961  -8.590e-03  4.881e-03 -0.0023731  9.576e-03  0.0043964 -0.0024633
10    -4.757e-03  2.703e-03 -0.0013142  5.303e-03  0.0024346 -0.0013641
21    -2.618e-02 -1.739e-02 -0.0130215  1.791e-02 -0.0248171  0.0243984
35    -5.310e-02 -1.254e-02 -0.0653972  1.005e-02 -0.0018110  0.0040455
37    -9.635e-03  2.433e-03 -0.0056075  6.068e-03  0.0054071  0.0040337
5      4.046e-02 -3.084e-02  0.0125557 -9.008e-03 -0.0061767  0.0123520
45    -1.080e-02  4.176e-03 -0.0055712  3.163e-04  0.0080848  0.0093179
100   -1.534e-02  1.189e-02 -0.0063364 -6.609e-03  0.0189663  0.0159989
136   -8.213e-03  3.768e-03 -0.0071677 -3.396e-03  0.0080643  0.0029121
14     1.877e-02 -3.409e-02  0.0004510 -1.850e-02  0.0081492  0.0112859
14008 -7.336e-03  7.291e-03 -0.0053579 -7.933e-03  0.0104536  0.0059018
73    -4.838e-03  1.740e-04 -0.0113383 -6.290e-03  0.0059769 -0.0076001
927   -1.240e-03  6.860e-04 -0.0023403 -1.613e-03  0.0015373 -0.0015971
672   -5.523e-03 -1.246e-04 -0.0128653 -6.871e-03  0.0067759 -0.0087624
28     1.088e-03 -4.874e-04  0.0014399  1.043e-03  0.0022430 -0.0029256
31     1.510e-02 -5.851e-03  0.0047306  8.255e-03  0.0047022 -0.0222871
9      4.506e-02 -2.672e-02  0.0185888  7.129e-03 -0.0016880 -0.0071579
56     1.424e-03 -1.960e-03  0.0014444  2.769e-04  0.0010398 -0.0025552
25     2.068e-03 -1.821e-03  0.0010852  3.471e-04  0.0026355 -0.0019095
54     2.033e-03  6.972e-04 -0.0000213 -5.585e-04 -0.0026292  0.0006898
53     2.173e-03 -2.742e-04 -0.0003528 -1.046e-03 -0.0029482  0.0007787
88     8.325e-03 -1.398e-03 -0.0025465  1.474e-05 -0.0017298  0.0059349
71     1.156e-02 -1.180e-03 -0.0039665 -6.243e-04 -0.0012595  0.0090493
59     6.010e-03  1.747e-03 -0.0026778  1.620e-03  0.0019395  0.0039623
70     5.363e-03  7.783e-03 -0.0004332 -1.134e-03 -0.0023000  0.0044192
232    2.574e-03 -4.472e-05 -0.0012042  2.563e-04 -0.0004036  0.0014342
49     4.019e-03 -6.982e-05 -0.0018803  4.001e-04 -0.0006301  0.0022394
887    3.076e-03  7.825e-04 -0.0016638 -5.093e-04  0.0012543  0.0027233
7950   5.787e-03  2.941e-03  0.0171344  1.303e-02 -0.0005213 -0.0044124
317    4.419e-03 -3.487e-03 -0.0018385  3.433e-03  0.0016337 -0.0018051
52     4.993e-05 -3.521e-04  0.0026868  1.932e-03 -0.0012700 -0.0032572
195   -1.925e-03  2.612e-03  0.0184982  5.572e-03 -0.0011342 -0.0031638
13420 -3.042e-03  3.970e-03  0.0274010  7.841e-03 -0.0028981 -0.0047656


Site scores (weighted sums of species scores)

                RDA1      RDA2       RDA3       RDA4      RDA5      RDA6
01/05/2023 -0.044332  0.039803  0.1603128 -1.120e-01  0.227080  0.138215
01/10/2023 -0.104218  0.051986  0.0919001 -6.323e-02  0.211975  0.025668
01/12/2023 -0.057581  0.049294  0.1389909 -6.767e-02  0.220521  0.066886
01/17/2023 -0.079461  0.029977  0.1258125 -6.291e-02  0.210276  0.021795
01/19/2023 -0.070179  0.022398  0.1167927 -6.289e-02  0.232073  0.033817
01/24/2023 -0.127200 -0.042819  0.1347052 -2.212e-01 -0.040433 -0.114437
01/26/2023 -0.063993  0.063893  0.1519833 -2.021e-01  0.056602 -0.021465
01/31/2023 -0.016771  0.061931  0.1013677 -1.722e-01  0.065303 -0.030163
02/02/2023 -0.038087  0.042543  0.0905954 -2.640e-01 -0.100984 -0.032096
02/09/2023 -0.062293  0.022299  0.0425287 -1.585e-01 -0.176893 -0.042878
02/14/2023 -0.082160  0.054797  0.0948477 -9.805e-02 -0.164470 -0.025018
02/16/2023 -0.153467  0.013625  0.0848363 -2.829e-01 -0.490452 -0.209713
02/21/2023 -0.075001  0.037779  0.0688530  2.428e-08 -0.035349  0.054166
02/23/2023 -0.082696  0.036185  0.0804628 -2.959e-02 -0.055768  0.049731
02/28/2023  0.016703  0.020037  0.1428518  2.037e-01  0.178847  0.099874
03/02/2023 -0.108629 -0.039138  0.1130902 -1.156e-01 -0.038802  0.011633
03/07/2023 -0.099523 -0.052156  0.0921935 -4.437e-02 -0.018131  0.125303
03/09/2023 -0.095406 -0.109996  0.0629184  3.643e-02  0.039652  0.211967
03/14/2023 -0.121086 -0.103696  0.0419287  2.710e-02 -0.060889  0.151558
03/16/2023 -0.109355 -0.132485  0.0084090  1.390e-01 -0.102474  0.140386
03/21/2023 -0.115008 -0.051994 -0.0547739  1.523e-01 -0.198913  0.007137
03/23/2023 -0.125776 -0.089042 -0.1001058  7.293e-02 -0.226634 -0.143390
03/28/2023 -0.166155 -0.137213 -0.1161482 -4.141e-02 -0.494360 -0.235732
03/30/2023 -0.091011 -0.071072 -0.1621751  1.787e-01 -0.202894 -0.047585
04/04/2023 -0.137417 -0.028282 -0.0715943  3.518e-02 -0.116718 -0.034686
04/06/2023 -0.112653 -0.102890 -0.0756855  1.300e-01 -0.129844 -0.054537
04/11/2023 -0.092078 -0.045877 -0.0660336  1.703e-01 -0.205623  0.040192
04/13/2023 -0.087396 -0.053750 -0.0608553  2.195e-01 -0.150221  0.020638
04/18/2023 -0.036282  0.054688 -0.1324476  1.641e-01  0.168836  0.068046
04/20/2023 -0.026993  0.106783 -0.1366555  1.382e-01  0.180101  0.041378
04/25/2023 -0.019629  0.125100 -0.1356224  9.264e-02  0.267134  0.169687
04/27/2023  0.007099  0.105129 -0.1416835  1.062e-01  0.357895  0.217738
05/02/2023 -0.008631  0.097506 -0.1896097  5.313e-03  0.238108  0.030708
05/04/2023 -0.023407  0.037166 -0.2051270 -1.217e-02  0.181446 -0.010955
05/09/2023 -0.002533  0.071777 -0.2377179 -5.314e-02  0.151931 -0.157850
05/11/2023 -0.032368 -0.045305 -0.2320074 -1.382e-01 -0.002761 -0.278395
05/16/2023 -0.020475 -0.028580 -0.1599337 -1.504e-01  0.193087  0.043670
05/18/2023 -0.032621 -0.112371 -0.1352353 -1.842e-01  0.131097 -0.032630
05/23/2023  0.033913 -0.012800 -0.1460927 -3.342e-02  0.172359  0.070801
05/25/2023  0.029254 -0.041311 -0.1616610 -2.514e-02  0.156778  0.028596
06/22/2022 -0.054355 -0.487803  0.0279337  3.614e-01  0.061984 -0.546964
06/28/2022  0.050111 -0.190162  0.0858607  1.004e-01 -0.005679 -0.181180
06/30/2022  0.041786 -0.273615  0.0842355 -2.813e-02 -0.023146 -0.060791
07/05/2022  0.095454 -0.176598  0.0245737 -1.248e-01 -0.041410  0.083752
07/07/2022  0.058890 -0.272602  0.0465099 -1.768e-02  0.002363 -0.048858
07/12/2022  0.088261 -0.155167  0.0395778 -3.842e-02 -0.067226  0.025248
07/14/2022  0.095836 -0.135393  0.0123680 -3.683e-02 -0.039080  0.003670
07/19/2022  0.042582 -0.028842 -0.0066997  1.759e-01 -0.036216 -0.202878
07/21/2022  0.068972 -0.106905  0.0452142 -3.360e-02 -0.129310  0.023044
07/26/2022  0.065258 -0.048507  0.0632965 -3.633e-02 -0.024697  0.215095
07/28/2022  0.074972 -0.100825  0.0329295 -5.362e-02 -0.048124  0.135876
08/02/2022  0.089560 -0.021833  0.0331787 -5.875e-02  0.012036  0.210960
08/04/2022  0.071412 -0.085560  0.0236012 -2.195e-02 -0.061061  0.267818
08/09/2022  0.099269  0.007761  0.0064758 -2.016e-02 -0.028364  0.194445
08/11/2022  0.091439 -0.001371  0.0181899  2.412e-02 -0.063119  0.089530
08/16/2022  0.099974 -0.035507  0.0848827 -2.709e-02  0.013346  0.193868
08/18/2022  0.094854 -0.040156  0.0799074 -1.714e-02 -0.051800  0.240693
08/23/2022  0.038942  0.075964  0.0127290 -4.558e-04 -0.165216  0.116812
08/25/2022  0.078352  0.079100 -0.0262500  3.295e-02 -0.054810  0.063432
08/30/2022  0.083986  0.099716 -0.0205894  2.536e-02 -0.038742  0.024547
09/01/2022  0.081468 -0.178027 -0.0022599  5.080e-02  0.088547 -0.085627
09/06/2022  0.118037  0.156025 -0.0306270  9.973e-02 -0.013854 -0.062345
09/13/2022  0.123140 -0.016350 -0.0035984 -5.427e-02  0.076624 -0.075698
09/15/2022  0.053271  0.104600 -0.0953082 -5.637e-02 -0.047910 -0.055119
09/20/2022  0.108175 -0.016731 -0.0044633 -7.635e-02  0.001632 -0.001331
09/22/2022  0.118178 -0.059281  0.0081880 -8.341e-03  0.085378 -0.193548
09/27/2022  0.106216 -0.018001  0.0207257  4.499e-02  0.085619 -0.174770
09/29/2022  0.061645  0.080316 -0.0239780 -4.041e-03  0.080145  0.055993
10/20/2022  0.095540  0.145534 -0.1292370  5.544e-02  0.039805 -0.012923
10/25/2022  0.078841  0.160003 -0.1311252  9.908e-02 -0.036869 -0.202033
10/27/2022  0.064533  0.101404 -0.1076118  7.129e-03 -0.139987 -0.113497
11/01/2022  0.050481  0.172283 -0.0288497 -6.800e-02 -0.160088 -0.092928
11/03/2022  0.044778  0.169576 -0.0356979 -6.504e-02 -0.169990 -0.119539
11/08/2022  0.064076  0.191128  0.0134319  8.516e-02  0.133078  0.073284
11/10/2022  0.061612  0.130850 -0.0004734  5.800e-02  0.051373  0.040617
11/15/2022  0.038762  0.194617  0.0072703 -2.030e-02  0.039452  0.001369
11/17/2022 -0.018437  0.090326  0.0212247 -1.358e-01 -0.067826 -0.031505
11/22/2022 -0.022044  0.056334 -0.0241294 -6.278e-02  0.005518 -0.009491
11/24/2022 -0.018642  0.085509 -0.0262999 -7.077e-02  0.036849 -0.038391
11/28/2022  0.076336 -0.002401  0.0419880  2.032e-01  0.096367 -0.176623
12/01/2022 -0.004757  0.125568  0.0139582  4.614e-02  0.105614 -0.024609
12/06/2022  0.001236  0.076329  0.0873335  4.201e-02  0.010527  0.005127
12/08/2022 -0.016119  0.097731  0.1302587  1.033e-01  0.004862  0.025923
12/13/2022  0.014336  0.113729  0.2525657  1.706e-01 -0.109112  0.023022
12/15/2022 -0.021317  0.093317  0.1545742  7.490e-02 -0.035972 -0.001537


Site constraints (linear combinations of constraining variables)

                 RDA1       RDA2       RDA3       RDA4       RDA5      RDA6
01/05/2023 -0.0693321  0.0067499  0.0220236 -0.0134326  1.899e-02 -0.027598
01/10/2023 -0.0708957 -0.0423755  0.0239172  0.0048296  5.317e-02 -0.034485
01/12/2023 -0.0630434 -0.0137013  0.0692859 -0.0336703  4.427e-03  0.020861
01/17/2023 -0.0724244  0.0076429  0.0788273  0.0049157  2.080e-01  0.068041
01/19/2023 -0.0875322 -0.0282422  0.0800134 -0.0670843  3.558e-02  0.070483
01/24/2023 -0.0620905  0.0215528  0.0243462  0.0137173  9.843e-02  0.009916
01/26/2023 -0.0448802  0.0721557  0.0346808 -0.1447609  4.869e-02 -0.052557
01/31/2023 -0.0490884  0.0380150  0.0270012 -0.1185508  1.616e-02 -0.064210
02/02/2023 -0.0608257  0.0378851  0.0154651 -0.1865598 -6.566e-02 -0.090844
02/09/2023 -0.0597949  0.0321957  0.0953890 -0.1718965  3.535e-05  0.028692
02/14/2023 -0.0597248  0.0279471  0.0688756 -0.1071445  5.293e-02 -0.004646
02/16/2023 -0.0569624  0.0129000  0.0333330 -0.1777278 -2.006e-02 -0.039378
02/21/2023 -0.0461010  0.0669957  0.0346990 -0.1421503  7.340e-02 -0.053189
02/23/2023 -0.1034136  0.0091412 -0.0056966  0.0478744 -5.107e-02  0.040223
02/28/2023 -0.0948288  0.0538859 -0.0261970  0.1057091  4.853e-02 -0.027192
03/02/2023 -0.0805280  0.0886228  0.0426374  0.0510123 -5.892e-02  0.063416
03/07/2023 -0.1005708 -0.0375094  0.0200130  0.0464456 -5.294e-02  0.083898
03/09/2023 -0.0882288 -0.0817749 -0.0072161  0.0763846 -6.579e-02  0.043417
03/14/2023 -0.0994096 -0.0003167 -0.0017059  0.0739589  1.143e-02  0.035383
03/16/2023 -0.0862157 -0.0112307 -0.0155037  0.0489682  3.790e-02  0.113480
03/21/2023 -0.0896027 -0.0783906 -0.0914165  0.0583280 -1.856e-02 -0.061270
03/23/2023 -0.1018755 -0.0531942 -0.0968341  0.0076854 -1.408e-01 -0.028830
03/28/2023 -0.1122269 -0.0297985 -0.0611822 -0.0009889 -2.002e-01 -0.001153
03/30/2023 -0.0930737 -0.0556904 -0.0644139  0.0179693 -1.936e-01  0.039786
04/04/2023 -0.0904919 -0.0024975 -0.1412121  0.1141209  7.283e-02 -0.093886
04/06/2023 -0.0768835 -0.0025201 -0.1008457  0.1381160  3.385e-02 -0.043883
04/11/2023 -0.0797028 -0.0065782 -0.0042746  0.1076528  9.340e-03  0.079934
04/13/2023 -0.0839208 -0.0484415  0.0008959  0.1102628 -6.319e-02  0.127563
04/18/2023 -0.0792515  0.0133289 -0.0173919  0.1135719  1.659e-02  0.085431
04/20/2023 -0.0385700  0.0170628  0.0128976  0.0048890  7.326e-02  0.062062
04/25/2023 -0.0518007  0.0531356  0.0464551 -0.0438412  3.561e-02  0.130686
04/27/2023 -0.0416235  0.0678050 -0.0143108 -0.0239731  9.917e-02  0.075074
05/02/2023 -0.0506070  0.0279888 -0.0954762 -0.0657935  6.272e-02 -0.065156
05/04/2023 -0.0366742  0.0119987 -0.1145503 -0.0796315  4.900e-02 -0.063357
05/09/2023 -0.0542719 -0.0205845 -0.1012056 -0.0257108  4.841e-02 -0.114143
05/11/2023 -0.0347652 -0.0196446 -0.0988863 -0.0509480  5.756e-02 -0.033527
05/16/2023 -0.0159667 -0.0179512 -0.1169217 -0.0417356  1.352e-01 -0.005159
05/18/2023 -0.0187385 -0.0815774 -0.1253989 -0.1096694  1.634e-02  0.045628
05/23/2023 -0.0154892 -0.1035431 -0.1131074 -0.0828718 -1.520e-02  0.060251
05/25/2023 -0.0073083 -0.1008739 -0.1580385 -0.1095336  3.213e-02  0.016198
06/22/2022  0.0443781 -0.0198714  0.0587089  0.0425380  9.145e-02 -0.119282
06/28/2022  0.0556133 -0.0765619  0.0564192  0.0108157  4.062e-02 -0.099810
06/30/2022  0.0567531 -0.0749501  0.0627358  0.0039562  3.358e-02 -0.073854
07/05/2022  0.0589540 -0.1173817  0.1089821 -0.0286515  4.324e-02  0.064700
07/07/2022  0.0511406 -0.1327158  0.1052886 -0.0553353 -4.400e-02  0.008256
07/12/2022  0.0728414 -0.0882309  0.0709089 -0.0330656  4.269e-02  0.011446
07/14/2022  0.0558719 -0.0983153  0.0553844 -0.1163619 -8.505e-02 -0.045770
07/19/2022  0.0747715 -0.0658493  0.0392459  0.0125540  9.531e-02 -0.069056
07/21/2022  0.0714138  0.0244844 -0.0007479 -0.0196130 -9.233e-02  0.024226
07/26/2022  0.0867816 -0.0195073 -0.0307390  0.0188270  3.167e-02  0.011602
07/28/2022  0.0813321 -0.0278420 -0.0013148 -0.0560926 -1.205e-01  0.056845
08/02/2022  0.0847303 -0.0459981 -0.0098362 -0.0137752 -2.787e-02  0.059523
08/04/2022  0.0814969 -0.0197224 -0.0134633 -0.0544112  5.102e-03  0.085481
08/09/2022  0.0982391  0.0164540 -0.0154270  0.0265539  4.591e-02  0.068301
08/11/2022  0.0834212 -0.0105285 -0.0135444 -0.0401638 -1.132e-01  0.029894
08/16/2022  0.0845784 -0.0343028 -0.0097453 -0.0219316 -4.665e-02  0.057942
08/18/2022  0.0996387 -0.0396385 -0.0210630 -0.0124878 -5.073e-02  0.112504
08/23/2022  0.1037592  0.0253745 -0.0576250  0.0354109  3.743e-02  0.037277
08/25/2022  0.1089004  0.0362325 -0.0375706  0.0222023  3.135e-02  0.101691
08/30/2022  0.0997363 -0.0017325 -0.0466554  0.0099279 -1.564e-02  0.055566
09/01/2022  0.0989790  0.0251810 -0.0535390 -0.0163894  4.036e-02  0.087632
09/06/2022  0.1128837  0.0323517 -0.0323685  0.0370692  7.919e-02  0.136469
09/13/2022  0.0998158 -0.0284779 -0.0742870  0.0721613  9.669e-02 -0.003244
09/15/2022  0.0951768 -0.0407149 -0.0493164  0.0062808 -6.180e-02  0.023496
09/20/2022  0.0717288 -0.0757226 -0.0003708  0.0689029  8.721e-03 -0.060599
09/22/2022  0.0713195 -0.0796753 -0.0056636  0.0751423  5.634e-03 -0.078480
09/27/2022  0.0692470 -0.1066841  0.0050838  0.0593799 -3.626e-02 -0.067124
09/29/2022  0.0613509 -0.0967112 -0.0208471  0.0348248 -1.122e-02 -0.106908
10/20/2022  0.0887934  0.1475667 -0.1364634  0.0050959 -1.047e-02 -0.139222
10/25/2022  0.0658126  0.1504321 -0.0670116  0.0506730 -1.646e-02 -0.122359
10/27/2022  0.0687499  0.1638546 -0.0370928  0.0140210 -5.691e-02 -0.054900
11/01/2022  0.0446043  0.1381371  0.0443767 -0.0019092  3.596e-02  0.141638
11/03/2022  0.0324891  0.0731200 -0.0210305 -0.0443818 -1.124e-01 -0.065578
11/08/2022  0.0294500  0.2062817  0.0281343  0.0222496 -1.769e-02  0.015462
11/10/2022  0.0226989  0.1945084  0.0111991  0.0226653 -1.365e-03  0.004257
11/15/2022  0.0387417  0.1376830  0.0078388  0.0288388 -9.025e-02  0.009407
11/17/2022  0.0346436  0.1262443  0.0023838  0.0193421 -1.369e-01 -0.024271
11/22/2022  0.0235029 -0.0137356  0.1087732  0.0599947  5.413e-02 -0.015534
11/24/2022 -0.0005473 -0.0175583  0.0856575  0.0560357  1.213e-02 -0.099001
11/28/2022  0.0018120 -0.0127787  0.0974998  0.0701176 -4.609e-02 -0.118201
12/01/2022 -0.0078591  0.0106970  0.1407054  0.0582306 -5.646e-02 -0.026243
12/06/2022  0.0042210 -0.0254477  0.1154204  0.0605254 -2.109e-02 -0.028206
12/08/2022 -0.0137015 -0.0135516  0.1121732  0.0997382  2.008e-02 -0.129754
12/13/2022 -0.0091466  0.0160204  0.1298722  0.0485837  1.998e-02 -0.020398
12/15/2022 -0.0303826  0.0290098  0.1499604  0.0131752 -1.037e-01 -0.031784


Biplot scores for constraining variables

                      RDA1     RDA2     RDA3     RDA4     RDA5     RDA6
Alkalinity_PE       0.5209 -0.39309 -0.33847 -0.06485 -0.29010 -0.45472
pH_RSS              0.6314 -0.13661  0.24554  0.17368 -0.09711  0.03105
temp_RSS            0.9363 -0.20297 -0.27391  0.01332 -0.02977  0.01965
BOD_CBOD_Load_PE   -0.3519 -0.08931  0.01628 -0.25689 -0.65462 -0.04882
COD_Load_PE        -0.5447  0.23688  0.23981  0.02235  0.01094 -0.46086
Ammonia_Load_RAW   -0.2232  0.42805  0.07253  0.27569  0.05329 -0.50746
TKN_Load_RAW       -0.1468  0.07033 -0.51009  0.68080 -0.31199  0.33744
P_Load_PE           0.1077  0.56569 -0.51426 -0.42355 -0.07886  0.23050
SCT_Detention_Time -0.7976 -0.16547 -0.45886 -0.25403  0.11556  0.08034</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>fwd.sel <span class="ot">&lt;-</span> <span class="fu">ordiR2step</span>(<span class="fu">rda</span>(otu_p_wide <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> as_metadata_input.z), <span class="co"># lower model limit (simple!)</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">scope =</span> <span class="fu">formula</span>(as_metadata_input.rda), <span class="co"># upper model limit (the "full" model)</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">direction =</span> <span class="st">"forward"</span>,</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">R2scope =</span> <span class="cn">TRUE</span>, <span class="co"># can't surpass the "full" model's R2</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">pstep =</span> <span class="dv">1000</span>,</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">trace =</span> <span class="cn">FALSE</span>) <span class="co"># change to TRUE to see the selection process</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="co">#see which variables were selected</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>fwd.sel<span class="sc">$</span>call</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>rda(formula = otu_p_wide ~ temp_RSS + SCT_Detention_Time + P_Load_PE + 
    TKN_Load_RAW + Ammonia_Load_RAW, data = as_metadata_input.z)</code></pre>
</div>
</div>
<p>#result RDA is: rda(formula = otu_p_wide ~ temp_RSS + SCT_Detention_Time + P_Load_PE + TKN_Load_RAW + Ammonia_Load_RAW, data = as_metadata_input.z)</p>
</section>
<section id="effect-of-shannon-index-on-output-parameters-using-linear-regression" class="level2">
<h2 class="anchored" data-anchor-id="effect-of-shannon-index-on-output-parameters-using-linear-regression">Effect of Shannon Index on Output Parameters using Linear Regression</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>lm1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(COD_Load_Removed <span class="sc">~</span> Shannon, <span class="at">data =</span> output_data)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lm1)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"Linear Model for COD_Load_Removed ~ Shannon"</span>, <span class="at">line =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">outer =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="linear_regressions_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = COD_Load_Removed ~ Shannon, data = output_data)

Residuals:
    Min      1Q  Median      3Q     Max 
-50.154  -7.706   1.259   8.229  44.484 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   85.394      1.966   43.42  &lt; 2e-16 ***
Shannon       10.044      2.729    3.68  0.00025 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 14.6 on 750 degrees of freedom
Multiple R-squared:  0.01773,   Adjusted R-squared:  0.01642 
F-statistic: 13.54 on 1 and 750 DF,  p-value: 0.0002502</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>lm2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(P_Removed <span class="sc">~</span> Shannon, <span class="at">data =</span> output_data)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lm2)</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"Linear Model for P_Removed ~ Shannon"</span>, <span class="at">line =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">outer =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="linear_regressions_files/figure-html/unnamed-chunk-7-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = P_Removed ~ Shannon, data = output_data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.91548 -0.20519  0.06134  0.24145  0.54031 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  0.34889    0.04382   7.961  6.3e-15 ***
Shannon      0.90793    0.06083  14.927  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.3254 on 750 degrees of freedom
Multiple R-squared:  0.229, Adjusted R-squared:  0.228 
F-statistic: 222.8 on 1 and 750 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>lm3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(TKN_Removed <span class="sc">~</span> Shannon, <span class="at">data =</span> output_data)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lm3)</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"Linear Model for TKN_Removed ~ Shannon"</span>, <span class="at">line =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">outer =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="linear_regressions_files/figure-html/unnamed-chunk-7-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = TKN_Removed ~ Shannon, data = output_data)

Residuals:
    Min      1Q  Median      3Q     Max 
-2.5674 -0.1711  0.2739  0.5188  1.3956 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   2.3620     0.1218  19.399   &lt;2e-16 ***
Shannon      -1.4782     0.1690  -8.747   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.904 on 750 degrees of freedom
Multiple R-squared:  0.09257,   Adjusted R-squared:  0.09136 
F-statistic: 76.51 on 1 and 750 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>lm4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Ammonia_Removed <span class="sc">~</span> Shannon, <span class="at">data =</span> output_data)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lm4)</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"Linear Model for Ammonia_Removed ~ Shannon"</span>, <span class="at">line =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">outer =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="linear_regressions_files/figure-html/unnamed-chunk-7-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Ammonia_Removed ~ Shannon, data = output_data)

Residuals:
    Min      1Q  Median      3Q     Max 
-4.1028 -0.6071  0.1175  0.7188  2.7766 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  -5.6568     0.1572 -35.978  &lt; 2e-16 ***
Shannon       0.9177     0.2182   4.205 2.92e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.167 on 750 degrees of freedom
Multiple R-squared:  0.02304,   Adjusted R-squared:  0.02173 
F-statistic: 17.69 on 1 and 750 DF,  p-value: 2.921e-05</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>lm5 <span class="ot">&lt;-</span> <span class="fu">lm</span>(BOD_CBOD_Load_Removed <span class="sc">~</span> Shannon, <span class="at">data =</span> output_data)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lm5)</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"Linear Model for BOD_CBOD_Load_Removed ~ Shannon"</span>, <span class="at">line =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">outer =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="linear_regressions_files/figure-html/unnamed-chunk-7-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm5)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = BOD_CBOD_Load_Removed ~ Shannon, data = output_data)

Residuals:
    Min      1Q  Median      3Q     Max 
-44.966  -4.542   0.553   4.702  14.932 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)    40.41       1.16  34.839   &lt;2e-16 ***
Shannon         3.64       1.61   2.261    0.024 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 8.612 on 750 degrees of freedom
Multiple R-squared:  0.006771,  Adjusted R-squared:  0.005446 
F-statistic: 5.113 on 1 and 750 DF,  p-value: 0.02404</code></pre>
</div>
</div>
<p>Resulting p-values are all significant: In order: COD_Load_Removed:0.00025 P_Removed: 2e-16 TKN_Removed: 2e-16 Ammonia_Removed: 2.92e-05 BOD_CBOD_Load_Removed: 0.024</p>
</section>
<section id="otu-1-analysis" class="level2">
<h2 class="anchored" data-anchor-id="otu-1-analysis">OTU 1 Analysis</h2>
<p>The generalized linear model used a binomial distribution for the relative abundance data (between 0-1) so the changes of the inputs on this distribution can be specifically calculated. This model also does not assume a linear relationship.</p>
<p>The poisson relationship would be used for count data</p>
</section>
<section id="comparing-a-general-linear-model-vs.-linear-model-for-input-parameters-on-otu-1" class="level2">
<h2 class="anchored" data-anchor-id="comparing-a-general-linear-model-vs.-linear-model-for-input-parameters-on-otu-1">Comparing a General Linear Model vs.&nbsp;Linear Model for Input Parameters on OTU 1</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co">#filter out for OTU 1</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>otu_1 <span class="ot">&lt;-</span> input_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(OTU <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>model1 <span class="ot">&lt;-</span> <span class="fu">glm</span>(Abundance <span class="sc">~</span> temp_RSS <span class="sc">+</span> SCT_Detention_Time <span class="sc">+</span> P_Load_PE <span class="sc">+</span> TKN_Load_RAW <span class="sc">+</span> Ammonia_Load_RAW <span class="sc">+</span> pH_RSS <span class="sc">+</span> BOD_CBOD_Load_PE, <span class="at">family =</span> binomial,</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> otu_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in eval(family$initialize): non-integer #successes in a binomial glm!</code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = Abundance ~ temp_RSS + SCT_Detention_Time + P_Load_PE + 
    TKN_Load_RAW + Ammonia_Load_RAW + pH_RSS + BOD_CBOD_Load_PE, 
    family = binomial, data = otu_1)

Coefficients:
                     Estimate Std. Error z value Pr(&gt;|z|)
(Intercept)         3.2559247 96.5997353   0.034    0.973
temp_RSS           -0.0101602  0.3028600  -0.034    0.973
SCT_Detention_Time  0.9027379  3.1992126   0.282    0.778
P_Load_PE          -2.8495646  9.9857297  -0.285    0.775
TKN_Load_RAW       -0.0008063  0.7355789  -0.001    0.999
Ammonia_Load_RAW   -0.1687601  1.1657600  -0.145    0.885
pH_RSS              0.2028448 12.5584428   0.016    0.987
BOD_CBOD_Load_PE    0.0031766  0.0969474   0.033    0.974

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 0.77079  on 80  degrees of freedom
Residual deviance: 0.55062  on 73  degrees of freedom
AIC: 21.189

Number of Fisher Scoring iterations: 7</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model1)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"General Linear Model with OTU 1 Relative Abundance ~ SCT_Detention_Time"</span>, <span class="at">line =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">outer =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="linear_regressions_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co">#normal linear model</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>model2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Abundance <span class="sc">~</span>  temp_RSS <span class="sc">+</span> SCT_Detention_Time <span class="sc">+</span> P_Load_PE <span class="sc">+</span> TKN_Load_RAW <span class="sc">+</span> Ammonia_Load_RAW <span class="sc">+</span> pH_RSS <span class="sc">+</span> BOD_CBOD_Load_PE,</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> otu_1)</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Abundance ~ temp_RSS + SCT_Detention_Time + P_Load_PE + 
    TKN_Load_RAW + Ammonia_Load_RAW + pH_RSS + BOD_CBOD_Load_PE, 
    data = otu_1)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.021875 -0.010883 -0.002686  0.006813  0.094619 

Coefficients:
                     Estimate Std. Error t value Pr(&gt;|t|)   
(Intercept)         0.1644549  0.2869814   0.573  0.56837   
temp_RSS           -0.0004897  0.0008712  -0.562  0.57577   
SCT_Detention_Time  0.0231091  0.0084472   2.736  0.00781 **
P_Load_PE          -0.0684792  0.0243500  -2.812  0.00631 **
TKN_Load_RAW        0.0010703  0.0022119   0.484  0.62992   
Ammonia_Load_RAW   -0.0044773  0.0033803  -1.325  0.18946   
pH_RSS              0.0067213  0.0381149   0.176  0.86051   
BOD_CBOD_Load_PE    0.0001117  0.0002840   0.393  0.69518   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.01673 on 73 degrees of freedom
Multiple R-squared:  0.2346,    Adjusted R-squared:  0.1612 
F-statistic: 3.196 on 7 and 73 DF,  p-value: 0.005231</code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model2)</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"Linear Model with OTU 1 Relative Abundance ~ SCT_Detention_Time"</span>, <span class="at">line =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">outer =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="linear_regressions_files/figure-html/unnamed-chunk-8-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Here we see the generalized linear model predict no significant values, while the linear model predicts significant values.</p>
</section>
<section id="conclusions" class="level2">
<h2 class="anchored" data-anchor-id="conclusions">Conclusions</h2>
<p>Relevant Input Parameters that explain 36% of variance in the data:</p>
<ul>
<li><p>temp_RSS</p></li>
<li><p>SCT_Detention_Time</p></li>
<li><p>P_Load_PE</p></li>
<li><p>TKN_Load_RAW</p></li>
<li><p>Ammonia_Load_RAW</p></li>
</ul>
<p>From multiple linear regression on shannon index:</p>
<ul>
<li><p>pH_RSS</p></li>
<li><p>BOD_CBOD_Load_PE</p></li>
<li><p>Ammonia_Load_RAW</p></li>
<li><p>P_Load_PE</p></li>
<li><p>SCT_Detention_Time</p></li>
</ul>
<p>From generalized linear model on OTU 1: - none</p>
<p>Relevant Output Parameters:</p>
<ul>
<li><p>COD_Load_Removed</p></li>
<li><p>P_Removed</p></li>
<li><p>TKN_Removed</p></li>
<li><p>Ammonia_Removed</p></li>
<li><p>BOD_CBOD_Load_Removed</p></li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>